import{C as ii,r as ct,g as Xe,W as ai,X as ni,b as oi,d as ot,l as gt,w,f as S,e as Se,m as xr,F as be,J as Pt,n as Sr,$ as Yt,i as Te,A as pt,j as W,t as O,v as br,O as kt,N as or,I as Cr,Y as si,u as li,a as ui,H as ci,z as hi,h as vi,k as D,V as di,Z as Re,_ as Le,D as Be,s as sr,q as fi,x as pi}from"./index-fc527e32.js";import{_ as gi,F as mi,a as _i}from"./layout.6705feb1.js";import{_ as yi}from"./page-meta.2920e12b.js";import{_ as xi}from"./icon-close-contract.7eb96a04.js";import{U as Si}from"./sub-section.3fdb44aa.js";import{_ as Ue}from"./_plugin-vue_export-helper.c27b6911.js";import{c as Ve,_ as lr}from"./device.7173e9a9.js";const bi="./static/images/icon-dollar.png",Ci="./static/images/icon-arrow-down.png",wi="./static/images/icon-arrow-up.png",Ii="./static/images/icon-foldline.png",Ei="./static/images/icon-close.png";/**
* @license
* KLineChart v9.7.1
* Copyright (c) 2019 lihu.
* Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
*/var Ye=function(r,t){return Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])},Ye(r,t)};function Z(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ye(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var V=function(){return V=Object.assign||function(t){for(var e,i=1,a=arguments.length;i<a;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},V.apply(this,arguments)};function Ce(r,t,e,i){function a(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function s(c){try{u(i.next(c))}catch(h){o(h)}}function l(c){try{u(i.throw(c))}catch(h){o(h)}}function u(c){c.done?n(c.value):a(c.value).then(s,l)}u((i=i.apply(r,t||[])).next())})}function we(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,a,n,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return l([u,c])}}function l(u){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(e=0)),e;)try{if(i=1,a&&(n=u[0]&2?a.return:u[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,u[1])).done)return n;switch(a=0,n&&(u=[u[0]&2,n.value]),u[0]){case 0:case 1:n=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,a=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!n||u[1]>n[0]&&u[1]<n[3])){e.label=u[1];break}if(u[0]===6&&e.label<n[1]){e.label=n[1],n=u;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(u);break}n[2]&&e.ops.pop(),e.trys.pop();continue}u=t.call(r,e)}catch(c){u=[6,c],a=0}finally{i=n=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function $t(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],i=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function dt(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var i=e.call(r),a,n=[],o;try{for(;(t===void 0||t-- >0)&&!(a=i.next()).done;)n.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return n}function wr(r,t,e){if(e||arguments.length===2)for(var i=0,a=t.length,n;i<a;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return r.concat(n||Array.prototype.slice.call(t))}var $;(function(r){r.Dashed="dashed",r.Solid="solid"})($||($={}));var J;(function(r){r.Stroke="stroke",r.Fill="fill",r.StrokeFill="stroke_fill"})(J||(J={}));var ae;(function(r){r.Always="always",r.FollowCross="follow_cross",r.None="none"})(ae||(ae={}));var Ft;(function(r){r.Standard="standard",r.Rect="rect"})(Ft||(Ft={}));var he;(function(r){r.Left="left",r.Middle="middle",r.Right="right"})(he||(he={}));var Ie;(function(r){r.Fixed="fixed",r.Pointer="pointer"})(Ie||(Ie={}));var Rt;(function(r){r.CandleSolid="candle_solid",r.CandleStroke="candle_stroke",r.CandleUpStroke="candle_up_stroke",r.CandleDownStroke="candle_down_stroke",r.Ohlc="ohlc",r.Area="area"})(Rt||(Rt={}));var jt;(function(r){r.Left="left",r.Right="right"})(jt||(jt={}));var ut;(function(r){r.Normal="normal",r.Percentage="percentage",r.Log="log"})(ut||(ut={}));var _e="#F92855",Ne="rgba(249, 40, 85, .7)",ye="#2DC08E",Oe="rgba(45, 192, 142, .7)",Kt="#888888",De="#FFFFFF",wt="#1677FF",Jt="#76808F",He="#DDDDDD";function de(r){return"rgba(22, 119, 255, ".concat(r,")")}function Mi(){function r(){return{show:!0,size:1,color:"#EDEDED",style:$.Dashed,dashedValue:[2,2]}}return{show:!0,horizontal:r(),vertical:r()}}function Pi(){var r={show:!0,color:Jt,textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"};return{type:Rt.CandleSolid,bar:{upColor:ye,downColor:_e,noChangeColor:Kt,upBorderColor:ye,downBorderColor:_e,noChangeBorderColor:Kt,upWickColor:ye,downWickColor:_e,noChangeWickColor:Kt},area:{lineSize:2,lineColor:wt,value:"close",backgroundColor:[{offset:0,color:de(.01)},{offset:1,color:de(.2)}]},priceMark:{show:!0,high:V({},r),low:V({},r),last:{show:!0,upColor:ye,downColor:_e,noChangeColor:Kt,line:{show:!0,style:$.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:J.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:$.Solid,borderSize:0,borderDashedValue:[2,2],color:De,family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:ae.Always,showType:Ft.Standard,custom:null,defaultValue:"n/a",rect:{position:Ie.Fixed,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,offsetBottom:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:Jt,marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}}}function Ti(){var r=["#FF9600","#935EBD",wt,"#E11D74","#01C5C4"].map(function(t){return{style:$.Solid,smooth:!1,size:1,dashedValue:[2,2],color:t}});return{ohlc:{upColor:Oe,downColor:Ne,noChangeColor:Kt},bars:[{style:J.Fill,borderStyle:$.Solid,borderSize:1,borderDashedValue:[2,2],upColor:Oe,downColor:Ne,noChangeColor:Kt}],lines:r,circles:[{style:J.Fill,borderStyle:$.Solid,borderSize:1,borderDashedValue:[2,2],upColor:Oe,downColor:Ne,noChangeColor:Kt}],lastValueMark:{show:!1,text:{show:!1,style:J.Fill,color:De,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:$.Solid,borderColor:"transparent",borderSize:0,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:ae.Always,showType:Ft.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:Jt,marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}}}function Ir(){return{show:!0,size:"auto",axisLine:{show:!0,color:He,size:1},tickText:{show:!0,color:Jt,size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:He}}}function Di(){var r=Ir();return r.type=ut.Normal,r.position=jt.Right,r.inside=!1,r.reverse=!1,r}function Ai(){function r(){return{show:!0,line:{show:!0,style:$.Dashed,dashedValue:[4,2],size:1,color:Jt},text:{show:!0,style:J.Fill,color:De,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:$.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:Jt,borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:Jt}}}return{show:!0,horizontal:r(),vertical:r()}}function ki(){var r=de(.35),t=de(.25);function e(){return{style:J.Fill,color:De,size:12,family:"Helvetica Neue",weight:"normal",borderStyle:$.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:wt,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:wt}}return{point:{color:wt,borderColor:r,borderSize:1,radius:5,activeColor:wt,activeBorderColor:r,activeBorderSize:3,activeRadius:5},line:{style:$.Solid,smooth:!1,color:wt,size:1,dashedValue:[2,2]},rect:{style:J.Fill,color:t,borderColor:wt,borderSize:1,borderRadius:0,borderStyle:$.Solid,borderDashedValue:[2,2]},polygon:{style:J.Fill,color:wt,borderColor:wt,borderSize:1,borderStyle:$.Solid,borderDashedValue:[2,2]},circle:{style:J.Fill,color:t,borderColor:wt,borderSize:1,borderStyle:$.Solid,borderDashedValue:[2,2]},arc:{style:$.Solid,color:wt,size:1,dashedValue:[2,2]},text:e(),rectText:e()}}function Fi(){return{size:1,color:He,fill:!0,activeBackgroundColor:de(.08)}}function Ri(){return{grid:Mi(),candle:Pi(),indicator:Ti(),xAxis:Ir(),yAxis:Di(),separator:Fi(),crosshair:Ai(),overlay:ki()}}function It(r,t){if(!(!Bt(r)&&!Bt(t))){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=r[e],a=t[e];Bt(a)&&Bt(i)?It(i,a):k(t[e])&&(r[e]=fe(t[e]))}}}function fe(r){if(!Bt(r))return r;var t;Lt(r)?t=[]:t={};for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var i=r[e];Bt(i)?t[e]=fe(i):t[e]=i}return t}function Lt(r){return Object.prototype.toString.call(r)==="[object Array]"}function Nt(r){return typeof r=="function"}function Bt(r){return typeof r=="object"&&k(r)}function X(r){return typeof r=="number"&&!isNaN(r)}function k(r){return r!=null}function Qt(r){return typeof r=="boolean"}function j(r){return typeof r=="string"}var Li=/\\(\\)?/g,Bi=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function rt(r,t,e){if(k(r)){var i=[];t.replace(Bi,function(s){for(var l=[],u=1;u<arguments.length;u++)l[u-1]=arguments[u];var c=s;return k(l[1])?c=l[2].replace(Li,"$1"):k(l[0])&&(c=l[0].trim()),i.push(c),""});for(var a=r,n=0,o=i.length;k(a)&&n<o;)a=a==null?void 0:a[i[n++]];return k(a)?a:e!=null?e:"--"}return e!=null?e:"--"}function Vi(r,t,e){var i=r.format(new Date(t)),a=i.split(", "),n=a[0].split("/"),o=a[1].split(":"),s={YYYY:n[2],MM:n[0],DD:n[1],HH:o[0]==="24"?"00":o[0],mm:o[1],ss:o[2]};return e.replace(/YYYY|MM|DD|HH|mm|ss/g,function(l){return s[l]})}function at(r,t){var e=+r;return X(e)?e.toFixed(t!=null?t:2):"".concat(r)}function Ni(r){var t=+r;if(X(t)){if(t>1e9)return"".concat(+(t/1e9).toFixed(3),"B");if(t>1e6)return"".concat(+(t/1e6).toFixed(3),"M");if(t>1e3)return"".concat(+(t/1e3).toFixed(3),"K")}return"".concat(r)}function ht(r,t){var e="".concat(r);if(t.length===0)return e;if(e.includes(".")){var i=e.split(".");return"".concat(i[0].replace(/(\d)(?=(\d{3})+$)/g,function(a){return"".concat(a).concat(t)}),".").concat(i[1])}return e.replace(/(\d)(?=(\d{3})+$)/g,function(a){return"".concat(a).concat(t)})}var le;function ne(r){var t,e,i;return Math.ceil((i=(e=(t=r.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||e===void 0?void 0:e.devicePixelRatio)!==null&&i!==void 0?i:2)}function te(r,t,e){return"".concat(t!=null?t:"normal"," ").concat(r!=null?r:12,"px ").concat(e!=null?e:"Helvetica Neue")}function Ee(r,t,e,i){if(!k(le)){var a=document.createElement("canvas"),n=ne(a);le=a.getContext("2d"),le.scale(n,n)}return le.font=te(t,e,i),Math.round(le.measureText(r).width)}var Tt;(function(r){r.OnZoom="onZoom",r.OnScroll="onScroll",r.OnVisibleRangeChange="onVisibleRangeChange",r.OnTooltipIconClick="onTooltipIconClick",r.OnCrosshairChange="onCrosshairChange",r.OnCandleBarClick="onCandleBarClick",r.OnPaneDrag="onPaneDrag"})(Tt||(Tt={}));var Oi=function(){function r(){this._callbacks=[]}return r.prototype.subscribe=function(t){var e,i=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;i<0&&this._callbacks.push(t)},r.prototype.unsubscribe=function(t){var e;if(Nt(t)){var i=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;i>-1&&this._callbacks.splice(i,1)}else this._callbacks=[]},r.prototype.execute=function(t){this._callbacks.forEach(function(e){e(t)})},r.prototype.isEmpty=function(){return this._callbacks.length===0},r}(),yt;(function(r){r.Normal="normal",r.Price="price",r.Volume="volume"})(yt||(yt={}));function qe(r,t,e,i,a){var n=t.result,o=t.figures,s=t.styles,l=rt(s,"circles",i.circles),u=l.length,c=rt(s,"bars",i.bars),h=c.length,f=rt(s,"lines",i.lines),v=f.length,d=0,g=0,p=0,m;o.forEach(function(_){var y;switch(_.type){case"circle":{var x=l[d%u];m=V(V({},x),{color:x.noChangeColor}),d++;break}case"bar":{var b=c[g%h];m=V(V({},b),{color:b.noChangeColor}),g++;break}case"line":{m=f[p%v],p++;break}}if(k(m)){var I={prev:{kLineData:r[e-1],indicatorData:n[e-1]},current:{kLineData:r[e],indicatorData:n[e]},next:{kLineData:r[e+1],indicatorData:n[e+1]}},C=(y=_.styles)===null||y===void 0?void 0:y.call(_,I,t,i);a(_,V(V({},m),C))}})}var Wi=function(){function r(t){this.result=[],this._precisionFlag=!1;var e=t.name,i=t.shortName,a=t.series,n=t.calcParams,o=t.figures,s=t.precision,l=t.shouldOhlc,u=t.shouldFormatBigNumber,c=t.visible,h=t.zLevel,f=t.minValue,v=t.maxValue,d=t.styles,g=t.extendData,p=t.regenerateFigures,m=t.createTooltipDataSource,_=t.draw;this.name=e,this.shortName=i!=null?i:e,this.series=a!=null?a:yt.Normal,this.precision=s!=null?s:4,this.calcParams=n!=null?n:[],this.figures=o!=null?o:[],this.shouldOhlc=l!=null?l:!1,this.shouldFormatBigNumber=u!=null?u:!1,this.visible=c!=null?c:!0,this.zLevel=h!=null?h:0,this.minValue=f!=null?f:null,this.maxValue=v!=null?v:null,this.styles=fe(d!=null?d:{}),this.extendData=g,this.regenerateFigures=p!=null?p:null,this.createTooltipDataSource=m!=null?m:null,this.draw=_!=null?_:null}return r.prototype.setShortName=function(t){return this.shortName!==t?(this.shortName=t,!0):!1},r.prototype.setSeries=function(t){return this.series!==t?(this.series=t,!0):!1},r.prototype.setPrecision=function(t,e){var i=e!=null?e:!1,a=Math.floor(t);return a!==this.precision&&t>=0&&(!i||i&&!this._precisionFlag)?(this.precision=a,i||(this._precisionFlag=!0),!0):!1},r.prototype.setCalcParams=function(t){var e,i;return this.calcParams=t,this.figures=(i=(e=this.regenerateFigures)===null||e===void 0?void 0:e.call(this,t))!==null&&i!==void 0?i:this.figures,!0},r.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t?(this.shouldOhlc=t,!0):!1},r.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t?(this.shouldFormatBigNumber=t,!0):!1},r.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},r.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},r.prototype.setStyles=function(t){return It(this.styles,t),!0},r.prototype.setExtendData=function(t){return this.extendData!==t?(this.extendData=t,!0):!1},r.prototype.setFigures=function(t){return this.figures!==t?(this.figures=t,!0):!1},r.prototype.setMinValue=function(t){return this.minValue!==t?(this.minValue=t,!0):!1},r.prototype.setMaxValue=function(t){return this.maxValue!==t?(this.maxValue=t,!0):!1},r.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t?(this.regenerateFigures=t,!0):!1},r.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t?(this.createTooltipDataSource=t,!0):!1},r.prototype.setDraw=function(t){return this.draw!==t?(this.draw=t,!0):!1},r.prototype.calcIndicator=function(t){return Ce(this,void 0,void 0,function(){var e;return we(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}})})},r.extend=function(t){var e=function(i){Z(a,i);function a(){return i.call(this,t)||this}return a.prototype.calc=function(n,o){return t.calc(n,o)},a}(r);return e},r}(),ie;(function(r){r.Normal="normal",r.WeakMagnet="weak_magnet",r.StrongMagnet="strong_magnet"})(ie||(ie={}));function zi(){return["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]}var ur=1,ue=-1,Xi="overlay_",ee="overlay_figure_",Yi=Number.MAX_SAFE_INTEGER,Hi=function(){function r(t){this.currentStep=ur,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var e=t.mode,i=t.modeSensitivity,a=t.extendData,n=t.styles,o=t.name,s=t.totalStep,l=t.lock,u=t.visible,c=t.zLevel,h=t.needDefaultPointFigure,f=t.needDefaultXAxisFigure,v=t.needDefaultYAxisFigure,d=t.createPointFigures,g=t.createXAxisFigures,p=t.createYAxisFigures,m=t.performEventPressedMove,_=t.performEventMoveForDrawing,y=t.onDrawStart,x=t.onDrawing,b=t.onDrawEnd,I=t.onClick,C=t.onDoubleClick,E=t.onRightClick,A=t.onPressedMoveStart,F=t.onPressedMoving,P=t.onPressedMoveEnd,L=t.onMouseEnter,T=t.onMouseLeave,N=t.onRemoved,U=t.onSelected,Y=t.onDeselected;this.name=o,this.totalStep=!X(s)||s<2?1:s,this.lock=l!=null?l:!1,this.visible=u!=null?u:!0,this.zLevel=c!=null?c:0,this.needDefaultPointFigure=h!=null?h:!1,this.needDefaultXAxisFigure=f!=null?f:!1,this.needDefaultYAxisFigure=v!=null?v:!1,this.mode=e!=null?e:ie.Normal,this.modeSensitivity=i!=null?i:8,this.extendData=a,this.styles=fe(n!=null?n:{}),this.createPointFigures=d!=null?d:null,this.createXAxisFigures=g!=null?g:null,this.createYAxisFigures=p!=null?p:null,this.performEventPressedMove=m!=null?m:null,this.performEventMoveForDrawing=_!=null?_:null,this.onDrawStart=y!=null?y:null,this.onDrawing=x!=null?x:null,this.onDrawEnd=b!=null?b:null,this.onClick=I!=null?I:null,this.onDoubleClick=C!=null?C:null,this.onRightClick=E!=null?E:null,this.onPressedMoveStart=A!=null?A:null,this.onPressedMoving=F!=null?F:null,this.onPressedMoveEnd=P!=null?P:null,this.onMouseEnter=L!=null?L:null,this.onMouseLeave=T!=null?T:null,this.onRemoved=N!=null?N:null,this.onSelected=U!=null?U:null,this.onDeselected=Y!=null?Y:null}return r.prototype.setId=function(t){return j(this.id)?!1:(this.id=t,!0)},r.prototype.setGroupId=function(t){return j(this.groupId)?!1:(this.groupId=t,!0)},r.prototype.setPaneId=function(t){this.paneId=t},r.prototype.setExtendData=function(t){return t!==this.extendData?(this.extendData=t,!0):!1},r.prototype.setStyles=function(t){return It(this.styles,t),!0},r.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=wr([],dt(t),!1),t.length>=this.totalStep-1?(this.currentStep=ue,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),this.performEventMoveForDrawing!==null)for(var i=0;i<e;i++)this.performEventMoveForDrawing({currentStep:i+2,mode:this.mode,points:this.points,performPointIndex:i,performPoint:this.points[i]});return this.currentStep===ue&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},r.prototype.setLock=function(t){return this.lock!==t?(this.lock=t,!0):!1},r.prototype.setVisible=function(t){return this.visible!==t?(this.visible=t,!0):!1},r.prototype.setZLevel=function(t){return this.zLevel!==t?(this.zLevel=t,!0):!1},r.prototype.setMode=function(t){return this.mode!==t?(this.mode=t,!0):!1},r.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t?(this.modeSensitivity=t,!0):!1},r.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t?(this.onDrawStart=t,!0):!1},r.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t?(this.onDrawing=t,!0):!1},r.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t?(this.onDrawEnd=t,!0):!1},r.prototype.setOnClickCallback=function(t){return this.onClick!==t?(this.onClick=t,!0):!1},r.prototype.setOnDoubleClickCallback=function(t){return this.onDoubleClick!==t?(this.onDoubleClick=t,!0):!1},r.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t?(this.onRightClick=t,!0):!1},r.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t?(this.onPressedMoveStart=t,!0):!1},r.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t?(this.onPressedMoving=t,!0):!1},r.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t?(this.onPressedMoveEnd=t,!0):!1},r.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t?(this.onMouseEnter=t,!0):!1},r.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t?(this.onMouseLeave=t,!0):!1},r.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t?(this.onRemoved=t,!0):!1},r.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t?(this.onSelected=t,!0):!1},r.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t?(this.onDeselected=t,!0):!1},r.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=ue:this.currentStep++},r.prototype.forceComplete=function(){this.currentStep=ue},r.prototype.isDrawing=function(){return this.currentStep!==ue},r.prototype.isStart=function(){return this.currentStep===ur},r.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,a={};X(t.timestamp)&&(a.timestamp=t.timestamp),X(t.dataIndex)&&(a.dataIndex=t.dataIndex),X(t.value)&&(a.value=t.value),this.points[i]=a,(e=this.performEventMoveForDrawing)===null||e===void 0||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:a})},r.prototype.eventPressedPointMove=function(t,e){var i;X(t.dataIndex)&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),X(t.value)&&(this.points[e].value=t.value),(i=this.performEventPressedMove)===null||i===void 0||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},r.prototype.startPressedMove=function(t){this._prevPressedPoint=V({},t),this._prevPressedPoints=fe(this.points)},r.prototype.eventPressedOtherMove=function(t,e){if(this._prevPressedPoint!==null){var i;X(t.dataIndex)&&X(this._prevPressedPoint.dataIndex)&&(i=t.dataIndex-this._prevPressedPoint.dataIndex);var a;X(t.value)&&X(this._prevPressedPoint.value)&&(a=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(n){var o;X(n.dataIndex)&&X(n.timestamp)&&(n.dataIndex=e.timestampToDataIndex(n.timestamp));var s=V({},n);return X(i)&&X(n.dataIndex)&&(s.dataIndex=n.dataIndex+i,s.timestamp=(o=e.dataIndexToTimestamp(s.dataIndex))!==null&&o!==void 0?o:void 0),X(a)&&X(n.value)&&(s.value=n.value+a),s})}},r.extend=function(t){var e=function(i){Z(a,i);function a(){return i.call(this,t)||this}return a}(r);return e},r}(),vt;(function(r){r[r.Tooltip=0]="Tooltip",r[r.Crosshair=1]="Crosshair",r[r.XAxis=2]="XAxis"})(vt||(vt={}));function ji(){return{formatDate:Vi,formatBigNumber:Ni}}var Gi="en-US",We=1,cr=new Date().getTime();function Er(r){var t=new Date().getTime();return t===cr?++We:We=1,cr=t,"".concat(r!=null?r:"").concat(t,"_").concat(We)}function Vt(r,t){var e,i=document.createElement(r),a=t!=null?t:{};for(var n in a)i.style[n]=(e=a[n])!==null&&e!==void 0?e:"";return i}function je(r,t,e){var i=0,a=0;for(a=r.length-1;i!==a;){var n=Math.floor((a+i)/2),o=a-i,s=r[n][t];if(e===r[i][t])return i;if(e===r[a][t])return a;if(e===s)return n;if(e>s?i=n:a=n,o<=2)break}return i}function Ui(r){var t=Math.floor(ce(r)),e=Zt(t),i=r/e,a=0;return i<1.5?a=1:i<2.5?a=2:i<3.5?a=3:i<4.5?a=4:i<5.5?a=5:i<6.5?a=6:a=8,r=a*e,t>=-20?+r.toFixed(t<0?-t:0):r}function hr(r,t){t==null&&(t=10),t=Math.min(Math.max(0,t),20);var e=(+r).toFixed(t);return+e}function qi(r){var t=r.toString(),e=t.indexOf("e");if(e>0){var i=+t.slice(e+1);return i<0?-i:0}else{var a=t.indexOf(".");return a<0?0:t.length-1-a}}function Mr(r,t,e){var i=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return r.forEach(function(a){var n,o;i[0]=Math.max((n=a[t])!==null&&n!==void 0?n:a,i[0]),i[1]=Math.min((o=a[e])!==null&&o!==void 0?o:a,i[1])}),i}function ce(r){return Math.log(r)/Math.log(10)}function Zt(r){return Math.pow(10,r)}function vr(){return{from:0,to:0,realFrom:0,realTo:0}}var dr={MIN:1,MAX:50},Zi=6,Ki=50,Ji=function(){function r(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=Zi,this._offsetRightDistance=Ki,this._startLastBarRightSideDiffBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange=vr(),this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace}return r.prototype._calcGapBarSpace=function(){var t=Math.floor(this._barSpace*.82),e=Math.floor(this._barSpace),i=Math.min(t,e-1);return Math.max(1,i)},r.prototype.adjustVisibleRange=function(){var t,e=this._chartStore.getDataList(),i=e.length,a=this._totalBarSpace/this._barSpace,n,o;this._scrollLimitRole===1?(n=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,o=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(n=this._minVisibleBarCount.left,o=this._minVisibleBarCount.right),n=Math.max(0,n),o=Math.max(0,o);var s=a-Math.min(n,i);this._lastBarRightSideDiffBarCount>s&&(this._lastBarRightSideDiffBarCount=s);var l=-i+Math.min(o,i);this._lastBarRightSideDiffBarCount<l&&(this._lastBarRightSideDiffBarCount=l);var u=Math.round(this._lastBarRightSideDiffBarCount+i+.5);u>i&&(u=i);var c=Math.round(u-a)-1;c<0&&(c=0);var h=this._lastBarRightSideDiffBarCount>0?Math.round(i+this._lastBarRightSideDiffBarCount-a)-1:c;if(this._visibleRange={from:c,to:u,realFrom:h,realTo:u},this._chartStore.getActionStore().execute(Tt.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),c===0&&this._more&&!this._loading&&this._loadMoreCallback!==null){this._loading=!0;var f=e[0];this._loadMoreCallback((t=f==null?void 0:f.timestamp)!==null&&t!==void 0?t:null)}},r.prototype.setMore=function(t){return this._more=t,this},r.prototype.setLoading=function(t){return this._loading=t,this},r.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},r.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};j(t)&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(a){}return i},r.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);e!==null&&(this._dateTimeFormat=e)},r.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},r.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},r.prototype.setBarSpace=function(t,e){t<dr.MIN||t>dr.MAX||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),e==null||e(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},r.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},r.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=this._scrollLimitRole===1?Math.min(this._maxOffsetDistance.right,t):t,this._lastBarRightSideDiffBarCount=this._offsetRightDistance/this._barSpace,e!=null&&e&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},r.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},r.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},r.prototype.getOffsetRightDistance=function(){return Math.max(0,this._lastBarRightSideDiffBarCount*this._barSpace)},r.prototype.getLastBarRightSideDiffBarCount=function(){return this._lastBarRightSideDiffBarCount},r.prototype.setLastBarRightSideDiffBarCount=function(t){return this._lastBarRightSideDiffBarCount=t,this},r.prototype.setMaxOffsetLeftDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.left=t,this},r.prototype.setMaxOffsetRightDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.right=t,this},r.prototype.setLeftMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.left=t,this},r.prototype.setRightMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.right=t,this},r.prototype.getVisibleRange=function(){return this._visibleRange},r.prototype.startScroll=function(){this._startLastBarRightSideDiffBarCount=this._lastBarRightSideDiffBarCount},r.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace;this._chartStore.getActionStore().execute(Tt.OnScroll),this._lastBarRightSideDiffBarCount=this._startLastBarRightSideDiffBarCount-e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},r.prototype.getDataByDataIndex=function(t){var e;return(e=this._chartStore.getDataList()[t])!==null&&e!==void 0?e:null},r.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,i=(this._totalBarSpace-t)/this._barSpace,a=e+this._lastBarRightSideDiffBarCount-i;return Math.round(a*1e6)/1e6},r.prototype.dataIndexToTimestamp=function(t){var e,i=this.getDataByDataIndex(t);return(e=i==null?void 0:i.timestamp)!==null&&e!==void 0?e:null},r.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return e.length===0?0:je(e,"timestamp",t)},r.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length,i=e+this._lastBarRightSideDiffBarCount-t;return Math.floor(this._totalBarSpace-(i-.5)*this._barSpace)-.5},r.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},r.prototype.zoom=function(t,e){var i=this,a;if(this._zoomEnabled){if(!X(e==null?void 0:e.x)){var n=this._chartStore.getTooltipStore().getCrosshair();e={x:(a=n==null?void 0:n.x)!==null&&a!==void 0?a:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(Tt.OnZoom);var o=this.coordinateToFloatIndex(e==null?void 0:e.x),s=this._barSpace+t*(this._barSpace/10);this.setBarSpace(s,function(){i._lastBarRightSideDiffBarCount+=o-i.coordinateToFloatIndex(e==null?void 0:e.x)})}},r.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},r.prototype.getZoomEnabled=function(){return this._zoomEnabled},r.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},r.prototype.getScrollEnabled=function(){return this._scrollEnabled},r.prototype.setLoadMoreCallback=function(t){return this._loadMoreCallback=t,this},r.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange=vr()},r}(),Qi={name:"AVP",shortName:"AVP",series:yt.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(r){var t=0,e=0;return r.map(function(i){var a,n,o={},s=(a=i==null?void 0:i.turnover)!==null&&a!==void 0?a:0,l=(n=i==null?void 0:i.volume)!==null&&n!==void 0?n:0;return t+=s,e+=l,e!==0&&(o.avp=t/e),o})}},$i={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(r,t,e){var i,a,n,o,s=r.prev,l=r.current,u=(a=(i=s.indicatorData)===null||i===void 0?void 0:i.ao)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER,c=(o=(n=l.indicatorData)===null||n===void 0?void 0:n.ao)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,h;c>u?h=rt(t.styles,"bars[0].upColor",e.bars[0].upColor):h=rt(t.styles,"bars[0].downColor",e.bars[0].downColor);var f=c>u?J.Stroke:J.Fill;return{color:h,style:f,borderColor:h}}}],calc:function(r,t){var e=t.calcParams,i=Math.max(e[0],e[1]),a=0,n=0,o=0,s=0;return r.map(function(l,u){var c={},h=(l.low+l.high)/2;if(a+=h,n+=h,u>=e[0]-1){o=a/e[0];var f=r[u-(e[0]-1)];a-=(f.low+f.high)/2}if(u>=e[1]-1){s=n/e[1];var f=r[u-(e[1]-1)];n-=(f.low+f.high)/2}return u>=i-1&&(c.ao=o-s),c})}},ta={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(r){return r.map(function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}})},calc:function(r,t){var e=t.calcParams,i=t.figures,a=[];return r.map(function(n,o){var s={},l=n.close;return e.forEach(function(u,c){var h;if(a[c]=((h=a[c])!==null&&h!==void 0?h:0)+l,o>=u-1){var f=a[c]/e[c];s[i[c].key]=(l-f)/f*100,a[c]-=r[o-(u-1)].close}}),s})}};function ea(r,t){var e=r.length,i=0;return r.forEach(function(a){var n=a.close-t;i+=n*n}),i=Math.abs(i),Math.sqrt(i/e)}var ra={name:"BOLL",shortName:"BOLL",series:yt.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=e[0]-1,a=0;return r.map(function(n,o){var s=n.close,l={};if(a+=s,o>=i){l.mid=a/e[0];var u=ea(r.slice(o-i,o+1),l.mid);l.up=l.mid+e[1]*u,l.dn=l.mid-e[1]*u,a-=r[o-i].close}return l})}},ia={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=0,n=0,o=0;return r.map(function(s,l){var u,c,h={},f=s.high,v=s.low,d=s.open,g=((u=r[l-1])!==null&&u!==void 0?u:s).close;if(n+=f-d,o+=d-v,i+=f-g,a+=g-v,l>=e[0]-1){o!==0?h.ar=n/o*100:h.ar=0,a!==0?h.br=i/a*100:h.br=0;var p=r[l-(e[0]-1)],m=p.high,_=p.low,y=p.open,x=((c=r[l-e[0]])!==null&&c!==void 0?c:r[l-(e[0]-1)]).close;i-=m-x,a-=x-_,n-=m-y,o-=y-_}return h})}},aa={name:"BBI",shortName:"BBI",series:yt.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=Math.max.apply(Math,wr([],dt(e),!1)),a=[],n=[];return r.map(function(o,s){var l={},u=o.close;if(e.forEach(function(h,f){var v;a[f]=((v=a[f])!==null&&v!==void 0?v:0)+u,s>=h-1&&(n[f]=a[f]/h,a[f]-=r[s-(h-1)].close)}),s>=i-1){var c=0;n.forEach(function(h){c+=h}),l.bbi=c/4}return l})}},na={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=e[0]-1,a=0,n=[];return r.map(function(o,s){var l={},u=(o.high+o.low+o.close)/3;if(a+=u,n.push(u),s>=i){var c=a/e[0],h=n.slice(s-i,s+1),f=0;h.forEach(function(g){f+=Math.abs(g-c)});var v=f/e[0];l.cci=v!==0?(u-c)/v/.015:0;var d=(r[s-i].high+r[s-i].low+r[s-i].close)/3;a-=d}return l})}},oa={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=Math.ceil(e[1]/2.5+1),a=Math.ceil(e[2]/2.5+1),n=Math.ceil(e[3]/2.5+1),o=Math.ceil(e[4]/2.5+1),s=0,l=[],u=0,c=[],h=0,f=[],v=0,d=[],g=[];return r.forEach(function(p,m){var _,y,x,b,I,C={},E=(_=r[m-1])!==null&&_!==void 0?_:p,A=(E.high+E.close+E.low+E.open)/4,F=Math.max(0,p.high-A),P=Math.max(0,A-p.low);m>=e[0]-1&&(P!==0?C.cr=F/P*100:C.cr=0,s+=C.cr,u+=C.cr,h+=C.cr,v+=C.cr,m>=e[0]+e[1]-2&&(l.push(s/e[1]),m>=e[0]+e[1]+i-3&&(C.ma1=l[l.length-1-i]),s-=(y=g[m-(e[1]-1)].cr)!==null&&y!==void 0?y:0),m>=e[0]+e[2]-2&&(c.push(u/e[2]),m>=e[0]+e[2]+a-3&&(C.ma2=c[c.length-1-a]),u-=(x=g[m-(e[2]-1)].cr)!==null&&x!==void 0?x:0),m>=e[0]+e[3]-2&&(f.push(h/e[3]),m>=e[0]+e[3]+n-3&&(C.ma3=f[f.length-1-n]),h-=(b=g[m-(e[3]-1)].cr)!==null&&b!==void 0?b:0),m>=e[0]+e[4]-2&&(d.push(v/e[4]),m>=e[0]+e[4]+o-3&&(C.ma4=d[d.length-1-o]),v-=(I=g[m-(e[4]-1)].cr)!==null&&I!==void 0?I:0)),g.push(C)}),g}},sa={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=Math.max(e[0],e[1]),a=0,n=0,o=0,s=[];return r.forEach(function(l,u){var c,h={},f=l.close;a+=f,n+=f;var v=0,d=0;if(u>=e[0]-1&&(v=a/e[0],a-=r[u-(e[0]-1)].close),u>=e[1]-1&&(d=n/e[1],n-=r[u-(e[1]-1)].close),u>=i-1){var g=v-d;h.dma=g,o+=g,u>=i+e[2]-2&&(h.ama=o/e[2],o-=(c=s[u-(e[2]-1)].dma)!==null&&c!==void 0?c:0)}s.push(h)}),s}},la={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=0,n=0,o=0,s=0,l=0,u=0,c=0,h=[];return r.forEach(function(f,v){var d,g,p={},m=(d=r[v-1])!==null&&d!==void 0?d:f,_=m.close,y=f.high,x=f.low,b=y-x,I=Math.abs(y-_),C=Math.abs(_-x),E=y-m.high,A=m.low-x,F=Math.max(Math.max(b,I),C),P=E>0&&E>A?E:0,L=A>0&&A>E?A:0;if(i+=F,a+=P,n+=L,v>=e[0]-1){v>e[0]-1?(o=o-o/e[0]+F,s=s-s/e[0]+P,l=l-l/e[0]+L):(o=i,s=a,l=n);var T=0,N=0;o!==0&&(T=s*100/o,N=l*100/o),p.pdi=T,p.mdi=N;var U=0;N+T!==0&&(U=Math.abs(N-T)/(N+T)*100),u+=U,v>=e[0]*2-2&&(v>e[0]*2-2?c=(c*(e[0]-1)+U)/e[0]:c=u/e[0],p.adx=c,v>=e[0]*2+e[1]-3&&(p.adxr=(((g=h[v-(e[1]-1)].adx)!==null&&g!==void 0?g:0)+c)/2))}h.push(p)}),h}},ua={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=[];return r.map(function(n,o){var s,l={};if(o>0){var u=r[o-1],c=n.high,h=n.low,f=(s=n.volume)!==null&&s!==void 0?s:0,v=(c+h)/2-(u.high+u.low)/2;if(f===0||c-h===0)l.emv=0;else{var d=f/1e8/(c-h);l.emv=v/d}i+=l.emv,a.push(l.emv),o>=e[0]&&(l.maEmv=i/e[0],i-=a[o-e[0]])}return l})}},ca={name:"EMA",shortName:"EMA",series:yt.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(r){return r.map(function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}})},calc:function(r,t){var e=t.calcParams,i=t.figures,a=0,n=[];return r.map(function(o,s){var l={},u=o.close;return a+=u,e.forEach(function(c,h){s>=c-1&&(s>c-1?n[h]=(2*u+(c-1)*n[h])/(c+1):n[h]=a/c,l[i[h].key]=n[h])}),l})}},ha={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=[];return r.forEach(function(n,o){var s,l={};if(o>=e[0]){var u=n.close,c=r[o-e[0]].close;l.mtm=u-c,i+=l.mtm,o>=e[0]+e[1]-1&&(l.maMtm=i/e[1],i-=(s=a[o-(e[1]-1)].mtm)!==null&&s!==void 0?s:0)}a.push(l)}),a}},va={name:"MA",shortName:"MA",series:yt.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(r){return r.map(function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}})},calc:function(r,t){var e=t.calcParams,i=t.figures,a=[];return r.map(function(n,o){var s={},l=n.close;return e.forEach(function(u,c){var h;a[c]=((h=a[c])!==null&&h!==void 0?h:0)+l,o>=u-1&&(s[i[c].key]=a[c]/u,a[c]-=r[o-(u-1)].close)}),s})}},da={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(r,t,e){var i,a,n,o,s=r.prev,l=r.current,u=(a=(i=s.indicatorData)===null||i===void 0?void 0:i.macd)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER,c=(o=(n=l.indicatorData)===null||n===void 0?void 0:n.macd)!==null&&o!==void 0?o:Number.MIN_SAFE_INTEGER,h;c>0?h=rt(t.styles,"bars[0].upColor",e.bars[0].upColor):c<0?h=rt(t.styles,"bars[0].downColor",e.bars[0].downColor):h=rt(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor);var f=u<c?J.Stroke:J.Fill;return{style:f,color:h,borderColor:h}}}],calc:function(r,t){var e=t.calcParams,i=0,a,n,o=0,s=0,l=0,u=Math.max(e[0],e[1]);return r.map(function(c,h){var f={},v=c.close;return i+=v,h>=e[0]-1&&(h>e[0]-1?a=(2*v+(e[0]-1)*a)/(e[0]+1):a=i/e[0]),h>=e[1]-1&&(h>e[1]-1?n=(2*v+(e[1]-1)*n)/(e[1]+1):n=i/e[1]),h>=u-1&&(o=a-n,f.dif=o,s+=o,h>=u+e[2]-2&&(h>u+e[2]-2?l=(o*2+l*(e[2]-1))/(e[2]+1):l=s/e[2],f.macd=(o-l)*2,f.dea=l)),f})}},fa={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=0,n=[];return r.forEach(function(o,s){var l,u,c,h,f=(l=r[s-1])!==null&&l!==void 0?l:o;o.close<f.close?a-=(u=o.volume)!==null&&u!==void 0?u:0:o.close>f.close&&(a+=(c=o.volume)!==null&&c!==void 0?c:0);var v={obv:a};i+=a,s>=e[0]-1&&(v.maObv=i/e[0],i-=(h=n[s-(e[0]-1)].obv)!==null&&h!==void 0?h:0),n.push(v)}),n}},pa={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(r){var t=0;return r.map(function(e,i){var a,n,o={},s=e.close,l=(a=e.volume)!==null&&a!==void 0?a:1,u=((n=r[i-1])!==null&&n!==void 0?n:e).close,c=0,h=u*l;return h!==0&&(c=(s-u)/h),t+=c,o.pvt=t,o})}},ga={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=0,n=[],o=[];return r.forEach(function(s,l){var u,c,h={},f=((u=r[l-1])!==null&&u!==void 0?u:s).close,v=s.close-f>0?1:0;n.push(v),i+=v,l>=e[0]-1&&(h.psy=i/e[0]*100,a+=h.psy,l>=e[0]+e[1]-2&&(h.maPsy=a/e[1],a-=(c=o[l-(e[1]-1)].psy)!==null&&c!==void 0?c:0),i-=n[l-(e[0]-1)]),o.push(h)}),o}},ma={name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=[],a=0;return r.forEach(function(n,o){var s,l,u={};if(o>=e[0]-1){var c=n.close,h=((s=r[o-e[0]])!==null&&s!==void 0?s:r[o-(e[0]-1)]).close;h!==0?u.roc=(c-h)/h*100:u.roc=0,a+=u.roc,o>=e[0]-1+e[1]-1&&(u.maRoc=a/e[1],a-=(l=i[o-(e[1]-1)].roc)!==null&&l!==void 0?l:0)}i.push(u)}),i}},_a={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(r){return r.map(function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}})},calc:function(r,t){var e=t.calcParams,i=t.figures,a=[],n=[];return r.map(function(o,s){var l,u={},c=((l=r[s-1])!==null&&l!==void 0?l:o).close,h=o.close-c;return e.forEach(function(f,v){var d,g,p;if(h>0?a[v]=((d=a[v])!==null&&d!==void 0?d:0)+h:n[v]=((g=n[v])!==null&&g!==void 0?g:0)+Math.abs(h),s>=f-1){n[v]!==0?u[i[v].key]=100-100/(1+a[v]/n[v]):u[i[v].key]=0;var m=r[s-(f-1)],_=(p=r[s-f])!==null&&p!==void 0?p:m,y=m.close-_.close;y>0?a[v]-=y:n[v]-=Math.abs(y)}}),u})}},ya={name:"SMA",shortName:"SMA",series:yt.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(r,t){var e=t.calcParams,i=0,a=0;return r.map(function(n,o){var s={},l=n.close;return i+=l,o>=e[0]-1&&(o>e[0]-1?a=(l*e[1]+a*(e[0]-e[1]+1))/(e[0]+1):a=i/e[0],s.sma=a),s})}},xa={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=[];return r.forEach(function(a,n){var o,s,l,u,c={},h=a.close;if(n>=e[0]-1){var f=Mr(r.slice(n-(e[0]-1),n+1),"high","low"),v=f[0],d=f[1],g=v-d,p=(h-d)/(g===0?1:g)*100;c.k=((e[1]-1)*((s=(o=i[n-1])===null||o===void 0?void 0:o.k)!==null&&s!==void 0?s:50)+p)/e[1],c.d=((e[2]-1)*((u=(l=i[n-1])===null||l===void 0?void 0:l.d)!==null&&u!==void 0?u:50)+c.k)/e[2],c.j=3*c.k-2*c.d}i.push(c)}),i}},Sa={name:"SAR",shortName:"SAR",series:yt.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(r,t,e){var i,a,n=r.current,o=(a=(i=n.indicatorData)===null||i===void 0?void 0:i.sar)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER,s=n.kLineData,l=((s==null?void 0:s.high)+(s==null?void 0:s.low))/2,u=o<l?rt(t.styles,"circles[0].upColor",e.circles[0].upColor):rt(t.styles,"circles[0].downColor",e.circles[0].downColor);return{color:u}}}],calc:function(r,t){var e=t.calcParams,i=e[0]/100,a=e[1]/100,n=e[2]/100,o=i,s=-100,l=!1,u=0;return r.map(function(c,h){var f=u,v=c.high,d=c.low;if(l){(s===-100||s<v)&&(s=v,o=Math.min(o+a,n)),u=f+o*(s-f);var g=Math.min(r[Math.max(1,h)-1].low,d);u>c.low?(u=s,o=i,s=-100,l=!l):u>g&&(u=g)}else{(s===-100||s>d)&&(s=d,o=Math.min(o+a,n)),u=f+o*(s-f);var p=Math.max(r[Math.max(1,h)-1].high,v);u<c.high?(u=s,o=0,s=-100,l=!l):u<p&&(u=p)}return{sar:u}})}},ba={name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a,n,o,s=0,l=0,u=0,c=[];return r.forEach(function(h,f){var v,d={},g=h.close;if(i+=g,f>=e[0]-1&&(f>e[0]-1?a=(2*g+(e[0]-1)*a)/(e[0]+1):a=i/e[0],s+=a,f>=e[0]*2-2&&(f>e[0]*2-2?n=(2*a+(e[0]-1)*n)/(e[0]+1):n=s/e[0],l+=n,f>=e[0]*3-3))){var p=void 0,m=0;f>e[0]*3-3?(p=(2*n+(e[0]-1)*o)/(e[0]+1),m=(p-o)/o*100):p=l/e[0],o=p,d.trix=m,u+=m,f>=e[0]*3+e[1]-4&&(d.maTrix=u/e[1],u-=(v=c[f-(e[1]-1)].trix)!==null&&v!==void 0?v:0)}c.push(d)}),c}},Ca={name:"VOL",shortName:"VOL",series:yt.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(r,t,e){var i=r.current.kLineData,a;return i.close>i.open?a=rt(t.styles,"bars[0].upColor",e.bars[0].upColor):i.close<i.open?a=rt(t.styles,"bars[0].downColor",e.bars[0].downColor):a=rt(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor),{color:a}}}],regenerateFigures:function(r){var t=r.map(function(e,i){return{key:"ma".concat(i+1),title:"MA".concat(e,": "),type:"line"}});return t.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(e,i,a){var n=e.current.kLineData,o;return n.close>n.open?o=rt(i.styles,"bars[0].upColor",a.bars[0].upColor):n.close<n.open?o=rt(i.styles,"bars[0].downColor",a.bars[0].downColor):o=rt(i.styles,"bars[0].noChangeColor",a.bars[0].noChangeColor),{color:o}}}),t},calc:function(r,t){var e=t.calcParams,i=t.figures,a=[];return r.map(function(n,o){var s,l=(s=n.volume)!==null&&s!==void 0?s:0,u={volume:l};return e.forEach(function(c,h){var f,v;a[h]=((f=a[h])!==null&&f!==void 0?f:0)+l,o>=c-1&&(u[i[h].key]=a[h]/c,a[h]-=(v=r[o-(c-1)].volume)!==null&&v!==void 0?v:0)}),u})}},wa={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(r,t){var e=t.calcParams,i=0,a=0,n=0,o=0,s=[];return r.forEach(function(l,u){var c,h,f,v,d,g={},p=l.close,m=((c=r[u-1])!==null&&c!==void 0?c:l).close,_=(h=l.volume)!==null&&h!==void 0?h:0;if(p>m?i+=_:p<m?a+=_:n+=_,u>=e[0]-1){var y=n/2;a+y===0?g.vr=0:g.vr=(i+y)/(a+y)*100,o+=g.vr,u>=e[0]+e[1]-2&&(g.maVr=o/e[1],o-=(f=s[u-(e[1]-1)].vr)!==null&&f!==void 0?f:0);var x=r[u-(e[0]-1)],b=(v=r[u-e[0]])!==null&&v!==void 0?v:x,I=x.close,C=(d=x.volume)!==null&&d!==void 0?d:0;I>b.close?i-=C:I<b.close?a-=C:n-=C}s.push(g)}),s}},Ia={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(r){return r.map(function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}})},calc:function(r,t){var e=t.calcParams,i=t.figures;return r.map(function(a,n){var o={},s=a.close;return e.forEach(function(l,u){var c=l-1;if(n>=c){var h=Mr(r.slice(n-c,n+1),"high","low"),f=h[0],v=h[1],d=f-v;o[i[u].key]=d===0?0:(s-f)/d*100}}),o})}},Pr={},Ea=[Qi,$i,ta,ra,ia,aa,na,oa,sa,la,ua,ca,ha,va,da,fa,pa,ga,ma,_a,ya,xa,Sa,ba,Ca,wa,Ia];Ea.forEach(function(r){Pr[r.name]=Wi.extend(r)});function Tr(r){var t;return(t=Pr[r])!==null&&t!==void 0?t:null}var Ma=function(){function r(t){this._instances=new Map,this._chartStore=t}return r.prototype._overrideInstance=function(t,e){var i=e.shortName,a=e.series,n=e.calcParams,o=e.precision,s=e.figures,l=e.minValue,u=e.maxValue,c=e.shouldOhlc,h=e.shouldFormatBigNumber,f=e.visible,v=e.zLevel,d=e.styles,g=e.extendData,p=e.regenerateFigures,m=e.createTooltipDataSource,_=e.draw,y=e.calc,x=!1;j(i)&&t.setShortName(i)&&(x=!0),k(a)&&t.setSeries(a)&&(x=!0);var b=!1;Lt(n)&&t.setCalcParams(n)&&(x=!0,b=!0),Lt(s)&&t.setFigures(s)&&(x=!0,b=!0),t.setMinValue(l!=null?l:null)&&(x=!0),t.setMinValue(u!=null?u:null)&&(x=!0),X(o)&&t.setPrecision(o)&&(x=!0),Qt(c)&&t.setShouldOhlc(c)&&(x=!0),Qt(h)&&t.setShouldFormatBigNumber(h)&&(x=!0),Qt(f)&&t.setVisible(f)&&(x=!0);var I=!1;return X(v)&&t.setZLevel(v)&&(x=!0,I=!0),k(d)&&t.setStyles(d)&&(x=!0),t.setExtendData(g)&&(x=!0,b=!0),p!==void 0&&t.setRegenerateFigures(p)&&(x=!0),m!==void 0&&t.setCreateTooltipDataSource(m)&&(x=!0),_!==void 0&&t.setDraw(_)&&(x=!0),Nt(y)&&(t.calc=y,b=!0),[x,b,I]},r.prototype._sort=function(t){var e;j(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(i,a){return i.zLevel-a.zLevel}):this._instances.forEach(function(i){i.sort(function(a,n){return a.zLevel-n.zLevel})})},r.prototype.addInstance=function(t,e,i){return Ce(this,void 0,void 0,function(){var a,n,o,s,l;return we(this,function(u){switch(u.label){case 0:return a=t.name,n=this._instances.get(e),k(n)?(o=n.find(function(c){return c.name===a}),k(o)?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2]):[3,2];case 1:return[2,u.sent()];case 2:return k(n)||(n=[]),s=Tr(a),l=new s,this._overrideInstance(l,t),i||(n=[]),n.push(l),this._instances.set(e,n),this._sort(e),[4,l.calcIndicator(this._chartStore.getDataList())];case 3:return[2,u.sent()]}})})},r.prototype.getInstances=function(t){var e;return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},r.prototype.removeInstance=function(t,e){var i,a=!1,n=this._instances.get(t);if(k(n)){if(j(e)){var o=n.findIndex(function(s){return s.name===e});o>-1&&(n.splice(o,1),a=!0)}else this._instances.set(t,[]),a=!0;((i=this._instances.get(t))===null||i===void 0?void 0:i.length)===0&&this._instances.delete(t)}return a},r.prototype.hasInstances=function(t){return this._instances.has(t)},r.prototype.calcInstance=function(t,e){return Ce(this,void 0,void 0,function(){var i,a,n,o,s=this;return we(this,function(l){switch(l.label){case 0:return i=[],j(t)?j(e)?(a=this._instances.get(e),k(a)&&(n=a.find(function(u){return u.name===t}),k(n)&&i.push(n.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(u){var c=u.find(function(h){return h.name===t});k(c)&&i.push(c.calcIndicator(s._chartStore.getDataList()))}):this._instances.forEach(function(u){u.forEach(function(c){i.push(c.calcIndicator(s._chartStore.getDataList()))})}),[4,Promise.all(i)];case 1:return o=l.sent(),[2,o.includes(!0)]}})})},r.prototype.getInstanceByPaneId=function(t,e){var i,a,n=function(l){var u=new Map;return l.forEach(function(c){u.set(c.name,c)}),u};if(j(t)){var o=(i=this._instances.get(t))!==null&&i!==void 0?i:[];return j(e)?(a=o==null?void 0:o.find(function(l){return l.name===e}))!==null&&a!==void 0?a:null:n(o)}var s=new Map;return this._instances.forEach(function(l,u){s.set(u,n(l))}),s},r.prototype.setSeriesPrecision=function(t){this._instances.forEach(function(e){e.forEach(function(i){i.series===yt.Price&&i.setPrecision(t.price,!0),i.series===yt.Volume&&i.setPrecision(t.volume,!0)})})},r.prototype.override=function(t,e){return Ce(this,void 0,void 0,function(){var i,a,n,o,s,l,u,c=this;return we(this,function(h){switch(h.label){case 0:return i=t.name,a=new Map,e!==null?(n=this._instances.get(e),k(n)&&a.set(e,n)):a=this._instances,o=!1,s=[],l=!1,a.forEach(function(f){var v=f.find(function(g){return g.name===i});if(k(v)){var d=c._overrideInstance(v,t);d[2]&&(l=!0),d[1]?s.push(v.calcIndicator(c._chartStore.getDataList())):d[0]&&(o=!0)}}),l&&this._sort(),[4,Promise.all(s)];case 1:return u=h.sent(),[2,[o,u.includes(!0)]]}})})},r}(),Pa=function(){function r(t){this._crosshair={},this._activeIcon=null,this._chartStore=t}return r.prototype.setCrosshair=function(t,e){var i=this._chartStore.getDataList(),a=t!=null?t:{},n,o;X(a.x)?(n=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x),n<0?o=0:n>i.length-1?o=i.length-1:o=n):(n=i.length-1,o=n);var s=i[o],l=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(n),u={x:this._crosshair.x,y:this._crosshair.y,paneId:this._crosshair.paneId};this._crosshair=V(V({},a),{realX:l,kLineData:s,realDataIndex:n,dataIndex:o}),(u.x!==a.x||u.y!==a.y||u.paneId!==a.paneId)&&(s!==null&&this._chartStore.getChart().crosshairChange(this._crosshair),e!=null&&e||this._chartStore.getChart().updatePane(1))},r.prototype.recalculateCrosshair=function(t){this.setCrosshair(this._crosshair,t)},r.prototype.getCrosshair=function(){return this._crosshair},r.prototype.setActiveIcon=function(t){this._activeIcon=t!=null?t:null},r.prototype.getActiveIcon=function(){return this._activeIcon},r.prototype.clear=function(){this.setCrosshair({},!0),this.setActiveIcon()},r}(),Ta={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding,i=r.overlay,a=r.precision,n=r.thousandsSeparator,o=i.points;if(t.length>0){var s=[],l=[],u=0,c=e.width;if(t.length>1&&X(o[0].value)&&X(o[1].value)){var h=[1,.786,.618,.5,.382,.236,0],f=t[0].y-t[1].y,v=o[0].value-o[1].value;h.forEach(function(d){var g,p=t[1].y+f*d,m=ht((((g=o[1].value)!==null&&g!==void 0?g:0)+v*d).toFixed(a.price),n);s.push({coordinates:[{x:u,y:p},{x:c,y:p}]}),l.push({x:u,y:p,text:"".concat(m," (").concat((d*100).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:s},{type:"text",isCheckEvent:!1,attrs:l}]}return[]}},Da={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding,i={x:0,y:t[0].y};return k(t[1])&&t[0].x<t[1].x&&(i.x=e.width),[{type:"line",attrs:{coordinates:[t[0],i]}}]},performEventPressedMove:function(r){var t=r.points,e=r.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(r){var t=r.currentStep,e=r.points,i=r.performPoint;t===2&&(e[0].value=i.value)}},Aa={name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=[];return t.length===2&&e.push({coordinates:t}),[{type:"line",attrs:e}]},performEventPressedMove:function(r){var t=r.points,e=r.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(r){var t=r.currentStep,e=r.points,i=r.performPoint;t===2&&(e[0].value=i.value)}},ka={name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:e.width,y:t[0].y}]}}]}},Ze=function(){function r(){this._children=[],this._callbacks=new Map}return r.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},r.prototype.onEvent=function(t,e,i){var a=this._callbacks.get(t);return k(a)&&this.checkEventOn(e)?a(e,i):!1},r.prototype.checkEventOn=function(t){var e,i;try{for(var a=$t(this._children),n=a.next();!n.done;n=a.next()){var o=n.value;if(o.checkEventOn(t))return!0}}catch(s){e={error:s}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return!1},r.prototype.dispatchEvent=function(t,e,i){var a=this._children.length-1;if(a>-1){for(var n=a;n>-1;n--)if(this._children[n].dispatchEvent(t,e,i))return!0}return this.onEvent(t,e,i)},r.prototype.addChild=function(t){return this._children.push(t),this},r.prototype.clear=function(){this._children=[]},r}(),st=2,Fa=function(r){Z(t,r);function t(e){var i=r.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return t.prototype.checkEventOn=function(e){return this.checkEventOnImp(e,this.attrs,this.styles)},t.prototype.draw=function(e){this.drawImp(e,this.attrs,this.styles)},t.extend=function(e){var i=function(a){Z(n,a);function n(){return a!==null&&a.apply(this,arguments)||this}return n.prototype.checkEventOnImp=function(o,s,l){return e.checkEventOn(o,s,l)},n.prototype.drawImp=function(o,s,l){e.draw(o,s,l)},n}(t);return i},t}(Ze);function fr(r,t){return Math.sqrt(Math.pow(r.x+t.x,2)+Math.pow(r.y+t.y,2))}function Ra(r){var t=fr(r[0],r[1]),e=fr(r[1],r[2]),i=t+e,a=[r[2].x-r[0].x,r[2].y-r[0].y];return[{x:r[1].x-a[0]*.5*t/i,y:r[1].y-a[1]*.5*t/i},{x:r[1].x+a[0]*.5*t/i,y:r[1].y+a[1]*.5*t/i}]}function La(r,t){var e=t.coordinates;if(e.length>1)for(var i=1;i<e.length;i++){var a=e[i-1],n=e[i];if(a.x===n.x){if(Math.abs(a.y-r.y)+Math.abs(n.y-r.y)-Math.abs(a.y-n.y)<st+st&&Math.abs(r.x-a.x)<st)return!0}else{var o=Ke(a,n),s=Dr(o,r),l=Math.abs(s-r.y);if(Math.abs(a.x-r.x)+Math.abs(n.x-r.x)-Math.abs(a.x-n.x)<st+st&&l*l/(o[0]*o[0]+1)<st*st)return!0}}return!1}function Dr(r,t){return r!=null?t.x*r[0]+r[1]:t.y}function Me(r,t,e){var i=Ke(r,t);return Dr(i,e)}function Ke(r,t){var e=r.x-t.x;if(e!==0){var i=(r.y-t.y)/e,a=r.y-i*r.x;return[i,a]}return null}function Ba(r,t,e){var i=t.coordinates,a=i.length;if(a>1){var n=e.style,o=n===void 0?$.Solid:n,s=e.smooth,l=e.size,u=l===void 0?1:l,c=e.color,h=c===void 0?"currentColor":c,f=e.dashedValue,v=f===void 0?[2,2]:f;if(r.lineWidth=u,r.strokeStyle=h,o===$.Dashed?r.setLineDash(v):r.setLineDash([]),r.beginPath(),r.moveTo(i[0].x,i[0].y),s!=null&&s){for(var d=[],g=1;g<a-1;g++)d=d.concat(Ra([i[g-1],i[g],i[g+1]]));r.quadraticCurveTo(d[0].x,d[0].y,i[1].x,i[1].y);for(var p=2;p<a-1;p++)r.bezierCurveTo(d[(p-2)*2+1].x,d[(p-2)*2+1].y,d[(p-1)*2].x,d[(p-1)*2].y,i[p].x,i[p].y);r.quadraticCurveTo(d[(p-2)*2+1].x,d[(p-2)*2+1].y,i[p].x,i[p].y)}else for(var p=1;p<i.length;p++)r.lineTo(i[p].x,i[p].y);r.stroke(),r.closePath()}}var Va={name:"line",checkEventOn:La,draw:function(r,t,e){Ba(r,t,e)}};function Ar(r,t,e){var i=e!=null?e:0,a=[];if(r.length>1)if(r[0].x===r[1].x){var n=0,o=t.height;if(a.push({coordinates:[{x:r[0].x,y:n},{x:r[0].x,y:o}]}),r.length>2){a.push({coordinates:[{x:r[2].x,y:n},{x:r[2].x,y:o}]});for(var s=r[0].x-r[2].x,l=0;l<i;l++){var u=s*(l+1);a.push({coordinates:[{x:r[0].x+u,y:n},{x:r[0].x+u,y:o}]})}}}else{var c=0,h=t.width,f=Ke(r[0],r[1]),v=f[0],d=f[1];if(a.push({coordinates:[{x:c,y:c*v+d},{x:h,y:h*v+d}]}),r.length>2){var g=r[2].y-v*r[2].x;a.push({coordinates:[{x:c,y:c*v+g},{x:h,y:h*v+g}]});for(var s=d-g,l=0;l<i;l++){var p=d+s*(l+1);a.push({coordinates:[{x:c,y:c*v+p},{x:h,y:h*v+p}]})}}}return a}var Na={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;return[{type:"line",attrs:Ar(t,e)}]}},Oa={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;return[{type:"line",attrs:Ar(t,e,1)}]}},Wa={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding,i=r.precision,a=r.overlay,n=r.thousandsSeparator,o=a.points[0].value,s=o===void 0?0:o;return[{type:"line",attrs:{coordinates:[t[0],{x:e.width,y:t[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:t[0].x,y:t[0].y,text:ht(s.toFixed(i.price),n),baseline:"bottom"}}]}};function za(r,t){if(r.length>1){var e=void 0;return r[0].x===r[1].x&&r[0].y!==r[1].y?r[0].y<r[1].y?e={x:r[0].x,y:t.height}:e={x:r[0].x,y:0}:r[0].x>r[1].x?e={x:0,y:Me(r[0],r[1],{x:0,y:r[0].y})}:e={x:t.width,y:Me(r[0],r[1],{x:t.width,y:r[0].y})},{coordinates:[r[0],e]}}return[]}var Xa={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;return[{type:"line",attrs:za(t,e)}]}},Ya={name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]}},Ha={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;return t.length===2?t[0].x===t[1].x?[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Me(t[0],t[1],{x:0,y:t[0].y})},{x:e.width,y:Me(t[0],t[1],{x:e.width,y:t[0].y})}]}}]:[]}},ja={name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;if(t.length===2){var i={x:t[0].x,y:0};return t[0].y<t[1].y&&(i.y=e.height),[{type:"line",attrs:{coordinates:[t[0],i]}}]}return[]},performEventPressedMove:function(r){var t=r.points,e=r.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(r){var t=r.currentStep,e=r.points,i=r.performPoint;t===2&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},Ga={name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]},performEventPressedMove:function(r){var t=r.points,e=r.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(r){var t=r.currentStep,e=r.points,i=r.performPoint;t===2&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},Ua={name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(r){var t=r.coordinates,e=r.bounding;return[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]}},qa={name:"simpleAnnotation",totalStep:2,styles:{line:{style:$.Dashed}},createPointFigures:function(r){var t,e=r.overlay,i=r.coordinates,a;k(e.extendData)&&(Nt(e.extendData)?a=e.extendData(e):a=(t=e.extendData)!==null&&t!==void 0?t:"");var n=i[0].x,o=i[0].y-6,s=o-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:n,y:o},{x:n,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:n,y:s},{x:n-4,y:l},{x:n+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:n,y:l,text:a!=null?a:"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Za={name:"simpleTag",totalStep:2,styles:{line:{style:$.Dashed}},createPointFigures:function(r){var t=r.bounding,e=r.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(r){var t,e,i=r.overlay,a=r.coordinates,n=r.bounding,o=r.yAxis,s=r.precision,l=(t=o==null?void 0:o.isFromZero())!==null&&t!==void 0?t:!1,u,c;l?(u="left",c=0):(u="right",c=n.width);var h;return k(i.extendData)&&(Nt(i.extendData)?h=i.extendData(i):h=(e=i.extendData)!==null&&e!==void 0?e:""),!k(h)&&X(i.points[0].value)&&(h=at(i.points[0].value,s.price)),{type:"text",attrs:{x:c,y:a[0].y,text:h!=null?h:"",align:u,baseline:"middle"}}}},kr={},Ka=[Ta,Da,Aa,ka,Na,Oa,Wa,Xa,Ya,Ha,ja,Ga,Ua,qa,Za];Ka.forEach(function(r){kr[r.name]=Hi.extend(r)});function Ja(r){var t;return(t=kr[r])!==null&&t!==void 0?t:null}var Qa=30,$a=100,Q={CANDLE:"candle_pane",INDICATOR:"indicator_pane_",X_AXIS:"x_axis_pane"},tn=function(){function r(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return r.prototype._overrideInstance=function(t,e){var i=e.id,a=e.groupId,n=e.points,o=e.styles,s=e.lock,l=e.visible,u=e.zLevel,c=e.mode,h=e.modeSensitivity,f=e.extendData,v=e.onDrawStart,d=e.onDrawing,g=e.onDrawEnd,p=e.onClick,m=e.onDoubleClick,_=e.onRightClick,y=e.onPressedMoveStart,x=e.onPressedMoving,b=e.onPressedMoveEnd,I=e.onMouseEnter,C=e.onMouseLeave,E=e.onRemoved,A=e.onSelected,F=e.onDeselected,P=!1,L=!1;return j(i)&&t.setId(i),j(a)&&t.setGroupId(a),Lt(n)&&t.setPoints(n)&&(P=!0),k(o)&&t.setStyles(o)&&(P=!0),Qt(s)&&t.setLock(s),Qt(l)&&t.setVisible(l)&&(P=!0),X(u)&&t.setZLevel(u)&&(P=!0,L=!0),k(c)&&t.setMode(c),X(h)&&t.setModeSensitivity(h),t.setExtendData(f)&&(P=!0),v!==void 0&&t.setOnDrawStartCallback(v),d!==void 0&&t.setOnDrawingCallback(d),g!==void 0&&t.setOnDrawEndCallback(g),p!==void 0&&t.setOnClickCallback(p),m!==void 0&&t.setOnDoubleClickCallback(m),_!==void 0&&t.setOnRightClickCallback(_),y!==void 0&&t.setOnPressedMoveStartCallback(y),x!==void 0&&t.setOnPressedMovingCallback(x),b!==void 0&&t.setOnPressedMoveEndCallback(b),I!==void 0&&t.setOnMouseEnterCallback(I),C!==void 0&&t.setOnMouseLeaveCallback(C),E!==void 0&&t.setOnRemovedCallback(E),A!==void 0&&t.setOnSelectedCallback(A),F!==void 0&&t.setOnDeselectedCallback(F),[P,L]},r.prototype.getInstanceById=function(t){var e,i;try{for(var a=$t(this._instances),n=a.next();!n.done;n=a.next()){var o=n.value,s=o[1],l=s.find(function(u){return u.id===t});if(k(l))return l}}catch(u){e={error:u}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},r.prototype._sort=function(t){var e;j(t)?(e=this._instances.get(t))===null||e===void 0||e.sort(function(i,a){return i.zLevel-a.zLevel}):this._instances.forEach(function(i){i.sort(function(a,n){return a.zLevel-n.zLevel})})},r.prototype.addInstances=function(t,e,i){var a=this,n=t.map(function(o){var s,l,u,c,h=(s=o.id)!==null&&s!==void 0?s:Er(Xi);if(a.getInstanceById(h)===null){var f=Ja(o.name);if(f!==null){var v=new f;v.setPaneId(e);var d=(l=o.groupId)!==null&&l!==void 0?l:h;return o.id=h,o.groupId=d,a._overrideInstance(v,o),v.isDrawing()?a._progressInstanceInfo={paneId:e,instance:v,appointPaneFlag:i}:(a._instances.has(e)||a._instances.set(e,[]),(u=a._instances.get(e))===null||u===void 0||u.push(v)),v.isStart()&&((c=v.onDrawStart)===null||c===void 0||c.call(v,{overlay:v})),h}}return null});return n.some(function(o){return o!==null})&&(this._sort(),this._chartStore.getChart().updatePane(1,e)),n},r.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},r.prototype.progressInstanceComplete=function(){var t;if(this._progressInstanceInfo!==null){var e=this._progressInstanceInfo,i=e.instance,a=e.paneId;i.isDrawing()||(this._instances.has(a)||this._instances.set(a,[]),(t=this._instances.get(a))===null||t===void 0||t.push(i),this._sort(a),this._progressInstanceInfo=null)}},r.prototype.updateProgressInstanceInfo=function(t,e){this._progressInstanceInfo!==null&&(Qt(e)&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t,this._progressInstanceInfo.instance.setPaneId(t))},r.prototype.getInstances=function(t){var e;if(!j(t)){var i=[];return this._instances.forEach(function(a){i=i.concat(a)}),i}return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},r.prototype.override=function(t){var e=this,i=t.id,a=t.groupId,n=t.name,o=!1,s=!1,l=function(v){var d=e._overrideInstance(v,t);d[0]&&(o=!0),d[1]&&(s=!0)};if(j(i)){var u=this.getInstanceById(i);u!==null&&l(u)}else{var c=j(n),h=j(a);if(this._instances.forEach(function(v){v.forEach(function(d){(c&&d.name===n||h&&d.groupId===a||!c&&!h)&&l(d)})}),this._progressInstanceInfo!==null){var f=this._progressInstanceInfo.instance;(c&&f.name===n||h&&f.groupId===a||!c&&!h)&&l(f)}}s&&this._sort(),o&&this._chartStore.getChart().updatePane(1)},r.prototype.removeInstance=function(t){var e,i,a,n=function(g,p){if(j(g.id)){if(p.id!==g.id)return!1}else if(j(g.groupId)){if(p.groupId!==g.groupId)return!1}else if(j(g.name)&&p.name!==g.name)return!1;return!0},o=[],s=k(t);if(this._progressInstanceInfo!==null){var l=this._progressInstanceInfo.instance;(!s||s&&n(t,l))&&(o.push(this._progressInstanceInfo.paneId),(a=l.onRemoved)===null||a===void 0||a.call(l,{overlay:l}),this._progressInstanceInfo=null)}if(s){var u=new Map,c=function(g){var p=g[1],m=p.filter(function(_){var y;return n(t,_)?(o.includes(g[0])||o.push(g[0]),(y=_.onRemoved)===null||y===void 0||y.call(_,{overlay:_}),!1):!0});m.length>0&&u.set(g[0],m)};try{for(var h=$t(this._instances),f=h.next();!f.done;f=h.next()){var v=f.value;c(v)}}catch(g){e={error:g}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(e)throw e.error}}this._instances=u}else this._instances.forEach(function(g,p){o.push(p),g.forEach(function(m){var _;(_=m.onRemoved)===null||_===void 0||_.call(m,{overlay:m})})}),this._instances.clear();if(o.length>0){var d=this._chartStore.getChart();o.forEach(function(g){d.updatePane(1,g)}),d.updatePane(1,Q.X_AXIS)}},r.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},r.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},r.prototype.setHoverInstanceInfo=function(t,e){var i,a,n=this._hoverInstanceInfo,o=n.instance,s=n.figureType,l=n.figureKey,u=n.figureIndex;if(((o==null?void 0:o.id)!==((i=t.instance)===null||i===void 0?void 0:i.id)||s!==t.figureType||u!==t.figureIndex)&&(this._hoverInstanceInfo=t,(o==null?void 0:o.id)!==((a=t.instance)===null||a===void 0?void 0:a.id))){var c=!1,h=!1;o!==null&&(h=!0,Nt(o.onMouseLeave)&&(o.onMouseLeave(V({overlay:o,figureKey:l,figureIndex:u},e)),c=!0)),t.instance!==null&&(h=!0,t.instance.setZLevel(Yi),Nt(t.instance.onMouseEnter)&&(t.instance.onMouseEnter(V({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),c=!0)),h&&this._sort(),c||this._chartStore.getChart().updatePane(1)}},r.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},r.prototype.setClickInstanceInfo=function(t,e){var i,a,n,o,s,l,u,c,h,f=this._clickInstanceInfo,v=f.paneId,d=f.instance,g=f.figureType,p=f.figureKey,m=f.figureIndex;if((a=(i=t.instance)===null||i===void 0?void 0:i.isDrawing())!==null&&a!==void 0&&a||(o=(n=t.instance)===null||n===void 0?void 0:n.onClick)===null||o===void 0||o.call(n,V({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((d==null?void 0:d.id)!==((s=t.instance)===null||s===void 0?void 0:s.id)||g!==t.figureType||m!==t.figureIndex)&&(this._clickInstanceInfo=t,(d==null?void 0:d.id)!==((l=t.instance)===null||l===void 0?void 0:l.id))){(u=d==null?void 0:d.onDeselected)===null||u===void 0||u.call(d,V({overlay:d,figureKey:p,figureIndex:m},e)),(h=(c=t.instance)===null||c===void 0?void 0:c.onSelected)===null||h===void 0||h.call(c,V({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var _=this._chartStore.getChart();_.updatePane(1,t.paneId),v!==t.paneId&&_.updatePane(1,v),_.updatePane(1,Q.X_AXIS)}},r.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},r.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},r.prototype.isDrawing=function(){var t,e;return this._progressInstanceInfo!==null&&((e=(t=this._progressInstanceInfo)===null||t===void 0?void 0:t.instance.isDrawing())!==null&&e!==void 0?e:!1)},r}(),en=function(){function r(){this._actions=new Map}return r.prototype.execute=function(t,e){var i;(i=this._actions.get(t))===null||i===void 0||i.execute(e)},r.prototype.subscribe=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new Oi),(i=this._actions.get(t))===null||i===void 0||i.subscribe(e)},r.prototype.unsubscribe=function(t,e){var i=this._actions.get(t);k(i)&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},r.prototype.has=function(t){var e=this._actions.get(t);return k(e)&&!e.isEmpty()},r}(),rn={grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},an={grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}},nn={light:rn,dark:an};function Fr(r){var t;return(t=nn[r])!==null&&t!==void 0?t:null}var on=function(){function r(t,e){this._styles=Ri(),this._customApi=ji(),this._locale=Gi,this._precision={price:2,volume:0},this._thousandsSeparator=",",this._dataList=[],this._timeScaleStore=new Ji(this),this._indicatorStore=new Ma(this),this._overlayStore=new tn(this),this._tooltipStore=new Pa(this),this._actionStore=new en,this._visibleDataList=[],this._chart=t,this.setOptions(e)}return r.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.from,i=t.to,a=e;a<i;a++){var n=this._dataList[a],o=this._timeScaleStore.dataIndexToCoordinate(a);this._visibleDataList.push({dataIndex:a,x:o,data:n})}},r.prototype.setOptions=function(t){if(k(t)){var e=t.locale,i=t.timezone,a=t.styles,n=t.customApi,o=t.thousandsSeparator;j(e)&&(this._locale=e),j(i)&&this._timeScaleStore.setTimezone(i),k(a)&&(j(a)?It(this._styles,Fr(a)):It(this._styles,a)),k(n)&&It(this._customApi,n),j(o)&&(this._thousandsSeparator=o)}return this},r.prototype.getStyles=function(){return this._styles},r.prototype.getLocale=function(){return this._locale},r.prototype.getCustomApi=function(){return this._customApi},r.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},r.prototype.getPrecision=function(){return this._precision},r.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.setSeriesPrecision(t),this},r.prototype.getDataList=function(){return this._dataList},r.prototype.getVisibleDataList=function(){return this._visibleDataList},r.prototype.addData=function(t,e,i){if(Lt(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(i!=null?i:!0);var a=this._dataList.length===0;this._dataList=t.concat(this._dataList),a&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else{var n=this._dataList.length;if(e>=n){this._dataList.push(t);var o=this._timeScaleStore.getLastBarRightSideDiffBarCount();o<0&&this._timeScaleStore.setLastBarRightSideDiffBarCount(--o),this._timeScaleStore.adjustVisibleRange()}else this._dataList[e]=t,this.adjustVisibleDataList()}this._tooltipStore.recalculateCrosshair(!0)},r.prototype.clear=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},r.prototype.getTimeScaleStore=function(){return this._timeScaleStore},r.prototype.getIndicatorStore=function(){return this._indicatorStore},r.prototype.getOverlayStore=function(){return this._overlayStore},r.prototype.getTooltipStore=function(){return this._tooltipStore},r.prototype.getActionStore=function(){return this._actionStore},r.prototype.getChart=function(){return this._chart},r}(),q={MAIN:"main",X_AXIS:"xAxis",Y_AXIS:"yAxis",SEPARATOR:"separator"},ve=7;function Rr(r){var t={width:0,height:0,left:0,right:0,top:0,bottom:0};return k(r)&&It(t,r),t}var Lr=function(r){Z(t,r);function t(e,i){var a=r.call(this)||this;return a._bounding=Rr(),a._pane=i,a.init(e),a}return t.prototype.init=function(e){this._rootContainer=e,this._container=this.createContainer(),e.appendChild(this._container)},t.prototype.setBounding=function(e){return It(this._bounding,e),this},t.prototype.getContainer=function(){return this._container},t.prototype.getBounding=function(){return this._bounding},t.prototype.getPane=function(){return this._pane},t.prototype.update=function(e){this.updateImp(this._container,this._bounding,e!=null?e:3)},t.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},t}(Ze);function Ge(r){return window.requestAnimationFrame==null?window.setTimeout(r,20):window.requestAnimationFrame(r)}function Pe(r){window.cancelAnimationFrame==null&&window.clearTimeout(r),window.cancelAnimationFrame(r)}var re=-1,Je=function(r){Z(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._mainRequestAnimationId=re,e._overlayRequestAnimationId=re,e}return t.prototype.init=function(e){r.prototype.init.call(this,e),this._mainCanvas=Vt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=Vt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d");var i=this.getContainer();i.appendChild(this._mainCanvas),i.appendChild(this._overlayCanvas)},t.prototype.createContainer=function(){return Vt("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},t.prototype._clearCanvas=function(e,i,a,n){if(n.clearRect(0,0,a.offsetWidth,a.offsetHeight),e!==a.offsetWidth||i!==a.offsetHeight){var o=ne(a),s=Math.round(e*o),l=Math.round(i*o);a.style.width="".concat(e,"px"),a.style.height="".concat(i,"px"),a.width=s,a.height=l,n.scale(o,o)}},t.prototype._optimalUpdateMain=function(e,i){var a=this;this._mainRequestAnimationId!==re&&(Pe(this._mainRequestAnimationId),this._mainRequestAnimationId=re),this._mainRequestAnimationId=Ge(function(){a._clearCanvas(e,i,a._mainCanvas,a._mainCtx),a.updateMain(a._mainCtx)})},t.prototype._optimalUpdateOverlay=function(e,i){var a=this;this._overlayRequestAnimationId!==re&&(Pe(this._overlayRequestAnimationId),this._overlayRequestAnimationId=re),this._overlayRequestAnimationId=Ge(function(){a._clearCanvas(e,i,a._overlayCanvas,a._overlayCtx),a.updateOverlay(a._overlayCtx)})},t.prototype.updateImp=function(e,i,a){var n=i.width,o=i.height,s=i.left;e.style.left="".concat(s,"px");var l=a;switch((n!==e.offsetWidth||o!==e.offsetHeight)&&(e.style.width="".concat(n,"px"),e.style.height="".concat(o,"px"),l=3),l){case 0:{this._optimalUpdateMain(n,o);break}case 1:{this._optimalUpdateOverlay(n,o);break}case 3:case 4:{this._optimalUpdateMain(n,o),this._optimalUpdateOverlay(n,o);break}}},t.prototype.getImage=function(e){var i=this.getBounding(),a=i.width,n=i.height,o=Vt("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),l=ne(o);return o.width=a*l,o.height=n*l,s.scale(l,l),s.drawImage(this._mainCanvas,0,0,a,n),e&&s.drawImage(this._overlayCanvas,0,0,a,n),o},t}(Lr);function sn(r){return/^[rR][gG][Bb][Aa][\\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)[\s]*,){3}[\s]*(1|1.0|0|0.[0-9])[\s]*[\\)]{1}$/.test(r)}function ln(r){return/^[hH][Ss][Ll][Aa][\\(]([\s]*(2[0-9][0-9]|360｜3[0-5][0-9]|[01]?[0-9][0-9]?)[\s]*,)([\s]*((100|[0-9][0-9]?)%|0)[\s]*,){2}([\s]*(1|1.0|0|0.[0-9])[\s]*)[\\)]$/.test(r)}function oe(r){var t,e;return r==="transparent"||r==="none"||sn(r)&&parseFloat(((t=r.match(/(\d(\.\d+)?)+/g))!==null&&t!==void 0?t:[])[3])===0||ln(r)&&parseFloat(((e=r.match(/(\d(\.\d+)?)+/g))!==null&&e!==void 0?e:[])[3])===0}function un(r,t){var e=r.x-t.x,i=r.y-t.y,a=t.r;return!(e*e+i*i>a*a)}function cn(r,t,e){var i=t.x,a=t.y,n=t.r,o=e.style,s=o===void 0?J.Fill:o,l=e.color,u=l===void 0?"currentColor":l,c=e.borderSize,h=c===void 0?1:c,f=e.borderColor,v=f===void 0?"currentColor":f,d=e.borderStyle,g=d===void 0?$.Solid:d,p=e.borderDashedValue,m=p===void 0?[2,2]:p;(s===J.Fill||e.style===J.StrokeFill)&&(!j(u)||!oe(u))&&(r.fillStyle=u,r.beginPath(),r.arc(i,a,n,0,Math.PI*2),r.closePath(),r.fill()),(s===J.Stroke||e.style===J.StrokeFill)&&h>0&&!oe(v)&&(r.strokeStyle=v,r.lineWidth=h,g===$.Dashed?r.setLineDash(m):r.setLineDash([]),r.beginPath(),r.arc(i,a,n,0,Math.PI*2),r.closePath(),r.stroke())}var hn={name:"circle",checkEventOn:un,draw:function(r,t,e){cn(r,t,e)}};function vn(r,t){for(var e=!1,i=t.coordinates,a=0,n=i.length-1;a<i.length;n=a++)i[a].y>r.y!=i[n].y>r.y&&r.x<(i[n].x-i[a].x)*(r.y-i[a].y)/(i[n].y-i[a].y)+i[a].x&&(e=!e);return e}function dn(r,t,e){var i=t.coordinates,a=e.style,n=a===void 0?J.Fill:a,o=e.color,s=o===void 0?"currentColor":o,l=e.borderSize,u=l===void 0?1:l,c=e.borderColor,h=c===void 0?"currentColor":c,f=e.borderStyle,v=f===void 0?$.Solid:f,d=e.borderDashedValue,g=d===void 0?[2,2]:d;if((n===J.Fill||e.style===J.StrokeFill)&&(!j(s)||!oe(s))){r.fillStyle=s,r.beginPath(),r.moveTo(i[0].x,i[0].y);for(var p=1;p<i.length;p++)r.lineTo(i[p].x,i[p].y);r.closePath(),r.fill()}if((n===J.Stroke||e.style===J.StrokeFill)&&u>0&&!oe(h)){r.strokeStyle=h,r.lineWidth=u,v===$.Dashed?r.setLineDash(g):r.setLineDash([]),r.beginPath(),r.moveTo(i[0].x,i[0].y);for(var p=1;p<i.length;p++)r.lineTo(i[p].x,i[p].y);r.closePath(),r.stroke()}}var fn={name:"polygon",checkEventOn:vn,draw:function(r,t,e){dn(r,t,e)}};function pn(r,t){var e=t.x,i=t.width;i<st*2&&(e-=st,i=st*2);var a=t.y,n=t.height;return n<st*2&&(a-=st,n=st*2),r.x>=e&&r.x<=e+i&&r.y>=a&&r.y<=a+n}function Br(r,t,e){var i=t.x,a=t.y,n=t.width,o=t.height,s=e.style,l=s===void 0?J.Fill:s,u=e.color,c=u===void 0?"transparent":u,h=e.borderSize,f=h===void 0?1:h,v=e.borderColor,d=v===void 0?"transparent":v,g=e.borderStyle,p=g===void 0?$.Solid:g,m=e.borderRadius,_=m===void 0?0:m,y=e.borderDashedValue,x=y===void 0?[2,2]:y;(l===J.Fill||e.style===J.StrokeFill)&&(!j(c)||!oe(c))&&(r.fillStyle=c,r.beginPath(),r.moveTo(i+_,a),r.arcTo(i+n,a,i+n,a+o,_),r.arcTo(i+n,a+o,i,a+o,_),r.arcTo(i,a+o,i,a,_),r.arcTo(i,a,i+n,a,_),r.closePath(),r.fill()),(l===J.Stroke||e.style===J.StrokeFill)&&f>0&&!oe(d)&&(r.strokeStyle=d,r.lineWidth=f,p===$.Dashed?r.setLineDash(x):r.setLineDash([]),r.beginPath(),r.moveTo(i+_,a),r.arcTo(i+n,a,i+n,a+o,_),r.arcTo(i+n,a+o,i,a+o,_),r.arcTo(i,a+o,i,a,_),r.arcTo(i,a,i+n,a,_),r.closePath(),r.stroke())}var gn={name:"rect",checkEventOn:pn,draw:function(r,t,e){Br(r,t,e)}};function Vr(r,t){var e=t.size,i=e===void 0?12:e,a=t.paddingLeft,n=a===void 0?0:a,o=t.paddingTop,s=o===void 0?0:o,l=t.paddingRight,u=l===void 0?0:l,c=t.paddingBottom,h=c===void 0?0:c,f=t.weight,v=f===void 0?"normal":f,d=t.family,g=r.x,p=r.y,m=r.text,_=r.align,y=_===void 0?"left":_,x=r.baseline,b=x===void 0?"top":x,I=r.width,C=r.height,E=I!=null?I:n+Ee(m,i,v,d)+u,A=C!=null?C:s+i+h,F;switch(y){case"left":case"start":{F=g;break}case"right":case"end":{F=g-E;break}default:{F=g-E/2;break}}var P;switch(b){case"top":case"hanging":{P=p;break}case"bottom":case"ideographic":case"alphabetic":{P=p-A;break}default:{P=p-A/2;break}}return{x:F,y:P,width:E,height:A}}function mn(r,t,e){var i=Vr(t,e),a=i.x,n=i.y,o=i.width,s=i.height;return r.x>=a&&r.x<=a+o&&r.y>=n&&r.y<=n+s}function _n(r,t,e){var i=t.text,a=e.color,n=a===void 0?"currentColor":a,o=e.size,s=o===void 0?12:o,l=e.family,u=e.weight,c=e.paddingLeft,h=c===void 0?0:c,f=e.paddingTop,v=f===void 0?0:f,d=e.paddingRight,g=d===void 0?0:d,p=Vr(t,e);Br(r,p,V(V({},e),{color:e.backgroundColor})),r.textAlign="left",r.textBaseline="top",r.font=te(s,u,l),r.fillStyle=n,r.fillText(i,p.x+h,p.y+v,p.width-h-g)}var Nr={name:"text",checkEventOn:function(r,t,e){return mn(r,t,e)},draw:function(r,t,e){_n(r,t,e)}},yn=Nr;function xn(r,t){var e=r.x-t.x,i=r.y-t.y;return Math.sqrt(e*e+i*i)}function Sn(r,t){if(Math.abs(xn(r,t)-t.r)<st){var e=t.r,i=t.startAngle,a=t.endAngle,n=e*Math.cos(i)+t.x,o=e*Math.sin(i)+t.y,s=e*Math.cos(a)+t.x,l=e*Math.sin(a)+t.y;return r.x<=Math.max(n,s)+st&&r.x>=Math.min(n,s)-st&&r.y<=Math.max(o,l)+st&&r.y>=Math.min(o,l)-st}return!1}function bn(r,t,e){var i=t.x,a=t.y,n=t.r,o=t.startAngle,s=t.endAngle,l=e.style,u=l===void 0?$.Solid:l,c=e.size,h=c===void 0?1:c,f=e.color,v=f===void 0?"currentColor":f,d=e.dashedValue,g=d===void 0?[2,2]:d;r.lineWidth=h,r.strokeStyle=v,u===$.Dashed?r.setLineDash(g):r.setLineDash([]),r.beginPath(),r.arc(i,a,n,o,s),r.stroke(),r.closePath()}var Cn={name:"arc",checkEventOn:Sn,draw:function(r,t,e){bn(r,t,e)}},Or={},wn=[hn,Va,fn,gn,Nr,yn,Cn];wn.forEach(function(r){Or[r.name]=Fa.extend(r)});function In(r){var t;return(t=Or[r])!==null&&t!==void 0?t:null}var Ot=function(r){Z(t,r);function t(e){var i=r.call(this)||this;return i._widget=e,i}return t.prototype.getWidget=function(){return this._widget},t.prototype.createFigure=function(e,i,a,n){var o=In(e);if(o!==null){var s=new o({name:e,attrs:i,styles:a});if(k(n)){for(var l in n)n.hasOwnProperty(l)&&s.registerEvent(l,n[l]);this.addChild(s)}return s}return null},t.prototype.draw=function(e){this.clear(),this.drawImp(e)},t}(Ze),En=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this,a=this.getWidget(),n=this.getWidget().getPane(),o=n.getChart(),s=a.getBounding(),l=o.getStyles().grid,u=l.show;if(u){e.save(),e.globalCompositeOperation="destination-over";var c=l.horizontal,h=c.show;if(h){var f=n.getAxisComponent();f.getTicks().forEach(function(p){var m;(m=i.createFigure("line",{coordinates:[{x:0,y:p.coord},{x:s.width,y:p.coord}]},c))===null||m===void 0||m.draw(e)})}var v=l.vertical,d=v.show;if(d){var g=o.getXAxisPane().getAxisComponent();g.getTicks().forEach(function(p){var m;(m=i.createFigure("line",{coordinates:[{x:p.coord,y:0},{x:p.coord,y:s.height}]},v))===null||m===void 0||m.draw(e)})}e.restore()}},t}(Ot);function Mn(r,t){var e=0;return function(){var i=Date.now();i-e>(t!=null?t:20)&&(r.apply(this,arguments),e=i)}}function Qe(r,t){if(!Nt(r)||k(t)&&!Nt(t))throw new TypeError("Expected a function");var e=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var n=Nt(t)?t.apply(this,i):i[0],o=e.cache;if(o.has(n))return o.get(n);var s=r.apply(this,i);return e.cache=o.set(n,s)||o,s};return e.cache=new(Qe.Cache||Map),e}Qe.Cache=Map;var $e=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.eachChildren=function(e){var i=this.getWidget().getPane(),a=i.getChart().getChartStore(),n=a.getVisibleDataList(),o=a.getTimeScaleStore().getBarSpace();n.forEach(function(s,l){e(s,o,l)})},t}(Ot),Wr=function(r){Z(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._boundCandleBarClickEvent=function(i){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(Tt.OnCandleBarClick,i),!1}},e._calcOhlcSize=Qe(function(i){return Math.min(Math.max(Math.round(i*.1),1),3)}),e}return t.prototype.drawImp=function(e){var i=this,a=this.getWidget().getPane(),n=a.getId()===Q.CANDLE,o=a.getChart().getChartStore(),s=this.getCandleBarOptions(o);if(s!==null){var l=a.getAxisComponent();this.eachChildren(function(u,c){i._drawCandleBar(e,l,u,c,s,n)})}},t.prototype.getCandleBarOptions=function(e){var i=e.getStyles().candle;return{type:i.type,styles:i.bar}},t.prototype._drawCandleBar=function(e,i,a,n,o,s){var l=this,u=a.data,c=a.x,h=u.open,f=u.high,v=u.low,d=u.close,g=n.halfGapBar,p=n.gapBar,m=o.type,_=o.styles,y,x,b;d>h?(y=_.upColor,x=_.upBorderColor,b=_.upWickColor):d<h?(y=_.downColor,x=_.downBorderColor,b=_.downWickColor):(y=_.noChangeColor,x=_.noChangeBorderColor,b=_.noChangeWickColor);var I=i.convertToPixel(h),C=i.convertToPixel(d),E=[I,C,i.convertToPixel(f),i.convertToPixel(v)];E.sort(function(L,T){return L-T});var A=Math.max(1,E[2]-E[1]),F=[];if(m!==Rt.Ohlc)F.push({name:"rect",attrs:{x:c-.5,y:E[0],width:1,height:E[1]-E[0]},styles:{color:b}}),m===Rt.CandleStroke||m===Rt.CandleUpStroke&&h<d||m===Rt.CandleDownStroke&&h>d?F.push({name:"rect",attrs:{x:c-g+.5,y:E[1],width:p-1,height:A},styles:{style:J.Stroke,borderColor:x}}):F.push({name:"rect",attrs:{x:c-g+.5,y:E[1],width:p-1,height:A},styles:{style:J.StrokeFill,color:y,borderColor:x}}),F.push({name:"rect",attrs:{x:c-.5,y:E[2],width:1,height:E[3]-E[2]},styles:{color:b}});else{var P=this._calcOhlcSize(n.gapBar);F=[{name:"rect",attrs:{x:c-P/2,y:E[0],width:P,height:E[3]-E[0]},styles:{color:y}},{name:"rect",attrs:{x:c-g,y:I+P>E[3]?E[3]-P:I,width:g-P/2,height:P},styles:{color:y}},{name:"rect",attrs:{x:c+P/2,y:C+P>E[3]?E[3]-P:C,width:g-P/2,height:P},styles:{color:y}}]}F.forEach(function(L){var T,N=L.attrs,U=L.styles,Y;s&&(Y={mouseClickEvent:l._boundCandleBarClickEvent(a)}),(T=l.createFigure("rect",N,U,Y))===null||T===void 0||T.draw(e)})},t}($e),Pn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getCandleBarOptions=function(e){var i,a,n=this.getWidget().getPane(),o=n.getAxisComponent();if(!o.isInCandle()){var s=e.getIndicatorStore().getInstances(n.getId());try{for(var l=$t(s),u=l.next();!u.done;u=l.next()){var c=u.value;if(c.shouldOhlc&&c.visible){var h=c.styles,f=e.getStyles().indicator,v=rt(h,"ohlc.upColor",f.ohlc.upColor),d=rt(h,"ohlc.downColor",f.ohlc.downColor),g=rt(h,"ohlc.noChangeColor",f.ohlc.noChangeColor);return{type:Rt.Ohlc,styles:{upColor:v,downColor:d,noChangeColor:g,upBorderColor:v,downBorderColor:d,noChangeBorderColor:g,upWickColor:v,downWickColor:d,noChangeWickColor:g}}}}}catch(p){i={error:p}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}}return null},t.prototype.drawImp=function(e){var i=this;r.prototype.drawImp.call(this,e);var a=this.getWidget(),n=a.getPane(),o=n.getChart(),s=a.getBounding(),l=o.getXAxisPane().getAxisComponent(),u=n.getAxisComponent(),c=o.getChartStore(),h=c.getDataList(),f=c.getTimeScaleStore(),v=f.getVisibleRange(),d=c.getIndicatorStore().getInstances(n.getId()),g=c.getStyles().indicator;e.save(),d.forEach(function(p){var m;if(p.visible){p.zLevel<0?e.globalCompositeOperation="destination-over":e.globalCompositeOperation="source-over";var _=!1;if(p.draw!==null&&(e.save(),_=(m=p.draw({ctx:e,kLineDataList:h,indicator:p,visibleRange:v,bounding:s,barSpace:f.getBarSpace(),defaultStyles:g,xAxis:l,yAxis:u}))!==null&&m!==void 0?m:!1,e.restore()),!_){var y=p.result;i.eachChildren(function(x,b){var I,C,E,A=b.halfGapBar,F=b.gapBar,P=x.dataIndex,L=x.x,T=l.convertToPixel(P-1),N=l.convertToPixel(P+1),U=(I=y[P-1])!==null&&I!==void 0?I:{},Y=(C=y[P])!==null&&C!==void 0?C:{},ft=(E=y[P+1])!==null&&E!==void 0?E:{},tt={x:T},R={x:L},z={x:N};p.figures.forEach(function(G){var M=G.key;tt[M]=u.convertToPixel(U[M]),R[M]=u.convertToPixel(Y[M]),z[M]=u.convertToPixel(ft[M])}),qe(h,p,P,g,function(G,M){var K,B,et;if(k(Y[G.key])){var it=R[G.key],H=(K=G.attrs)===null||K===void 0?void 0:K.call(G,{coordinate:{prev:tt,current:R,next:z},bounding:s,barSpace:b,xAxis:l,yAxis:u});if(!k(H))switch(G.type){case"circle":{H={x:L,y:it,r:A};break}case"rect":case"bar":{var lt=(B=G.baseValue)!==null&&B!==void 0?B:u.getExtremum().min,mt=u.convertToPixel(lt),xt=Math.abs(mt-it);lt!==Y[G.key]&&(xt=Math.max(1,xt));var nt=void 0;it>mt?nt=mt:nt=it,H={x:L-A,y:nt,width:F,height:xt};break}case"line":{X(R[G.key])&&X(z[G.key])&&(H={coordinates:[{x:R.x,y:R[G.key]},{x:z.x,y:z[G.key]}]});break}}if(k(H)){var _t=G.type;(et=i.createFigure(_t==="bar"?"rect":_t,H,M))===null||et===void 0||et.draw(e)}}})})}}}),e.restore()},t}(Wr),Tn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this.getWidget(),a=i.getPane(),n=i.getBounding(),o=i.getPane().getChart().getChartStore(),s=o.getTooltipStore().getCrosshair(),l=o.getStyles().crosshair;if(j(s.paneId)&&l.show){if(s.paneId===a.getId()){var u=s.y;this._drawLine(e,[{x:0,y:u},{x:n.width,y:u}],l.horizontal)}var c=s.realX;this._drawLine(e,[{x:c,y:0},{x:c,y:n.height}],l.vertical)}},t.prototype._drawLine=function(e,i,a){var n;if(a.show){var o=a.line;o.show&&((n=this.createFigure("line",{coordinates:i},o))===null||n===void 0||n.draw(e))}},t}(Ot),zr=function(r){Z(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._boundIconClickEvent=function(i,a){return function(){var n=e.getWidget().getPane();return n.getChart().getChartStore().getActionStore().execute(Tt.OnTooltipIconClick,V(V({},i),{iconId:a})),!0}},e._boundIconMouseMoveEvent=function(i,a){return function(){var n=e.getWidget().getPane(),o=n.getChart().getChartStore().getTooltipStore();return o.setActiveIcon(V(V({},i),{iconId:a})),!0}},e}return t.prototype.drawImp=function(e){var i=this.getWidget(),a=i.getPane(),n=a.getChart().getChartStore(),o=n.getTooltipStore().getCrosshair();if(k(o.kLineData)){var s=i.getBounding(),l=n.getCustomApi(),u=n.getThousandsSeparator(),c=n.getIndicatorStore().getInstances(a.getId()),h=n.getTooltipStore().getActiveIcon(),f=n.getStyles().indicator;this.drawIndicatorTooltip(e,a.getId(),n.getDataList(),o,h,c,l,u,s,f)}},t.prototype.drawIndicatorTooltip=function(e,i,a,n,o,s,l,u,c,h,f){var v=this,d=h.tooltip,g=0;if(this.isDrawTooltip(n,d)){var p=d.text,m=0,_=f!=null?f:0,y=0;s.forEach(function(x){var b=v.getIndicatorTooltipData(a,n,x,l,u,h),I=b.name,C=b.calcParamsText,E=b.values,A=b.icons,F=I.length>0,P=E.length>0;if(F||P){var L=dt(v.classifyTooltipIcons(A),3),T=L[0],N=L[1],U=L[2],Y=dt(v.drawStandardTooltipIcons(e,c,{paneId:i,indicatorName:x.name,iconId:""},o,T,m,_,y),4),ft=Y[0],tt=Y[1],R=Y[2],z=Y[3];if(m=ft,_=tt,g+=z,y=R,F){var G=I;C.length>0&&(G="".concat(G).concat(C));var M=dt(v.drawStandardTooltipLabels(e,c,[{title:{text:"",color:p.color},value:{text:G,color:p.color}}],m,_,y,p),4),K=M[0],B=M[1],et=M[2],it=M[3];m=K,_=B,g+=it,y=et}var H=dt(v.drawStandardTooltipIcons(e,c,{paneId:i,indicatorName:x.name,iconId:""},o,N,m,_,y),4),lt=H[0],mt=H[1],xt=H[2],nt=H[3];if(m=lt,_=mt,g+=nt,y=xt,P){var _t=dt(v.drawStandardTooltipLabels(e,c,E,m,_,y,p),4),Gt=_t[0],Ae=_t[1],Ut=_t[2],Dt=_t[3];m=Gt,_=Ae,g+=Dt,y=Ut}var St=dt(v.drawStandardTooltipIcons(e,c,{paneId:i,indicatorName:x.name,iconId:""},o,U,m,_,y),4),Wt=St[1],pe=St[2],ge=St[3];m=0,g+=ge,_=Wt+pe,y=0}})}return g},t.prototype.drawStandardTooltipIcons=function(e,i,a,n,o,s,l,u){var c=this,h=s,f=l,v=0,d=0,g=0;return o.length>0&&(o.forEach(function(p){var m=p.marginLeft,_=p.marginTop,y=p.marginRight,x=p.marginBottom,b=p.paddingLeft,I=p.paddingTop,C=p.paddingRight,E=p.paddingBottom,A=p.size,F=p.fontFamily,P=p.icon;e.font=te(A,"normal",F),v+=m+b+e.measureText(P).width+C+y,d=Math.max(d,_+I+A+E+x)}),h+v>i.width?(h=o[0].marginLeft,f+=u,g=d):g=Math.max(0,d-u),o.forEach(function(p){var m,_=p.marginLeft,y=p.marginTop,x=p.marginRight,b=p.paddingLeft,I=p.paddingTop,C=p.paddingRight,E=p.paddingBottom,A=p.color,F=p.activeColor,P=p.size,L=p.fontFamily,T=p.icon,N=p.backgroundColor,U=p.activeBackgroundColor;h+=_;var Y=(n==null?void 0:n.paneId)===a.paneId&&(n==null?void 0:n.indicatorName)===a.indicatorName&&(n==null?void 0:n.iconId)===p.id;(m=c.createFigure("text",{text:T,x:h,y:f+y},{paddingLeft:b,paddingTop:I,paddingRight:C,paddingBottom:E,color:Y?F:A,size:P,family:L,backgroundColor:Y?U:N},{mouseClickEvent:c._boundIconClickEvent(a,p.id),mouseMoveEvent:c._boundIconMouseMoveEvent(a,p.id)}))===null||m===void 0||m.draw(e),h+=b+e.measureText(T).width+C+x})),[h,f,Math.max(u,d),g]},t.prototype.drawStandardTooltipLabels=function(e,i,a,n,o,s,l){var u=this,c=n,h=o,f=0,v=0,d=s;if(a.length>0){var g=l.marginLeft,p=l.marginTop,m=l.marginRight,_=l.marginBottom,y=l.size,x=l.family,b=l.weight;e.font=te(y,b,x),a.forEach(function(I){var C,E,A=I.title,F=I.value,P=e.measureText(A.text).width,L=e.measureText(F.text).width,T=P+L,N=y+p+_;c+g+T+m>i.width?(c=g,h+=N,v+=N):(c+=g,v+=Math.max(0,N-d)),f=Math.max(d,N),d=f,A.text.length>0&&((C=u.createFigure("text",{x:c,y:h+p,text:A.text},{color:A.color,size:y,family:x,weight:b}))===null||C===void 0||C.draw(e),c+=P),(E=u.createFigure("text",{x:c,y:h+p,text:F.text},{color:F.color,size:y,family:x,weight:b}))===null||E===void 0||E.draw(e),c+=L+m})}return[c,h,f,v]},t.prototype.isDrawTooltip=function(e,i){var a=i.showRule;return a===ae.Always||a===ae.FollowCross&&j(e.paneId)},t.prototype.getIndicatorTooltipData=function(e,i,a,n,o,s){var l,u,c=s.tooltip,h=c.showName?a.shortName:"",f="",v=a.calcParams;v.length>0&&c.showParams&&(f="(".concat(v.join(","),")"));var d={name:h,calcParamsText:f,values:[],icons:c.icons},g=i.dataIndex,p=(l=a.result)!==null&&l!==void 0?l:[],m=[];if(a.visible){var _=(u=p[g])!==null&&u!==void 0?u:{};qe(e,a,g,s,function(T,N){if(j(T.title)){var U=N.color,Y=_[T.key];k(Y)&&(Y=at(Y,a.precision),a.shouldFormatBigNumber&&(Y=n.formatBigNumber(Y))),m.push({title:{text:T.title,color:U},value:{text:ht(Y!=null?Y:c.defaultValue,o),color:U}})}}),d.values=m}if(a.createTooltipDataSource!==null){var y=this.getWidget(),x=y.getPane(),b=x.getChart().getChartStore(),I=a.createTooltipDataSource({kLineDataList:e,indicator:a,visibleRange:b.getTimeScaleStore().getVisibleRange(),bounding:y.getBounding(),crosshair:i,defaultStyles:s,xAxis:x.getChart().getXAxisPane().getAxisComponent(),yAxis:x.getAxisComponent()}),C=I.name,E=I.calcParamsText,A=I.values,F=I.icons;if(j(C)&&c.showName&&(d.name=C),j(E)&&c.showParams&&(d.calcParamsText=E),k(F)&&(d.icons=F),k(A)&&a.visible){var P=[],L=s.tooltip.text.color;A.forEach(function(T){var N={text:"",color:L};Bt(T.title)?N=T.title:N.text=T.title;var U={text:"",color:L};Bt(T.value)?U=T.value:U.text=T.value,U.text=ht(U.text,o),P.push({title:N,value:U})}),d.values=P}}return d},t.prototype.classifyTooltipIcons=function(e){var i=[],a=[],n=[];return e.forEach(function(o){switch(o.position){case he.Left:{i.push(o);break}case he.Middle:{a.push(o);break}case he.Right:{n.push(o);break}}}),[i,a,n]},t}(Ot),Xr=function(r){Z(t,r);function t(e){var i=r.call(this,e)||this;return i._initEvent(),i}return t.prototype._initEvent=function(){var e=this,i=this.getWidget().getPane(),a=i.getId(),n=i.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(o){var s,l=n.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;u.isStart()&&(n.updateProgressInstanceInfo(a),c=a);var h=u.points.length-1,f="".concat(ee,"point_").concat(h);return u.isDrawing()&&c===a&&(u.eventMoveForDrawing(e._coordinateToPoint(l.instance,o)),(s=u.onDrawing)===null||s===void 0||s.call(u,V({overlay:u,figureKey:f,figureIndex:h},o))),e._figureMouseMoveEvent(u,1,f,h,0)(o)}return n.setHoverInstanceInfo({paneId:a,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},o),!1}).registerEvent("mouseClickEvent",function(o){var s,l,u=n.getProgressInstanceInfo();if(u!==null){var c=u.instance,h=u.paneId;c.isStart()&&(n.updateProgressInstanceInfo(a,!0),h=a);var f=c.points.length-1,v="".concat(ee,"point_").concat(f);return c.isDrawing()&&h===a&&(c.eventMoveForDrawing(e._coordinateToPoint(c,o)),(s=c.onDrawing)===null||s===void 0||s.call(c,V({overlay:c,figureKey:v,figureIndex:f},o)),c.nextStep(),c.isDrawing()||(n.progressInstanceComplete(),(l=c.onDrawEnd)===null||l===void 0||l.call(c,V({overlay:c,figureKey:v,figureIndex:f},o)))),e._figureMouseClickEvent(c,1,v,f,0)(o)}return n.setClickInstanceInfo({paneId:a,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},o),!1}).registerEvent("mouseDoubleClickEvent",function(o){var s,l=n.getProgressInstanceInfo();if(l!==null){var u=l.instance,c=l.paneId;if(u.isDrawing()&&c===a&&(u.forceComplete(),!u.isDrawing())){n.progressInstanceComplete();var h=u.points.length-1,f="".concat(ee,"point_").concat(h);(s=u.onDrawEnd)===null||s===void 0||s.call(u,V({overlay:u,figureKey:f,figureIndex:h},o))}var v=u.points.length-1;return e._figureMouseClickEvent(u,1,"".concat(ee,"point_").concat(v),v,0)(o)}return!1}).registerEvent("mouseRightClickEvent",function(o){var s=n.getProgressInstanceInfo();if(s!==null){var l=s.instance;if(l.isDrawing()){var u=l.points.length-1;return e._figureMouseRightClickEvent(l,1,"".concat(ee,"point_").concat(u),u,0)(o)}}return!1}).registerEvent("mouseUpEvent",function(o){var s,l=n.getPressedInstanceInfo(),u=l.instance,c=l.figureIndex,h=l.figureKey;return u!==null&&((s=u.onPressedMoveEnd)===null||s===void 0||s.call(u,V({overlay:u,figureKey:h,figureIndex:c},o))),n.setPressedInstanceInfo({paneId:a,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(o){var s,l,u=n.getPressedInstanceInfo(),c=u.instance,h=u.figureType,f=u.figureIndex,v=u.figureKey;if(c!==null){if(!c.lock&&!((l=(s=c.onPressedMoving)===null||s===void 0?void 0:s.call(c,V({overlay:c,figureIndex:f,figureKey:v},o)))!==null&&l!==void 0&&l)){var d=e._coordinateToPoint(c,o);h===1?c.eventPressedPointMove(d,f):c.eventPressedOtherMove(d,e.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},t.prototype._createFigureEvents=function(e,i,a,n,o,s){var l;if(!e.isDrawing()){var u=[];if(k(s)&&(Qt(s)?s&&(u=zi()):u=s),u.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(e,i,a,n,o),mouseDownEvent:this._figureMouseDownEvent(e,i,a,n,o),mouseClickEvent:this._figureMouseClickEvent(e,i,a,n,o),mouseRightClickEvent:this._figureMouseRightClickEvent(e,i,a,n,o),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,i,a,n,o)};l={},!u.includes("mouseMoveEvent")&&!u.includes("touchMoveEvent")&&(l.mouseMoveEvent=this._figureMouseMoveEvent(e,i,a,n,o)),!u.includes("mouseDownEvent")&&!u.includes("touchStartEvent")&&(l.mouseDownEvent=this._figureMouseDownEvent(e,i,a,n,o)),!u.includes("mouseClickEvent")&&!u.includes("tapEvent")&&(l.mouseClickEvent=this._figureMouseClickEvent(e,i,a,n,o)),!u.includes("mouseDoubleClickEvent")&&!u.includes("doubleTapEvent")&&(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(e,i,a,n,o)),u.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(e,i,a,n,o))}return l},t.prototype._figureMouseMoveEvent=function(e,i,a,n,o){var s=this;return function(l){var u=s.getWidget().getPane(),c=u.getChart().getChartStore().getOverlayStore();return c.setHoverInstanceInfo({paneId:u.getId(),instance:e,figureType:i,figureKey:a,figureIndex:n,attrsIndex:o},l),!0}},t.prototype._figureMouseDownEvent=function(e,i,a,n,o){var s=this;return function(l){var u,c=s.getWidget().getPane(),h=c.getId(),f=c.getChart().getChartStore().getOverlayStore();return e.startPressedMove(s._coordinateToPoint(e,l)),(u=e.onPressedMoveStart)===null||u===void 0||u.call(e,V({overlay:e,figureIndex:n,figureKey:a},l)),f.setPressedInstanceInfo({paneId:h,instance:e,figureType:i,figureKey:a,figureIndex:n,attrsIndex:o}),!0}},t.prototype._figureMouseClickEvent=function(e,i,a,n,o){var s=this;return function(l){var u=s.getWidget().getPane(),c=u.getId(),h=u.getChart().getChartStore().getOverlayStore();return h.setClickInstanceInfo({paneId:c,instance:e,figureType:i,figureKey:a,figureIndex:n,attrsIndex:o},l),!0}},t.prototype._figureMouseDoubleClickEvent=function(e,i,a,n,o){return function(s){var l;return(l=e.onDoubleClick)===null||l===void 0||l.call(e,V(V({},s),{figureIndex:n,figureKey:a,overlay:e})),!0}},t.prototype._figureMouseRightClickEvent=function(e,i,a,n,o){var s=this;return function(l){var u,c;if(!((c=(u=e.onRightClick)===null||u===void 0?void 0:u.call(e,V({overlay:e,figureIndex:n,figureKey:a},l)))!==null&&c!==void 0&&c)){var h=s.getWidget().getPane(),f=h.getChart().getChartStore().getOverlayStore();f.removeInstance(e)}return!0}},t.prototype._coordinateToPoint=function(e,i){var a,n={},o=this.getWidget().getPane(),s=o.getChart(),l=o.getId(),u=s.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var c=s.getXAxisPane().getAxisComponent(),h=c.convertFromPixel(i.x),f=(a=u.dataIndexToTimestamp(h))!==null&&a!==void 0?a:void 0;n.dataIndex=h,n.timestamp=f}if(this.coordinateToPointValueFlag()){var v=o.getAxisComponent(),d=v.convertFromPixel(i.y);if(e.mode!==ie.Normal&&l===Q.CANDLE&&X(n.dataIndex)){var g=u.getDataByDataIndex(n.dataIndex);if(g!==null){var p=e.modeSensitivity;if(d>g.high)if(e.mode===ie.WeakMagnet){var m=v.convertToPixel(g.high),_=v.convertFromPixel(m-p);d<_&&(d=g.high)}else d=g.high;else if(d<g.low)if(e.mode===ie.WeakMagnet){var y=v.convertToPixel(g.low),_=v.convertFromPixel(y-p);d>_&&(d=g.low)}else d=g.low;else{var x=Math.max(g.open,g.close),b=Math.min(g.open,g.close);d>x?d-x<g.high-d?d=x:d=g.high:d<b?d-g.low<b-d?d=g.low:d=b:x-d<d-b?d=x:d=b}}}n.value=d}return n},t.prototype.coordinateToPointValueFlag=function(){return!0},t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.dispatchEvent=function(e,i,a){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(e,i,a):r.prototype.dispatchEvent.call(this,e,i,a)},t.prototype.checkEventOn=function(){return!0},t.prototype.drawImp=function(e){var i=this,a=this.getWidget(),n=a.getPane(),o=n.getId(),s=n.getChart(),l=n.getAxisComponent(),u=s.getXAxisPane().getAxisComponent(),c=a.getBounding(),h=s.getChartStore(),f=h.getCustomApi(),v=h.getThousandsSeparator(),d=h.getTimeScaleStore(),g=d.getDateTimeFormat(),p=d.getBarSpace(),m=h.getPrecision(),_=h.getStyles().overlay,y=h.getOverlayStore(),x=y.getHoverInstanceInfo(),b=y.getClickInstanceInfo(),I=this.getCompleteOverlays(y,o);I.forEach(function(A){A.visible&&i._drawOverlay(e,A,c,p,m,g,f,v,_,u,l,x,b,d)});var C=y.getProgressInstanceInfo();if(C!==null){var E=this.getProgressOverlay(C,o);E!==null&&E.visible&&this._drawOverlay(e,E,c,p,m,g,f,v,_,u,l,x,b,d)}},t.prototype._drawOverlay=function(e,i,a,n,o,s,l,u,c,h,f,v,d,g){var p=i.points,m=p.map(function(y){var x,b,I=y.dataIndex;X(y.timestamp)&&(I=g.timestampToDataIndex(y.timestamp));var C={x:0,y:0};return X(I)&&(C.x=(x=h==null?void 0:h.convertToPixel(I))!==null&&x!==void 0?x:0),X(y.value)&&(C.y=(b=f==null?void 0:f.convertToPixel(y.value))!==null&&b!==void 0?b:0),C});if(m.length>0){var _=new Array().concat(this.getFigures(i,m,a,n,o,u,s,c,h,f));this.drawFigures(e,i,_,c)}this.drawDefaultFigures(e,i,m,a,o,s,l,u,c,h,f,v,d)},t.prototype.drawFigures=function(e,i,a,n){var o=this;a.forEach(function(s,l){var u=s.type,c=s.styles,h=s.attrs,f=s.ignoreEvent,v=[].concat(h);v.forEach(function(d,g){var p,m,_,y=o._createFigureEvents(i,2,(p=s.key)!==null&&p!==void 0?p:"",l,g,f),x=V(V(V({},n[u]),(m=i.styles)===null||m===void 0?void 0:m[u]),c);(_=o.createFigure(u,d,x,y))===null||_===void 0||_.draw(e)})})},t.prototype.getCompleteOverlays=function(e,i){return e.getInstances(i)},t.prototype.getProgressOverlay=function(e,i){return e.paneId===i?e.instance:null},t.prototype.getFigures=function(e,i,a,n,o,s,l,u,c,h){var f,v;return(v=(f=e.createPointFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:i,bounding:a,barSpace:n,precision:o,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:u,xAxis:c,yAxis:h}))!==null&&v!==void 0?v:[]},t.prototype.drawDefaultFigures=function(e,i,a,n,o,s,l,u,c,h,f,v,d){var g=this,p,m;if(i.needDefaultPointFigure&&(((p=v.instance)===null||p===void 0?void 0:p.id)===i.id&&v.figureType!==0||((m=d.instance)===null||m===void 0?void 0:m.id)===i.id&&d.figureType!==0)){var _=i.styles,y=V(V({},c.point),_==null?void 0:_.point);a.forEach(function(x,b){var I,C,E,A=x.x,F=x.y,P=y.radius,L=y.color,T=y.borderColor,N=y.borderSize;((I=v.instance)===null||I===void 0?void 0:I.id)===i.id&&v.figureType===1&&v.figureIndex===b&&(P=y.activeRadius,L=y.activeColor,T=y.activeBorderColor,N=y.activeBorderSize),(C=g.createFigure("circle",{x:A,y:F,r:P+N},{color:T},g._createFigureEvents(i,1,"".concat(ee,"point_").concat(b),b,0)))===null||C===void 0||C.draw(e),(E=g.createFigure("circle",{x:A,y:F,r:P},{color:L}))===null||E===void 0||E.draw(e)})}},t}(Ot),Yr=function(r){Z(t,r);function t(e,i){var a=r.call(this,e,i)||this;return a._gridView=new En(a),a._indicatorView=new Pn(a),a._crosshairLineView=new Tn(a),a._tooltipView=a.createTooltipView(),a._overlayView=new Xr(a),a.addChild(a._tooltipView),a.addChild(a._overlayView),a.getContainer().style.cursor="crosshair",a.registerEvent("mouseMoveEvent",function(){return i.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),a}return t.prototype.getName=function(){return q.MAIN},t.prototype.updateMain=function(e){this.updateMainContent(e),this._indicatorView.draw(e),this._gridView.draw(e)},t.prototype.createTooltipView=function(){return new zr(this)},t.prototype.updateMainContent=function(e){},t.prototype.updateOverlay=function(e){this._overlayView.draw(e),this._crosshairLineView.draw(e),this._tooltipView.draw(e)},t}(Je),Dn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,a,n=this.getWidget(),o=n.getPane(),s=o.getChart(),l=n.getBounding(),u=o.getAxisComponent(),c=s.getStyles().candle.area,h=[],f=[],v=Number.MAX_SAFE_INTEGER;this.eachChildren(function(x,b,I){var C=x.data,E=x.x,A=b.halfGapBar,F=C[c.value];if(X(F)){var P=u.convertToPixel(F);if(I===0){var L=E-A;f.push({x:L,y:l.height}),f.push({x:L,y:P}),h.push({x:L,y:P})}h.push({x:E,y:P}),f.push({x:E,y:P}),v=Math.min(v,P)}});var d=f.length;if(d>0){var g=f[d-1],p=g.x;h.push({x:p,y:g.y}),f.push({x:p,y:g.y}),f.push({x:p,y:l.height})}if(h.length>0&&((i=this.createFigure("line",{coordinates:h},{color:c.lineColor,size:c.lineSize}))===null||i===void 0||i.draw(e)),f.length>0){var m=c.backgroundColor,_=void 0;if(Lt(m)){var y=e.createLinearGradient(0,l.height,0,v);try{m.forEach(function(x){var b=x.offset,I=x.color;y.addColorStop(b,I)})}catch(x){}_=y}else _=m;(a=this.createFigure("polygon",{coordinates:f},{color:_}))===null||a===void 0||a.draw(e)}},t}($e),An=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this.getWidget(),a=i.getPane(),n=a.getChart().getChartStore(),o=n.getStyles().candle.priceMark,s=o.high,l=o.low;if(o.show&&(s.show||l.show)){var u=n.getThousandsSeparator(),c=n.getPrecision(),h=a.getAxisComponent(),f=Number.MIN_SAFE_INTEGER,v=0,d=Number.MAX_SAFE_INTEGER,g=0;this.eachChildren(function(_){var y=_.data,x=_.x;f<y.high&&(f=y.high,v=x),d>y.low&&(d=y.low,g=x)});var p=h.convertToPixel(f),m=h.convertToPixel(d);s.show&&f!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,ht(at(f,c.price),u),{x:v,y:p},p<m?[-2,-5]:[2,5],s),l.show&&d!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,ht(at(d,c.price),u),{x:g,y:m},p<m?[2,5]:[-2,-5],l)}},t.prototype._drawMark=function(e,i,a,n,o){var s,l,u,c=a.x,h=a.y+n[0];(s=this.createFigure("line",{coordinates:[{x:c-2,y:h+n[0]},{x:c,y:h},{x:c+2,y:h+n[0]}]},{color:o.color}))===null||s===void 0||s.draw(e);var f,v,d,g=this.getWidget().getBounding().width;c>g/2?(f=c-5,v=f-o.textOffset,d="right"):(f=c+5,d="left",v=f+o.textOffset);var p=h+n[1];(l=this.createFigure("line",{coordinates:[{x:c,y:h},{x:c,y:p},{x:f,y:p}]},{color:o.color}))===null||l===void 0||l.draw(e),(u=this.createFigure("text",{x:v,y:p,text:i,align:d,baseline:"middle"},{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}))===null||u===void 0||u.draw(e)},t}($e),kn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.line;if(l.show&&u.show&&c.show){var h=n.getAxisComponent(),f=s.getDataList(),v=f[f.length-1];if(v!=null){var d=v.close,g=v.open,p=h.convertToNicePixel(d),m=void 0;d>g?m=u.upColor:d<g?m=u.downColor:m=u.noChangeColor,(i=this.createFigure("line",{coordinates:[{x:0,y:p},{x:o.width,y:p}]},{style:c.style,color:m,size:c.size,dashedValue:c.dashedValue}))===null||i===void 0||i.draw(e)}}},t}(Ot),Fn={time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",turnover:"成交额：",change:"涨幅："},Rn={time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "},Ln={"zh-CN":Fn,"en-US":Rn};function Bn(r,t){var e,i;return(i=(e=Ln[t])===null||e===void 0?void 0:e[r])!==null&&i!==void 0?i:r}var Vn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,a=this.getWidget(),n=a.getPane(),o=n.getId(),s=n.getChart().getChartStore(),l=s.getTooltipStore().getCrosshair();if(k(l.kLineData)){var u=a.getBounding(),c=(i=n.getYAxisWidget())===null||i===void 0?void 0:i.getBounding(),h=s.getDataList(),f=s.getPrecision(),v=s.getLocale(),d=s.getCustomApi(),g=s.getThousandsSeparator(),p=s.getTooltipStore().getActiveIcon(),m=s.getIndicatorStore().getInstances(n.getId()),_=s.getTimeScaleStore().getDateTimeFormat(),y=s.getStyles(),x=y.candle,b=y.indicator;if(x.tooltip.showType===Ft.Rect&&b.tooltip.showType===Ft.Rect){var I=this.isDrawTooltip(l,x.tooltip),C=this.isDrawTooltip(l,b.tooltip);this._drawRectTooltip(e,h,m,u,c,l,f,_,v,d,g,I,C,y,0)}else if(x.tooltip.showType===Ft.Standard&&b.tooltip.showType===Ft.Standard){var E=this._drawCandleStandardTooltip(e,h,o,u,l,p,f,_,v,d,g,x);this.drawIndicatorTooltip(e,o,h,l,p,m,d,g,u,b,E)}else if(x.tooltip.showType===Ft.Rect&&b.tooltip.showType===Ft.Standard){var A=this.drawIndicatorTooltip(e,o,h,l,p,m,d,g,u,b,0),I=this.isDrawTooltip(l,x.tooltip);this._drawRectTooltip(e,h,m,u,c,l,f,_,v,d,g,I,!1,y,A)}else{var F=this._drawCandleStandardTooltip(e,h,o,u,l,p,f,_,v,d,g,x),C=this.isDrawTooltip(l,b.tooltip);this._drawRectTooltip(e,h,m,u,c,l,f,_,v,d,g,!1,C,y,F)}}},t.prototype._drawCandleStandardTooltip=function(e,i,a,n,o,s,l,u,c,h,f,v){var d,g,p,m=v.tooltip,_=m.text,y=0;if(this.isDrawTooltip(o,m)){var x=(d=o.dataIndex)!==null&&d!==void 0?d:0,b=this._getCandleTooltipData({prev:(g=i[x-1])!==null&&g!==void 0?g:null,current:o.kLineData,next:(p=i[x+1])!==null&&p!==void 0?p:null},l,u,c,h,f,v),I=0,C=0,E=0,A=dt(this.classifyTooltipIcons(m.icons),3),F=A[0],P=A[1],L=A[2],T=dt(this.drawStandardTooltipIcons(e,n,{paneId:a,indicatorName:"",iconId:""},s,F,I,C,0),4),N=T[0],U=T[1],Y=T[2],ft=T[3];I=N,C=U,y+=ft,E=Y;var tt=dt(this.drawStandardTooltipIcons(e,n,{paneId:a,indicatorName:"",iconId:""},s,P,I,C,E),4),R=tt[0],z=tt[1],G=tt[2],M=tt[3];if(I=R,C=z,y+=M,E=G,b.length>0){var K=dt(this.drawStandardTooltipLabels(e,n,b,I,C,E,_),4),B=K[0],et=K[1],it=K[2],H=K[3];I=B,C=et,y+=H,E=it}var lt=dt(this.drawStandardTooltipIcons(e,n,{paneId:a,indicatorName:"",iconId:""},s,L,I,C,E),4),mt=lt[0],xt=lt[1],nt=lt[2],_t=lt[3];I=mt,C=xt,y+=_t,E=nt}return y},t.prototype._drawRectTooltip=function(e,i,a,n,o,s,l,u,c,h,f,v,d,g,p){var m=this,_,y,x,b,I,C=g.candle,E=g.indicator,A=C.tooltip,F=E.tooltip;if(v||d){var P=(_=s.dataIndex)!==null&&_!==void 0?_:0,L=this._getCandleTooltipData({prev:(y=i[P-1])!==null&&y!==void 0?y:null,current:s.kLineData,next:(x=i[P+1])!==null&&x!==void 0?x:null},l,u,c,h,f,C),T=A.text,N=T.marginLeft,U=T.marginRight,Y=T.marginTop,ft=T.marginBottom,tt=T.size,R=T.weight,z=T.family,G=A.rect,M=G.position,K=G.paddingLeft,B=G.paddingRight,et=G.paddingTop,it=G.paddingBottom,H=G.offsetLeft,lt=G.offsetRight,mt=G.offsetTop,xt=G.offsetBottom,nt=G.borderSize,_t=G.borderRadius,Gt=G.borderColor,Ae=G.color,Ut=0,Dt=0,St=0;v&&(e.font=te(tt,R,z),L.forEach(function(zt){var bt=zt.title,Ct=zt.value,Mt="".concat(bt.text).concat(Ct.text),Xt=e.measureText(Mt).width+N+U;Ut=Math.max(Ut,Xt)}),St+=(ft+Y+tt)*L.length);var Wt=F.text,pe=Wt.marginLeft,ge=Wt.marginRight,tr=Wt.marginTop,er=Wt.marginBottom,se=Wt.size,ke=Wt.weight,Fe=Wt.family,rr=[];if(d&&(e.font=te(se,ke,Fe),a.forEach(function(zt){var bt,Ct=(bt=m.getIndicatorTooltipData(i,s,zt,h,f,E).values)!==null&&bt!==void 0?bt:[];rr.push(Ct),Ct.forEach(function(Mt){var Xt=Mt.title,me=Mt.value,ei="".concat(Xt.text).concat(me.text),ri=e.measureText(ei).width+pe+ge;Ut=Math.max(Ut,ri),St+=tr+er+se})})),Dt+=Ut,Dt!==0&&St!==0){Dt+=nt*2+K+B,St+=nt*2+et+it;var Jr=n.width/2,ir=M===Ie.Pointer&&s.paneId===Q.CANDLE,ar=((b=s.realX)!==null&&b!==void 0?b:0)>Jr,Et=0;if(ir){var nr=s.realX;ar?Et=nr-lt-Dt:Et=nr+H}else ar?(Et=H,g.yAxis.inside&&g.yAxis.position===jt.Left&&(Et+=o.width)):(Et=n.width-lt-Dt,g.yAxis.inside&&g.yAxis.position===jt.Right&&(Et-=o.width));var qt=p+mt;if(ir){var Qr=s.y;qt=Qr-St/2,qt+St>n.height-xt&&(qt=n.height-xt-St),qt<p+mt&&(qt=p+mt)}(I=this.createFigure("rect",{x:Et,y:qt,width:Dt,height:St},{style:J.StrokeFill,color:Ae,borderColor:Gt,borderSize:nt,borderRadius:_t}))===null||I===void 0||I.draw(e);var $r=Et+nt+K+N,Ht=qt+nt+et;if(v&&L.forEach(function(zt){var bt,Ct;Ht+=Y;var Mt=zt.title;(bt=m.createFigure("text",{x:$r,y:Ht,text:Mt.text},{color:Mt.color,size:tt,family:z,weight:R}))===null||bt===void 0||bt.draw(e);var Xt=zt.value;(Ct=m.createFigure("text",{x:Et+Dt-nt-U-B,y:Ht,text:Xt.text,align:"right"},{color:Xt.color,size:tt,family:z,weight:R}))===null||Ct===void 0||Ct.draw(e),Ht+=tt+ft}),d){var ti=Et+nt+K+pe;rr.forEach(function(zt){zt.forEach(function(bt){var Ct,Mt;Ht+=tr;var Xt=bt.title,me=bt.value;(Ct=m.createFigure("text",{x:ti,y:Ht,text:Xt.text},{color:Xt.color,size:se,family:Fe,weight:ke}))===null||Ct===void 0||Ct.draw(e),(Mt=m.createFigure("text",{x:Et+Dt-nt-ge-B,y:Ht,text:me.text,align:"right"},{color:me.color,size:se,family:Fe,weight:ke}))===null||Mt===void 0||Mt.draw(e),Ht+=se+er})})}}}},t.prototype._getCandleTooltipData=function(e,i,a,n,o,s,l){var u,c,h,f,v,d,g=l.tooltip,p=g.text.color,m=e.current,_=(c=(u=e.prev)===null||u===void 0?void 0:u.close)!==null&&c!==void 0?c:m.close,y=m.close-_,x=i.price,b=i.volume,I={"{time}":o.formatDate(a,m.timestamp,"YYYY-MM-DD HH:mm",vt.Tooltip),"{open}":ht(at(m.open,x),s),"{high}":ht(at(m.high,x),s),"{low}":ht(at(m.low,x),s),"{close}":ht(at(m.close,x),s),"{volume}":ht(o.formatBigNumber(at((h=m.volume)!==null&&h!==void 0?h:g.defaultValue,b)),s),"{turnover}":ht(at((f=m.turnover)!==null&&f!==void 0?f:g.defaultValue,x),s),"{change}":_===0?g.defaultValue:"".concat(at(y/_*100),"%")},C=(d=Nt(g.custom)?(v=g.custom)===null||v===void 0?void 0:v.call(g,e,l):g.custom)!==null&&d!==void 0?d:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}];return C.map(function(E){var A,F=E.title,P=E.value,L={text:"",color:""};Bt(F)?L=V({},F):(L.text=F,L.color=p),L.text=Bn(L.text,n);var T={text:g.defaultValue,color:""};Bt(P)?T=V({},P):(T.text=P,T.color=p);var N=T.text.match(/{(\S*)}/);if(N!==null&&N.length>1){var U="{".concat(N[1],"}");T.text=T.text.replace(U,(A=I[U])!==null&&A!==void 0?A:g.defaultValue),U==="{change}"&&(T.color=y===0?l.priceMark.last.noChangeColor:y>0?l.priceMark.last.upColor:l.priceMark.last.downColor)}return{title:L,value:T}})},t}(zr),Nn=function(r){Z(t,r);function t(e,i){var a=r.call(this,e,i)||this;return a._candleBarView=new Wr(a),a._candleAreaView=new Dn(a),a._candleHighLowPriceView=new An(a),a._candleLastPriceLineView=new kn(a),a.addChild(a._candleBarView),a}return t.prototype.updateMainContent=function(e){var i=this.getPane().getChart().getStyles().candle;i.type!==Rt.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e)):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},t.prototype.createTooltipView=function(){return new Vn(this)},t}(Yr),Hr=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this,a,n=this.getWidget(),o=n.getPane(),s=n.getBounding(),l=o.getAxisComponent(),u=this.getAxisStyles(o.getChart().getStyles());if(u.show){u.axisLine.show&&((a=this.createFigure("line",this.createAxisLine(s,u),u.axisLine))===null||a===void 0||a.draw(e));var c=l.getTicks();if(u.tickLine.show){var h=this.createTickLines(c,s,u);h.forEach(function(v){var d;(d=i.createFigure("line",v,u.tickLine))===null||d===void 0||d.draw(e)})}if(u.tickText.show){var f=this.createTickTexts(c,s,u);f.forEach(function(v){var d;(d=i.createFigure("text",v,u.tickText))===null||d===void 0||d.draw(e)})}}},t}(Ot),On=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.yAxis},t.prototype.createAxisLine=function(e,i){var a=this.getWidget().getPane().getAxisComponent(),n=i.axisLine.size,o;return a.isFromZero()?o=n/2:o=e.width-n,{coordinates:[{x:o,y:0},{x:o,y:e.height}]}},t.prototype.createTickLines=function(e,i,a){var n=this.getWidget().getPane().getAxisComponent(),o=a.axisLine,s=a.tickLine,l=0,u=0;return n.isFromZero()?(l=0,o.show&&(l+=o.size),u=l+s.length):(l=i.width,o.show&&(l-=o.size),u=l-s.length),e.map(function(c){return{coordinates:[{x:l,y:c.coord},{x:u,y:c.coord}]}})},t.prototype.createTickTexts=function(e,i,a){var n=this.getWidget().getPane().getAxisComponent(),o=a.axisLine,s=a.tickLine,l=a.tickText,u=0;n.isFromZero()?(u=l.marginStart,o.show&&(u+=o.size),s.show&&(u+=s.length)):(u=i.width-l.marginEnd,o.show&&(u-=o.size),s.show&&(u-=s.length));var c=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(function(h){return{x:u,y:h.coord,text:h.text,align:c,baseline:"middle"}})},t}(Hr),Wn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getStyles().candle.priceMark,u=l.last,c=u.text;if(l.show&&u.show&&c.show){var h=s.getPrecision(),f=n.getAxisComponent(),v=s.getDataList(),d=s.getVisibleDataList(),g=v[v.length-1];if(k(g)){var p=g.close,m=g.open,_=f.convertToNicePixel(p),y=void 0;p>m?y=u.upColor:p<m?y=u.downColor:y=u.noChangeColor;var x=void 0;if(f.getType()===ut.Percentage){var b=d[0].data,I=b.close;x="".concat(((p-I)/I*100).toFixed(2),"%")}else x=at(p,h.price);x=ht(x,s.getThousandsSeparator());var C=void 0,E=void 0;f.isFromZero()?(C=0,E="left"):(C=o.width,E="right"),(i=this.createFigure("text",{x:C,y:_,text:x,align:E,baseline:"middle"},V(V({},c),{backgroundColor:y})))===null||i===void 0||i.draw(e)}}},t}(Ot),zn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i=this,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=n.getChart().getChartStore(),l=s.getCustomApi(),u=s.getStyles().indicator,c=u.lastValueMark,h=c.text;if(c.show){var f=n.getAxisComponent(),v=s.getDataList(),d=v.length-1,g=s.getIndicatorStore().getInstances(n.getId()),p=s.getThousandsSeparator();g.forEach(function(m){var _=m.result,y=_[d];if(k(y)&&m.visible){var x=m.precision;qe(v,m,d,u,function(b,I){var C,E=y[b.key];if(k(E)){var A=f.convertToNicePixel(E),F=at(E,x);m.shouldFormatBigNumber&&(F=l.formatBigNumber(F)),F=ht(F,p);var P=void 0,L=void 0;f.isFromZero()?(P=0,L="left"):(P=o.width,L="right"),(C=i.createFigure("text",{x:P,y:A,text:F,align:L,baseline:"middle"},V(V({},h),{backgroundColor:I.color})))===null||C===void 0||C.draw(e)}})}})}},t}(Ot),jr=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},t.prototype.drawDefaultFigures=function(e,i,a,n,o,s,l,u,c,h,f,v,d){this.drawFigures(e,i,this.getDefaultFigures(i,a,n,o,s,l,u,h,f,d),c)},t.prototype.getDefaultFigures=function(e,i,a,n,o,s,l,u,c,h){var f,v,d=[];if(e.needDefaultYAxisFigure&&e.id===((f=h.instance)===null||f===void 0?void 0:f.id)&&h.paneId===this.getWidget().getPane().getId()){var g=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,m=(v=c==null?void 0:c.isFromZero())!==null&&v!==void 0?v:!1,_,y;m?(_="left",y=0):(_="right",y=a.width),i.forEach(function(x,b){var I=e.points[b];if(X(I.value)){g=Math.min(g,x.y),p=Math.max(p,x.y);var C=ht(at(I.value,n.price),l);d.push({type:"text",attrs:{x:y,y:x.y,text:C,align:_,baseline:"middle"},ignoreEvent:!0})}}),i.length>1&&d.unshift({type:"rect",attrs:{x:0,y:g,width:a.width,height:p-g},ignoreEvent:!0})}return d},t.prototype.getFigures=function(e,i,a,n,o,s,l,u,c,h){var f,v;return(v=(f=e.createYAxisFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:i,bounding:a,barSpace:n,precision:o,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:u,xAxis:c,yAxis:h}))!==null&&v!==void 0?v:[]},t}(Xr),Gr=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.drawImp=function(e){var i,a=this.getWidget(),n=a.getPane(),o=a.getBounding(),s=a.getPane().getChart().getChartStore(),l=s.getTooltipStore().getCrosshair(),u=s.getStyles().crosshair;if(j(l.paneId)&&this.compare(l,n.getId())&&u.show){var c=this.getDirectionStyles(u),h=c.text;if(c.show&&h.show){var f=n.getAxisComponent(),v=this.getText(l,s,f);e.font=te(h.size,h.weight,h.family),(i=this.createFigure("text",this.getTextAttrs(v,e.measureText(v).width,l,o,f,h),h))===null||i===void 0||i.draw(e)}}},t.prototype.compare=function(e,i){return e.paneId===i},t.prototype.getDirectionStyles=function(e){return e.horizontal},t.prototype.getText=function(e,i,a){var n,o,s=a,l=a.convertFromPixel(e.y),u;if(s.getType()===ut.Percentage){var c=i.getVisibleDataList(),h=(o=(n=c[0])===null||n===void 0?void 0:n.data)!==null&&o!==void 0?o:{};u="".concat(((l-h.close)/h.close*100).toFixed(2),"%")}else{var f=i.getIndicatorStore().getInstances(e.paneId),v=0,d=!1;s.isInCandle()?v=i.getPrecision().price:f.forEach(function(g){v=Math.max(g.precision,v),d||(d=g.shouldFormatBigNumber)}),u=at(l,v),d&&(u=i.getCustomApi().formatBigNumber(u))}return ht(u,i.getThousandsSeparator())},t.prototype.getTextAttrs=function(e,i,a,n,o,s){var l=o,u,c;return l.isFromZero()?(u=0,c="left"):(u=n.width,c="right"),{x:u,y:a.y,text:e,align:c,baseline:"middle"}},t}(Ot),Xn=function(r){Z(t,r);function t(e,i){var a=r.call(this,e,i)||this;return a._yAxisView=new On(a),a._candleLastPriceLabelView=new Wn(a),a._indicatorLastValueView=new zn(a),a._overlayYAxisView=new jr(a),a._crosshairHorizontalLabelView=new Gr(a),a.getContainer().style.cursor="ns-resize",a.addChild(a._overlayYAxisView),a}return t.prototype.getName=function(){return q.Y_AXIS},t.prototype.updateMain=function(e){this._yAxisView.draw(e),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(e),this._indicatorLastValueView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayYAxisView.draw(e),this._crosshairHorizontalLabelView.draw(e)},t}(Je),Ur=function(){function r(t){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return r.prototype.getParent=function(){return this._parent},r.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),this._prevExtremum.min!==this._extremum.min||this._prevExtremum.max!==this._extremum.max||t?(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0):!1},r.prototype.getTicks=function(){return this._ticks},r.prototype.getScrollZoomEnabled=function(){var t;return(t=this.getParent().getOptions().axisOptions.scrollZoomEnabled)!==null&&t!==void 0?t:!0},r.prototype.setExtremum=function(t){this._autoCalcTickFlag=!1,this._extremum=t},r.prototype.getExtremum=function(){return this._extremum},r.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},r.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},r.prototype._calcTicks=function(){var t=this._extremum,e=t.realMin,i=t.realMax,a=t.realRange,n=[];if(a>=0){var o=dt(this._calcTickInterval(a),2),s=o[0],l=o[1],u=hr(Math.ceil(e/s)*s,l),c=hr(Math.floor(i/s)*s,l),h=0,f=u;if(s!==0)for(;f<=c;){var v=f.toFixed(l);n[h]={text:v,coord:0,value:v},++h,f+=s}}return n},r.prototype._calcTickInterval=function(t){var e=Ui(t/8),i=qi(e);return[e,i]},r}(),Yn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.calcExtremum=function(){var e,i,a,n,o,s=this.getParent(),l=s.getChart(),u=l.getChartStore(),c=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,f=[],v=!1,d=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,p=Number.MAX_SAFE_INTEGER,m=u.getIndicatorStore().getInstances(s.getId());m.forEach(function(K){var B,et,it;v||(v=(B=K.shouldOhlc)!==null&&B!==void 0?B:!1),p=Math.min(p,K.precision),K.minValue!==null&&(d=Math.min(d,K.minValue)),K.maxValue!==null&&(g=Math.max(g,K.maxValue)),f.push({figures:(et=K.figures)!==null&&et!==void 0?et:[],result:(it=K.result)!==null&&it!==void 0?it:[]})});var _=4,y=this.isInCandle();if(y){var x=u.getPrecision().price;p!==Number.MAX_SAFE_INTEGER?_=Math.min(p,x):_=x}else p!==Number.MAX_SAFE_INTEGER&&(_=p);var b=u.getVisibleDataList(),I=l.getStyles().candle,C=I.type===Rt.Area,E=I.area.value,A=y&&!C||!y&&v;b.forEach(function(K){var B=K.dataIndex,et=K.data;if(A&&(c=Math.min(c,et.low),h=Math.max(h,et.high)),y&&C){var it=et[E];c=Math.min(c,it),h=Math.max(h,it)}f.forEach(function(H){var lt,mt=H.figures,xt=H.result,nt=(lt=xt[B])!==null&&lt!==void 0?lt:{};mt.forEach(function(_t){var Gt=nt[_t.key];k(Gt)&&(c=Math.min(c,Gt),h=Math.max(h,Gt))})})}),c!==Number.MAX_SAFE_INTEGER&&h!==Number.MIN_SAFE_INTEGER?(c=Math.min(d,c),h=Math.max(g,h)):(c=0,h=10);var F=this.getType(),P;switch(F){case ut.Percentage:{var L=(e=b[0])===null||e===void 0?void 0:e.data;X(L==null?void 0:L.close)&&(c=(c-L.close)/L.close*100,h=(h-L.close)/L.close*100),P=Math.pow(10,-2);break}case ut.Log:{c=ce(c),h=ce(h),P=.05*Zt(-_);break}default:P=Zt(-_)}if(c===h||Math.abs(c-h)<P){var T=d===c,N=g===h;c=T?c:N?c-8*P:c-4*P,h=N?h:T?h+8*P:h+4*P}var U=(a=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&a!==void 0?a:0,Y=s.getOptions().gap,ft=(n=Y==null?void 0:Y.top)!==null&&n!==void 0?n:.2;ft>=1&&(ft=ft/U);var tt=(o=Y==null?void 0:Y.bottom)!==null&&o!==void 0?o:.1;tt>=1&&(tt=tt/U);var R=Math.abs(h-c);c=c-R*tt,h=h+R*ft,R=Math.abs(h-c);var z,G,M;return F===ut.Log?(z=Zt(c),G=Zt(h),M=Math.abs(G-z)):(z=c,G=h,M=R),{min:c,max:h,range:R,realMin:z,realMax:G,realRange:M}},t.prototype._innerConvertToPixel=function(e){var i,a,n=(a=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&a!==void 0?a:0,o=this.getExtremum(),s=o.min,l=o.range,u=(e-s)/l;return this.isReverse()?Math.round(u*n):Math.round((1-u)*n)},t.prototype.isInCandle=function(){return this.getParent().getId()===Q.CANDLE},t.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:ut.Normal},t.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},t.prototype.isReverse=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.reverse:!1},t.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,i=e.inside;return e.position===jt.Left&&i||e.position===jt.Right&&!i},t.prototype.optimalTicks=function(e){var i=this,a,n,o=this.getParent(),s=(n=(a=o.getYAxisWidget())===null||a===void 0?void 0:a.getBounding().height)!==null&&n!==void 0?n:0,l=o.getChart().getChartStore(),u=l.getCustomApi(),c=[],h=this.getType(),f=l.getIndicatorStore().getInstances(o.getId()),v=l.getThousandsSeparator(),d=0,g=!1;this.isInCandle()?d=l.getPrecision().price:f.forEach(function(_){d=Math.max(d,_.precision),g||(g=_.shouldFormatBigNumber)});var p=l.getStyles().xAxis.tickText.size,m;return e.forEach(function(_){var y=_.value,x,b=i._innerConvertToPixel(+y);switch(h){case ut.Percentage:{x="".concat(at(y,2),"%");break}case ut.Log:{b=i._innerConvertToPixel(ce(+y)),x=at(y,d);break}default:{x=at(y,d),g&&(x=u.formatBigNumber(y));break}}x=ht(x,v);var I=X(m);b>p&&b<s-p&&(I&&Math.abs(m-b)>p*2||!I)&&(c.push({text:x,coord:b,value:y}),m=b)}),c},t.prototype.getAutoSize=function(){var e=this.getParent(),i=e.getChart(),a=i.getStyles(),n=a.yAxis,o=n.size;if(o!=="auto")return o;var s=i.getChartStore(),l=s.getCustomApi(),u=0;if(n.show&&(n.axisLine.show&&(u+=n.axisLine.size),n.tickLine.show&&(u+=n.tickLine.length),n.tickText.show)){var c=0;this.getTicks().forEach(function(x){c=Math.max(c,Ee(x.text,n.tickText.size,n.tickText.weight,n.tickText.family))}),u+=n.tickText.marginStart+n.tickText.marginEnd+c}var h=a.crosshair,f=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var v=s.getIndicatorStore().getInstances(e.getId()),d=0,g=!1;v.forEach(function(x){d=Math.max(x.precision,d),g||(g=x.shouldFormatBigNumber)});var p=2;if(this.getType()!==ut.Percentage)if(this.isInCandle()){var m=s.getPrecision().price,_=a.indicator.lastValueMark;_.show&&_.text.show?p=Math.max(d,m):p=m}else p=d;var y=at(this.getExtremum().max,p);g&&(y=l.formatBigNumber(y)),f+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+h.horizontal.text.borderSize*2+Ee(y,h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(u,f)},t.prototype.convertFromPixel=function(e){var i,a,n,o=(a=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&a!==void 0?a:0,s=this.getExtremum(),l=s.min,u=s.range,c=this.isReverse()?e/o:1-e/o,h=c*u+l;switch(this.getType()){case ut.Percentage:{var f=this.getParent().getChart().getChartStore(),v=f.getVisibleDataList(),d=(n=v[0])===null||n===void 0?void 0:n.data;return X(d==null?void 0:d.close)?d.close*h/100+d.close:0}case ut.Log:return Zt(h);default:return h}},t.prototype.convertToRealValue=function(e){var i=e;return this.getType()===ut.Log&&(i=Zt(e)),i},t.prototype.convertToPixel=function(e){var i,a=e;switch(this.getType()){case ut.Percentage:{var n=this.getParent().getChart().getChartStore(),o=n.getVisibleDataList(),s=(i=o[0])===null||i===void 0?void 0:i.data;X(s==null?void 0:s.close)&&(a=(e-s.close)/s.close*100);break}case ut.Log:{a=ce(e);break}default:a=e}return this._innerConvertToPixel(a)},t.prototype.convertToNicePixel=function(e){var i,a,n=(a=(i=this.getParent().getYAxisWidget())===null||i===void 0?void 0:i.getBounding().height)!==null&&a!==void 0?a:0,o=this.convertToPixel(e);return Math.round(Math.max(n*.05,Math.min(o,n*.98)))},t}(Ur),qr=function(){function r(t,e,i,a){this._bounding=Rr(),this._chart=i,this._id=a,this._init(t,e)}return r.prototype._init=function(t,e){this._rootContainer=t,this._container=Vt("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),e!==null?t.insertBefore(this._container,e):t.appendChild(this._container)},r.prototype.getContainer=function(){return this._container},r.prototype.getId=function(){return this._id},r.prototype.getChart=function(){return this._chart},r.prototype.getBounding=function(){return this._bounding},r.prototype.update=function(t){this._bounding.height!==this._container.offsetHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(t!=null?t:3,this._container,this._bounding)},r.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},r}(),Zr=function(r){Z(t,r);function t(e,i,a,n){var o=r.call(this,e,i,a,n)||this;o._yAxisWidget=null,o._axis=o.createAxisComponent(),o._options={minHeight:Qa,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{scrollZoomEnabled:!0}};var s=o.getContainer();return o._mainWidget=o.createMainWidget(s),o._yAxisWidget=o.createYAxisWidget(s),o}return t.prototype.setOptions=function(e){var i,a,n;It(this._options,e);var o,s;return this.getId()===Q.X_AXIS?(o=this.getMainWidget().getContainer(),s="ew-resize"):(o=(i=this.getYAxisWidget())===null||i===void 0?void 0:i.getContainer(),s="ns-resize"),!((n=(a=e.axisOptions)===null||a===void 0?void 0:a.scrollZoomEnabled)!==null&&n!==void 0)||n?o.style.cursor=s:o.style.cursor="default",this},t.prototype.getOptions=function(){return this._options},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(e,i,a){var n,o;It(this.getBounding(),e);var s={};return k(e.height)&&(s.height=e.height),k(e.top)&&(s.top=e.top),this._mainWidget.setBounding(s),(n=this._yAxisWidget)===null||n===void 0||n.setBounding(s),k(i)&&this._mainWidget.setBounding(i),k(a)&&((o=this._yAxisWidget)===null||o===void 0||o.setBounding(a)),this},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.updateImp=function(e){var i;this._mainWidget.update(e),(i=this._yAxisWidget)===null||i===void 0||i.update(e)},t.prototype.getImage=function(e){var i=this.getBounding(),a=i.width,n=i.height,o=Vt("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),s=o.getContext("2d"),l=ne(o);o.width=a*l,o.height=n*l,s.scale(l,l);var u=this._mainWidget.getBounding();if(s.drawImage(this._mainWidget.getImage(e),u.left,0,u.width,u.height),this._yAxisWidget!==null){var c=this._yAxisWidget.getBounding();s.drawImage(this._yAxisWidget.getImage(e),c.left,0,c.width,c.height)}return o},t.prototype.createYAxisWidget=function(e){return null},t}(qr),Kr=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(){return new Yn(this)},t.prototype.createMainWidget=function(e){return new Yr(e,this)},t.prototype.createYAxisWidget=function(e){return new Xn(e,this)},t}(Zr),Hn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createMainWidget=function(e){return new Nn(e,this)},t}(Kr),jn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getAxisStyles=function(e){return e.xAxis},t.prototype.createAxisLine=function(e,i){var a=i.axisLine.size/2;return{coordinates:[{x:0,y:a},{x:e.width,y:a}]}},t.prototype.createTickLines=function(e,i,a){var n=a.tickLine,o=a.axisLine.size;return e.map(function(s){return{coordinates:[{x:s.coord,y:0},{x:s.coord,y:o+n.length}]}})},t.prototype.createTickTexts=function(e,i,a){var n=a.tickText,o=a.axisLine.size,s=a.tickLine.length;return e.map(function(l){return{x:l.coord,y:o+s+n.marginStart,text:l.text,align:"center",baseline:"top"}})},t}(Hr),Gn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.coordinateToPointValueFlag=function(){return!1},t.prototype.getCompleteOverlays=function(e){return e.getInstances()},t.prototype.getProgressOverlay=function(e){return e.instance},t.prototype.getDefaultFigures=function(e,i,a,n,o,s,l,u,c,h){var f,v=[];if(e.needDefaultXAxisFigure&&e.id===((f=h.instance)===null||f===void 0?void 0:f.id)){var d=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;i.forEach(function(p,m){d=Math.min(d,p.x),g=Math.max(g,p.x);var _=e.points[m];if(X(_.timestamp)){var y=s.formatDate(o,_.timestamp,"YYYY-MM-DD HH:mm",vt.Crosshair);v.push({type:"text",attrs:{x:p.x,y:0,text:y,align:"center"},ignoreEvent:!0})}}),i.length>1&&v.unshift({type:"rect",attrs:{x:d,y:0,width:g-d,height:a.height},ignoreEvent:!0})}return v},t.prototype.getFigures=function(e,i,a,n,o,s,l,u,c,h){var f,v;return(v=(f=e.createXAxisFigures)===null||f===void 0?void 0:f.call(e,{overlay:e,coordinates:i,bounding:a,barSpace:n,precision:o,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:u,xAxis:c,yAxis:h}))!==null&&v!==void 0?v:[]},t}(jr),Un=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.compare=function(e){return k(e.kLineData)&&e.dataIndex===e.realDataIndex},t.prototype.getDirectionStyles=function(e){return e.vertical},t.prototype.getText=function(e,i){var a,n=(a=e.kLineData)===null||a===void 0?void 0:a.timestamp;return i.getCustomApi().formatDate(i.getTimeScaleStore().getDateTimeFormat(),n,"YYYY-MM-DD HH:mm",vt.Crosshair)},t.prototype.getTextAttrs=function(e,i,a,n,o,s){var l=a.realX,u,c="center";return l-i/2-s.paddingLeft<0?(u=0,c="left"):l+i/2+s.paddingRight>n.width?(u=n.width,c="right"):u=l,{x:u,y:0,text:e,align:c,baseline:"top"}},t}(Gr),qn=function(r){Z(t,r);function t(e,i){var a=r.call(this,e,i)||this;return a._xAxisView=new jn(a),a._overlayXAxisView=new Gn(a),a._crosshairVerticalLabelView=new Un(a),a.getContainer().style.cursor="ew-resize",a.addChild(a._overlayXAxisView),a}return t.prototype.getName=function(){return q.X_AXIS},t.prototype.updateMain=function(e){this._xAxisView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayXAxisView.draw(e),this._crosshairVerticalLabelView.draw(e)},t}(Je),Zn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.calcExtremum=function(){var e=this.getParent().getChart().getChartStore(),i=e.getTimeScaleStore().getVisibleRange(),a=i.from,n=i.to,o=a,s=n-1,l=n-a;return{min:o,max:s,range:l,realMin:o,realMax:s,realRange:l}},t.prototype.optimalTicks=function(e){var i,a,n=this.getParent().getChart(),o=n.getChartStore(),s=o.getCustomApi().formatDate,l=[],u=e.length,c=o.getDataList();if(u>0){var h=o.getTimeScaleStore().getDateTimeFormat(),f=n.getStyles().xAxis.tickText,v=Ee("00-00 00:00",f.size,f.weight,f.family),d=parseInt(e[0].value,10),g=this.convertToPixel(d),p=1;if(u>1){var m=parseInt(e[1].value,10),_=this.convertToPixel(m),y=Math.abs(_-g);y<v&&(p=Math.ceil(v/y))}for(var x=0;x<u;x+=p){var b=parseInt(e[x].value,10),I=c[b],C=I.timestamp,E=s(h,C,"HH:mm",vt.XAxis);if(x!==0){var A=parseInt(e[x-p].value,10),F=c[A],P=F.timestamp;E=(i=this._optimalTickLabel(s,h,C,P))!==null&&i!==void 0?i:E}var L=this.convertToPixel(b);l.push({text:E,coord:L,value:C})}var T=l.length;if(T===1)l[0].text=s(h,l[0].value,"YYYY-MM-DD HH:mm",vt.XAxis);else{var N=l[0].value,U=l[1].value;if(k(l[2])){var Y=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(Y)?l[0].text=s(h,N,"MM-DD",vt.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(Y)?l[0].text=s(h,N,"YYYY-MM",vt.XAxis):/^[0-9]{4}$/.test(Y)&&(l[0].text=s(h,N,"YYYY",vt.XAxis))}else l[0].text=(a=this._optimalTickLabel(s,h,N,U))!==null&&a!==void 0?a:l[0].text}}return l},t.prototype._optimalTickLabel=function(e,i,a,n){var o=e(i,a,"YYYY",vt.XAxis),s=e(i,a,"YYYY-MM",vt.XAxis),l=e(i,a,"MM-DD",vt.XAxis);return o!==e(i,n,"YYYY",vt.XAxis)?o:s!==e(i,n,"YYYY-MM",vt.XAxis)?s:l!==e(i,n,"MM-DD",vt.XAxis)?l:null},t.prototype.getAutoSize=function(){var e=this.getParent().getChart().getStyles(),i=e.xAxis,a=i.size;if(a!=="auto")return a;var n=e.crosshair,o=0;i.show&&(i.axisLine.show&&(o+=i.axisLine.size),i.tickLine.show&&(o+=i.tickLine.length),i.tickText.show&&(o+=i.tickText.marginStart+i.tickText.marginEnd+i.tickText.size));var s=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(s+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+n.vertical.text.borderSize*2+n.vertical.text.size),Math.max(o,s)},t.prototype.convertTimestampFromPixel=function(e){var i=this.getParent().getChart().getChartStore().getTimeScaleStore(),a=i.coordinateToDataIndex(e);return i.dataIndexToTimestamp(a)},t.prototype.convertTimestampToPixel=function(e){var i=this.getParent().getChart().getChartStore().getTimeScaleStore(),a=i.timestampToDataIndex(e);return i.dataIndexToCoordinate(a)},t.prototype.convertFromPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(e)},t.prototype.convertToPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(e)},t}(Ur),Kn=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAxisComponent=function(){return new Zn(this)},t.prototype.createMainWidget=function(e){return new qn(e,this)},t}(Zr),Jn=function(r){Z(t,r);function t(e,i){var a=r.call(this,e,i)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._bottomPaneHeight=0,a._pressedMouseMoveEvent=Mn(a._pressedTouchMouseMoveEvent,20),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return t.prototype.getName=function(){return q.SEPARATOR},t.prototype.checkEventOn=function(){return!0},t.prototype._mouseDownEvent=function(e){this._dragFlag=!0,this._dragStartY=e.pageY;var i=this.getPane();return this._topPaneHeight=i.getTopPane().getBounding().height,this._bottomPaneHeight=i.getBottomPane().getBounding().height,!0},t.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},t.prototype._pressedTouchMouseMoveEvent=function(e){var i=e.pageY-this._dragStartY,a=this.getPane(),n=a.getTopPane(),o=a.getBottomPane(),s=i<0;if(n!==null&&o!==null&&o.getOptions().dragEnabled){var l=void 0,u=void 0,c=void 0,h=void 0;s?(l=n,u=o,c=this._topPaneHeight,h=this._bottomPaneHeight):(l=o,u=n,c=this._bottomPaneHeight,h=this._topPaneHeight);var f=l.getOptions().minHeight;if(c>f){var v=Math.max(c-Math.abs(i),f),d=c-v;l.setBounding({height:v}),u.setBounding({height:h+d});var g=a.getChart();g.getChartStore().getActionStore().execute(Tt.OnPaneDrag,{paneId:a.getId}),g.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},t.prototype._mouseEnterEvent=function(){var e,i=this.getPane(),a=i.getBottomPane();if((e=a==null?void 0:a.getOptions().dragEnabled)!==null&&e!==void 0&&e){var n=i.getChart(),o=n.getStyles().separator;return this.getContainer().style.background=o.activeBackgroundColor,!0}return!1},t.prototype._mouseLeaveEvent=function(){return this._dragFlag?!1:(this.getContainer().style.background="",!0)},t.prototype.createContainer=function(){return Vt("div",{width:"100%",height:"".concat(ve,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},t.prototype.updateImp=function(e,i,a){if(a===4||a===2){var n=this.getPane().getChart().getStyles().separator;e.style.top="".concat(-Math.floor((ve-n.size)/2),"px"),e.style.height="".concat(ve,"px")}},t}(Lr),pr=function(r){Z(t,r);function t(e,i,a,n,o,s){var l=r.call(this,e,i,a,n)||this;return l.getContainer().style.overflow="",l._topPane=o,l._bottomPane=s,l._separatorWidget=new Jn(l.getContainer(),l),l}return t.prototype.setBounding=function(e){return It(this.getBounding(),e),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(e){return this._topPane=e,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(e){return this._bottomPane=e,this},t.prototype.getWidget=function(){return this._separatorWidget},t.prototype.getImage=function(e){var i=this.getBounding(),a=i.width,n=i.height,o=this.getChart().getStyles().separator,s=Vt("canvas",{width:"".concat(a,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),l=s.getContext("2d"),u=ne(s);return s.width=a*u,s.height=n*u,l.scale(u,u),l.fillStyle=o.color,l.fillRect(0,0,a,n),s},t.prototype.updateImp=function(e,i,a){if(e===4||e===2){var n=this.getChart().getStyles().separator;i.style.backgroundColor=n.color,i.style.height="".concat(a.height,"px"),i.style.marginLeft="".concat(a.left,"px"),i.style.width="".concat(a.width,"px"),this._separatorWidget.update(e)}},t}(qr);function gr(){var r;return typeof window=="undefined"?!1:((r=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&r!==void 0?r:-1)>-1}function ze(){return typeof window=="undefined"?!1:/iPhone|iPad|iPod/.test(window.navigator.platform)}var Qn=10,$n=function(){function r(t,e,i){var a=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!ze(),this._onFirefoxOutsideMouseUp=function(n){a._mouseUpHandler(n)},this._onMobileSafariDoubleClick=function(n){if(a._firesTouchEvents(n)){if(++a._tapCount,a._tapTimeoutId!==null&&a._tapCount>1){var o=a._mouseTouchMoveWithDownInfo(a._getCoordinate(n),a._tapCoordinate).manhattanDistance;o<30&&!a._cancelTap&&a._processEvent(a._makeCompatEvent(n),a._handler.doubleTapEvent),a._resetTapTimeout()}}else if(++a._clickCount,a._clickTimeoutId!==null&&a._clickCount>1){var o=a._mouseTouchMoveWithDownInfo(a._getCoordinate(n),a._clickCoordinate).manhattanDistance;o<5&&!a._cancelClick&&a._processEvent(a._makeCompatEvent(n),a._handler.mouseDoubleClickEvent),a._resetClickTimeout()}},this._target=t,this._handler=e,this._options=i,this._init()}return r.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},r.prototype._mouseEnterHandler=function(t){var e=this,i,a,n;(i=this._unsubscribeMousemove)===null||i===void 0||i.call(this),(a=this._unsubscribeMouseWheel)===null||a===void 0||a.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this);var o=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){e._target.removeEventListener("mousemove",o)},this._target.addEventListener("mousemove",o);var s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){e._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){e._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},r.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},r.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},r.prototype._mouseMoveHandler=function(t){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},r.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!k(this._handler.mouseWheelHortEvent)||(this._preventDefault(t),Math.abs(t.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!k(this._handler.mouseWheelVertEvent))return;var e=-(t.deltaY/100);if(e===0)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32;break}if(e!==0){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},r.prototype._contextMenuHandler=function(t){this._preventDefault(t)},r.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),a=i.xOffset,n=i.yOffset,o=i.manhattanDistance;if(!(!this._touchMoveExceededManhattanDistance&&o<5)){if(!this._touchMoveExceededManhattanDistance){var s=a*.5,l=n>=s&&!this._options.treatVertDragAsPageScroll(),u=s>n&&!this._options.treatHorzDragAsPageScroll();!l&&!u&&(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},r.prototype._mouseMoveWithDownHandler=function(t){if(t.button===0){var e=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate),i=e.manhattanDistance;i>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent)}},r.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y),n=i+a;return{xOffset:i,yOffset:a,manhattanDistance:n}},r.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);if(this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1){var a=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance;a<30&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processEvent(i,this._handler.tapEvent),k(this._handler.tapEvent)&&this._preventDefault(t));this._tapCount===0&&this._preventDefault(t),t.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},r.prototype._mouseUpHandler=function(t){if(t.button===0){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),gr()){var i=this._target.ownerDocument.documentElement;i.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1){var a=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance;a<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},r.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},r.prototype._touchStartHandler=function(t){if(this._activeTouchId===null){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{var a=this._touchMoveHandler.bind(this),n=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",a),i.removeEventListener("touchend",n)},i.addEventListener("touchmove",a,{passive:!1}),i.addEventListener("touchend",n,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500)}this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},r.prototype._mouseDownHandler=function(t){if(t.button===2){this._preventDefault(t),this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);return}if(t.button===0){var e=this._target.ownerDocument.documentElement;gr()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{var i=this._mouseMoveWithDownHandler.bind(this),a=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",a)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",a)}this._mousePressed=!0,!this._firesTouchEvents(t)&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},r.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));{var e=this._target.ownerDocument,i=function(a){t._handler.mouseDownOutsideEvent!=null&&(a.composed&&t._target.contains(a.composedPath()[0])||a.target!==null&&t._target.contains(a.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0})}ze()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(a){if(a.button===1)return a.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},r.prototype._initPinch=function(){var t=this;!k(this._handler.pinchStartEvent)&&!k(this._handler.pinchEvent)&&!k(this._handler.pinchEndEvent)||(this._target.addEventListener("touchstart",function(e){return t._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(e){if(!(e.touches.length!==2||t._startPinchMiddleCoordinate===null)&&k(t._handler.pinchEvent)){var i=t._getTouchDistance(e.touches[0],e.touches[1]),a=i/t._startPinchDistance;t._handler.pinchEvent(V(V({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),a),t._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",function(e){t._checkPinchState(e.touches)}))},r.prototype._checkPinchState=function(t){t.length===1&&(this._pinchPrevented=!1),t.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},r.prototype._startPinch=function(t){var e,i=(e=this._target.getBoundingClientRect())!==null&&e!==void 0?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),k(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},r.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,k(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},r.prototype._mouseLeaveHandler=function(t){var e,i,a;(e=this._unsubscribeMousemove)===null||e===void 0||e.call(this),(i=this._unsubscribeMouseWheel)===null||i===void 0||i.call(this),(a=this._unsubscribeContextMenu)===null||a===void 0||a.call(this),!this._firesTouchEvents(t)&&this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!ze())},r.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);e!==null&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},r.prototype._firesTouchEvents=function(t){var e;return k((e=t.sourceCapabilities)===null||e===void 0?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},r.prototype._processEvent=function(t,e){e==null||e.call(this._handler,t)},r.prototype._makeCompatEvent=function(t,e){var i=this,a,n=e!=null?e:t,o=(a=this._target.getBoundingClientRect())!==null&&a!==void 0?a:{left:0,top:0};return{x:n.clientX-o.left,y:n.clientY-o.top,pageX:n.pageX,pageY:n.pageY,isTouch:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",preventDefault:function(){t.type!=="touchstart"&&i._preventDefault(t)}}},r.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,a=t.clientY-e.clientY;return Math.sqrt(i*i+a*a)},r.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},r.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},r.prototype._eventTimeStamp=function(t){var e;return(e=t.timeStamp)!==null&&e!==void 0?e:performance.now()},r.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},r}(),to=function(){function r(t,e){var i=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(a){if(a.shiftKey)switch(a.code){case"Equal":{i._chart.getChartStore().getTimeScaleStore().zoom(.5);break}case"Minus":{i._chart.getChartStore().getTimeScaleStore().zoom(-.5);break}case"ArrowLeft":{var n=i._chart.getChartStore().getTimeScaleStore();n.startScroll(),n.scroll(-3*n.getBarSpace().bar);break}case"ArrowRight":{var n=i._chart.getChartStore().getTimeScaleStore();n.startScroll(),n.scroll(3*n.getBarSpace().bar);break}}},this._container=t,this._chart=e,this._event=new $n(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return r.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},r.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),a=i.pane,n=i.widget;if((a==null?void 0:a.getId())!==Q.X_AXIS&&(n==null?void 0:n.getName())===q.MAIN){var o=this._makeWidgetEvent(t,n),s=(e-this._pinchScale)*5;return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(s,{x:o.x,y:o.y}),!0}return!1},r.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore().getTimeScaleStore();return i.startScroll(),i.scroll(e),!0},r.prototype.mouseWheelVertEvent=function(t,e){var i,a=this._findWidgetByEvent(t).widget,n=(i=t.isTouch)!==null&&i!==void 0?i:!1,o=this._makeWidgetEvent(t,a),s=null,l=a==null?void 0:a.getName();if(n)if(l===q.MAIN||l===q.X_AXIS)s={x:o.x,y:o.y};else{var u=this._chart.getCandlePane().getBounding();s={x:u.width/2,y:u.height/2}}else l===q.MAIN&&(s={x:o.x,y:o.y});return s!==null?(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:o.x,y:o.y}),!0):!1},r.prototype.mouseDownEvent=function(t){var e,i,a=this._findWidgetByEvent(t),n=a.pane,o=a.widget;if(this._mouseDownWidget=o,o!==null){var s=this._makeWidgetEvent(t,o),l=o.getName();switch(l){case q.SEPARATOR:return o.dispatchEvent("mouseDownEvent",s);case q.MAIN:{var u=(e=n.getAxisComponent().getExtremum())!==null&&e!==void 0?e:null;return this._prevYAxisExtremum=u===null?u:V({},u),this._startScrollCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),o.dispatchEvent("mouseDownEvent",s)}case q.X_AXIS:{var c=o.dispatchEvent("mouseDownEvent",s);return c&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:s.x,y:s.y},this._xAxisStartScaleDistance=s.pageX,c}case q.Y_AXIS:{var c=o.dispatchEvent("mouseDownEvent",s);c&&this._chart.updatePane(1);var u=(i=n.getAxisComponent().getExtremum())!==null&&i!==void 0?i:null;return this._prevYAxisExtremum=u===null?u:V({},u),this._yAxisStartScaleDistance=s.pageY,c}}}return!1},r.prototype.mouseMoveEvent=function(t){var e,i,a,n=this._findWidgetByEvent(t),o=n.pane,s=n.widget,l=this._makeWidgetEvent(t,s);if((((e=this._mouseMoveTriggerWidgetInfo.pane)===null||e===void 0?void 0:e.getId())!==(o==null?void 0:o.getId())||((i=this._mouseMoveTriggerWidgetInfo.widget)===null||i===void 0?void 0:i.getName())!==(s==null?void 0:s.getName()))&&(s==null||s.dispatchEvent("mouseEnterEvent",l),(a=this._mouseMoveTriggerWidgetInfo.widget)===null||a===void 0||a.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:o,widget:s}),s!==null){var u=s.getName();switch(u){case q.MAIN:{var c=s.dispatchEvent("mouseMoveEvent",l),h=this._chart.getChartStore(),f={x:l.x,y:l.y,paneId:o==null?void 0:o.getId()};return c&&h.getTooltipStore().getActiveIcon()!==null&&(f=void 0,s!==null&&(s.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(f),c}case q.SEPARATOR:case q.X_AXIS:case q.Y_AXIS:{var c=s.dispatchEvent("mouseMoveEvent",l);return this._chart.getChartStore().getTooltipStore().setCrosshair(),c}}}return!1},r.prototype.pressedMouseMoveEvent=function(t){var e,i,a,n,o;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===q.SEPARATOR)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var s=this._findWidgetByEvent(t),l=s.pane,u=s.widget;if(u!==null&&((e=this._mouseDownWidget)===null||e===void 0?void 0:e.getPane().getId())===(l==null?void 0:l.getId())&&((i=this._mouseDownWidget)===null||i===void 0?void 0:i.getName())===u.getName()){var c=this._makeWidgetEvent(t,u),h=u.getName();switch(h){case q.MAIN:{var f=u.getBounding(),v=u.dispatchEvent("pressedMouseMoveEvent",c);if(!v&&this._startScrollCoordinate!==null){var d=l.getAxisComponent();if(this._prevYAxisExtremum!==null&&!d.getAutoCalcTickFlag()&&d.getScrollZoomEnabled()){var g=this._prevYAxisExtremum,p=g.min,m=g.max,_=g.range,y;(a=d==null?void 0:d.isReverse())!==null&&a!==void 0&&a?y=this._startScrollCoordinate.y-c.y:y=c.y-this._startScrollCoordinate.y;var x=y/f.height,b=_*x,I=p+b,C=m+b,E=d.convertToRealValue(I),A=d.convertToRealValue(C);d.setExtremum({min:I,max:C,range:C-I,realMin:E,realMax:A,realRange:A-E})}var F=c.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(F)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:c.x,y:c.y,paneId:l==null?void 0:l.getId()}),v}case q.X_AXIS:{var v=u.dispatchEvent("pressedMouseMoveEvent",c);if(v)this._chart.updatePane(1);else{var P=l.getAxisComponent();if(!((n=P==null?void 0:P.getScrollZoomEnabled())!==null&&n!==void 0)||n){var x=this._xAxisStartScaleDistance/c.pageX,L=(x-this._xAxisScale)*10;this._xAxisScale=x,this._chart.getChartStore().getTimeScaleStore().zoom(L,(o=this._xAxisStartScaleCoordinate)!==null&&o!==void 0?o:void 0)}}return v}case q.Y_AXIS:{var v=u.dispatchEvent("pressedMouseMoveEvent",c);if(v)this._chart.updatePane(1);else{var d=l.getAxisComponent();if(this._prevYAxisExtremum!==null&&d.getScrollZoomEnabled()){var T=this._prevYAxisExtremum,p=T.min,m=T.max,_=T.range,x=c.pageY/this._yAxisStartScaleDistance,N=_*x,b=(N-_)/2,I=p-b,C=m+b,E=d.convertToRealValue(I),A=d.convertToRealValue(C);d.setExtremum({min:I,max:C,range:N,realMin:E,realMax:A,realRange:A-E}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}}return v}}}return!1},r.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(e!==null){var a=this._makeWidgetEvent(t,e),n=e.getName();switch(n){case q.MAIN:case q.SEPARATOR:case q.X_AXIS:case q.Y_AXIS:{i=e.dispatchEvent("mouseUpEvent",a);break}}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},r.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(e!==null){var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},r.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(e!==null){var a=this._makeWidgetEvent(t,e),n=e.getName();switch(n){case q.MAIN:case q.X_AXIS:case q.Y_AXIS:{i=e.dispatchEvent("mouseRightClickEvent",a);break}}i&&this._chart.updatePane(1)}return!1},r.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,a=e.widget;if(a!==null){var n=a.getName();switch(n){case q.MAIN:{var o=this._makeWidgetEvent(t,a);return a.dispatchEvent("mouseDoubleClickEvent",o)}case q.Y_AXIS:{var s=i.getAxisComponent();if(!s.getAutoCalcTickFlag())return s.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0;break}}}return!1},r.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},r.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,a=e.widget;if(a!==null){var n=this._makeWidgetEvent(t,a),o=a.getName();switch(o){case q.MAIN:{var s=this._chart.getChartStore(),l=s.getTooltipStore();if(a.dispatchEvent("mouseDownEvent",n))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(Pe(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:n.x,y:n.y},s.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var u=n.x-this._touchCoordinate.x,c=n.y-this._touchCoordinate.y,h=Math.sqrt(u*u+c*c);h<Qn?(this._touchCoordinate={x:n.x,y:n.y},l.setCrosshair({x:n.x,y:n.y,paneId:i==null?void 0:i.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,l.setCrosshair())}return!0}case q.X_AXIS:case q.Y_AXIS:{var f=a.dispatchEvent("mouseDownEvent",n);return f&&this._chart.updatePane(1),f}}}return!1},r.prototype.touchMoveEvent=function(t){var e,i,a,n=this._findWidgetByEvent(t),o=n.pane,s=n.widget;if(s!==null){var l=this._makeWidgetEvent(t,s),u=s.getName(),c=this._chart.getChartStore(),h=c.getTooltipStore();switch(u){case q.MAIN:{if(s.dispatchEvent("pressedMouseMoveEvent",l))return(e=l.preventDefault)===null||e===void 0||e.call(l),h.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(i=l.preventDefault)===null||i===void 0||i.call(l),h.setCrosshair({x:l.x,y:l.y,paneId:o==null?void 0:o.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var f=l.x-this._startScrollCoordinate.x;c.getTimeScaleStore().scroll(f)}return!0}case q.X_AXIS:case q.Y_AXIS:{var v=s.dispatchEvent("pressedMouseMoveEvent",l);return v&&((a=l.preventDefault)===null||a===void 0||a.call(l),this._chart.updatePane(1)),v}}}return!1},r.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(i!==null){var a=this._makeWidgetEvent(t,i),n=i.getName();switch(n){case q.MAIN:{if(i.dispatchEvent("mouseUpEvent",a),this._startScrollCoordinate!==null){var o=new Date().getTime()-this._flingStartTime,s=a.x-this._startScrollCoordinate.x,l=s/(o>0?o:1)*20;if(o<200&&Math.abs(l)>0){var u=this._chart.getChartStore().getTimeScaleStore(),c=function(){e._flingScrollRequestId=Ge(function(){u.startScroll(),u.scroll(l),l=l*(1-.025),Math.abs(l)<1?e._flingScrollRequestId!==null&&(Pe(e._flingScrollRequestId),e._flingScrollRequestId=null):c()})};c()}}return!0}case q.X_AXIS:case q.Y_AXIS:{var h=i.dispatchEvent("mouseUpEvent",a);h&&this._chart.updatePane(1)}}}return!1},r.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,a=e.widget,n=!1;if(a!==null){var o=this._makeWidgetEvent(t,a),s=a.dispatchEvent("mouseClickEvent",o);if(a.getName()===q.MAIN){var l=this._makeWidgetEvent(t,a),u=this._chart.getChartStore(),c=u.getTooltipStore();s?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,c.setCrosshair(void 0,!0),n=!0):(!this._touchCancelCrosshair&&!this._touchZoomed&&(this._touchCoordinate={x:l.x,y:l.y},c.setCrosshair({x:l.x,y:l.y,paneId:i==null?void 0:i.getId()},!0),n=!0),this._touchCancelCrosshair=!1)}(n||s)&&this._chart.updatePane(1)}return n},r.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},r.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,a=e.widget;if(a!==null&&a.getName()===q.MAIN){var n=this._makeWidgetEvent(t,a);return this._touchCoordinate={x:n.x,y:n.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:n.x,y:n.y,paneId:i==null?void 0:i.getId()}),!0}return!1},r.prototype._findWidgetByEvent=function(t){var e,i,a,n,o=t.x,s=t.y,l=this._chart.getAllSeparatorPanes(),u=this._chart.getChartStore().getStyles().separator.size;try{for(var c=$t(l),h=c.next();!h.done;h=c.next()){var f=dt(h.value,2),v=f[1],d=v.getBounding(),g=d.top-Math.round((ve-u)/2);if(o>=d.left&&o<=d.left+d.width&&s>=g&&s<=g+ve)return{pane:v,widget:v.getWidget()}}}catch(F){e={error:F}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}var p=this._chart.getAllDrawPanes(),m=null;try{for(var _=$t(p),y=_.next();!y.done;y=_.next()){var x=y.value,d=x.getBounding();if(o>=d.left&&o<=d.left+d.width&&s>=d.top&&s<=d.top+d.height){m=x;break}}}catch(F){a={error:F}}finally{try{y&&!y.done&&(n=_.return)&&n.call(_)}finally{if(a)throw a.error}}var b=null;if(m!==null){if(b===null){var I=m.getMainWidget(),C=I.getBounding();o>=C.left&&o<=C.left+C.width&&s>=C.top&&s<=C.top+C.height&&(b=I)}if(b===null){var E=m.getYAxisWidget();if(E!==null){var A=E.getBounding();o>=A.left&&o<=A.left+A.width&&s>=A.top&&s<=A.top+A.height&&(b=E)}}}return{pane:m,widget:b}},r.prototype._makeWidgetEvent=function(t,e){var i,a,n,o=(i=e==null?void 0:e.getBounding())!==null&&i!==void 0?i:null;return V(V({},t),{x:t.x-((a=o==null?void 0:o.left)!==null&&a!==void 0?a:0),y:t.y-((n=o==null?void 0:o.top)!==null&&n!==void 0?n:0)})},r.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},r}(),At;(function(r){r.Root="root",r.Main="main",r.YAxis="yAxis"})(At||(At={}));var eo=function(){function r(t,e){this._drawPanes=[],this._separatorPanes=new Map,this._initContainer(t),this._chartEvent=new to(this._chartContainer,this),this._chartStore=new on(this,e),this._initPanes(e),this.adjustPaneViewport(!0,!0,!0)}return r.prototype._initContainer=function(t){this._container=t,this._chartContainer=Vt("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},r.prototype._initPanes=function(t){var e=this,i,a=(i=t==null?void 0:t.layout)!==null&&i!==void 0?i:[{type:"candle"}],n=!1,o=!1,s=function(l){if(!o){var u=e._createPane(Kn,Q.X_AXIS,l!=null?l:{});e._xAxisPane=u,o=!0}};a.forEach(function(l){var u,c,h;switch(l.type){case"candle":{if(!n){var f=(u=l.options)!==null&&u!==void 0?u:{};It(f,{id:Q.CANDLE});var v=e._createPane(Hn,Q.CANDLE,f);e._candlePane=v;var d=(c=l.content)!==null&&c!==void 0?c:[];d.forEach(function(p){e.createIndicator(p,!0,f)}),n=!0}break}case"indicator":{var d=(h=l.content)!==null&&h!==void 0?h:[];if(d.length>0){var g;d.forEach(function(m){k(g)?e.createIndicator(m,!0,{id:g}):g=e.createIndicator(m,!0,l.options)})}break}case"xAxis":s(l.options)}}),s({position:"bottom"})},r.prototype._createPane=function(t,e,i){var a,n,o=i==null?void 0:i.position;switch(o){case"top":{var s=this._drawPanes[0];k(s)&&(n=new t(this._chartContainer,s.getContainer(),this,e),a=0);break}case"bottom":break;default:for(var l=this._drawPanes.length-1;l>-1;l--){var u=this._drawPanes[l],c=this._drawPanes[l-1];(u==null?void 0:u.getOptions().position)==="bottom"&&(c==null?void 0:c.getOptions().position)!=="bottom"&&(n=new t(this._chartContainer,u.getContainer(),this,e),a=l)}}k(n)||(n=new t(this._chartContainer,null,this,e)),n.setOptions(i!=null?i:{});var h;if(k(a)?(this._drawPanes.splice(a,0,n),h=a):(this._drawPanes.push(n),h=this._drawPanes.length-1),n.getId()!==Q.X_AXIS){var f=this._drawPanes[h+1];if(k(f)&&f.getId()===Q.X_AXIS&&(f=this._drawPanes[h+2]),k(f)){var v=this._separatorPanes.get(f);k(v)?v.setTopPane(n):(v=new pr(this._chartContainer,f.getContainer(),this,"",n,f),this._separatorPanes.set(f,v))}var d=this._drawPanes[h-1];if(k(d)&&d.getId()===Q.X_AXIS&&(d=this._drawPanes[h-2]),k(d)){var v=new pr(this._chartContainer,n.getContainer(),this,"",d,n);this._separatorPanes.set(n,v)}}return n},r.prototype._measurePaneHeight=function(){var t=this,e,i=this._container.offsetHeight,a=this._chartStore.getStyles().separator.size,n=this._xAxisPane.getAxisComponent().getAutoSize(),o=i-n-this._separatorPanes.size*a;o<0&&(o=0);var s=0;this._drawPanes.forEach(function(c){if(c.getId()!==Q.CANDLE&&c.getId()!==Q.X_AXIS){var h=c.getBounding().height,f=c.getOptions().minHeight;h<f&&(h=f),s+h>o?(s=o,h=Math.max(o-s,0)):s+=h,c.setBounding({height:h})}});var l=o-s;(e=this._candlePane)===null||e===void 0||e.setBounding({height:l}),this._xAxisPane.setBounding({height:n});var u=0;this._drawPanes.forEach(function(c){var h=t._separatorPanes.get(c);k(h)&&(h.setBounding({height:a,top:u}),u+=a),c.setBounding({top:u}),u+=c.getBounding().height})},r.prototype._measurePaneWidth=function(){var t=this,e=this._chartStore.getStyles(),i=e.yAxis,a=i.position===jt.Left,n=!i.inside,o=this._container.offsetWidth,s=0,l=Number.MIN_SAFE_INTEGER,u=0,c=0;this._drawPanes.forEach(function(p){p.getId()!==Q.X_AXIS&&(l=Math.max(l,p.getAxisComponent().getAutoSize()))}),l>o&&(l=o),n?(s=o-l,a?(u=0,c=l):(u=o-l,c=0)):(s=o,c=0,a?u=0:u=o-l),this._chartStore.getTimeScaleStore().setTotalBarSpace(s);var h={width:o},f={width:s,left:c},v={width:l,left:u},d=e.separator.fill,g;n&&!d?g=f:g=h,this._drawPanes.forEach(function(p){var m;(m=t._separatorPanes.get(p))===null||m===void 0||m.setBounding(g),p.setBounding(h,f,v)})},r.prototype._setPaneOptions=function(t,e){var i;if(j(t.id)){var a=this.getDrawPaneById(t.id),n=!1;if(a!==null){var o=e;if(t.id!==Q.CANDLE&&X(t.height)&&t.height>0){var s=Math.max((i=t.minHeight)!==null&&i!==void 0?i:a.getOptions().minHeight,0),l=Math.max(s,t.height);a.setBounding({height:l}),o=!0,n=!0}a.setOptions(t),o&&this.adjustPaneViewport(n,!0,!0,!0,!0)}}},r.prototype.getDrawPaneById=function(t){if(t===Q.CANDLE)return this._candlePane;if(t===Q.X_AXIS)return this._xAxisPane;var e=this._drawPanes.find(function(i){return i.getId()===t});return e!=null?e:null},r.prototype.getContainer=function(){return this._container},r.prototype.getChartStore=function(){return this._chartStore},r.prototype.getCandlePane=function(){return this._candlePane},r.prototype.getXAxisPane=function(){return this._xAxisPane},r.prototype.getAllDrawPanes=function(){return this._drawPanes},r.prototype.getAllSeparatorPanes=function(){return this._separatorPanes},r.prototype.adjustPaneViewport=function(t,e,i,a,n){t&&this._measurePaneHeight();var o=e,s=a!=null?a:!1,l=n!=null?n:!1;(s||l)&&this._drawPanes.forEach(function(u){var c=u.getAxisComponent().buildTicks(l);o||(o=c)}),o&&this._measurePaneWidth(),i!=null&&i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},r.prototype.updatePane=function(t,e){if(k(e)){var i=this.getDrawPaneById(e);i==null||i.update(t)}else this._separatorPanes.forEach(function(a){a.update(t)}),this._drawPanes.forEach(function(a){a.update(t)})},r.prototype.crosshairChange=function(t){var e=this,i=this._chartStore.getActionStore();if(i.has(Tt.OnCrosshairChange)){var a={};this._drawPanes.forEach(function(n){var o=n.getId(),s={},l=e._chartStore.getIndicatorStore().getInstances(o);l.forEach(function(u){var c,h=u.result;s[u.name]=h[(c=t.dataIndex)!==null&&c!==void 0?c:h.length-1]}),a[o]=s}),j(t.paneId)&&i.execute(Tt.OnCrosshairChange,V(V({},t),{indicatorData:a}))}},r.prototype.getDom=function(t,e){var i,a;if(j(t)){var n=this.getDrawPaneById(t);if(n!==null){var o=e!=null?e:At.Root;switch(o){case At.Root:return n.getContainer();case At.Main:return n.getMainWidget().getContainer();case At.YAxis:return(a=(i=n.getYAxisWidget())===null||i===void 0?void 0:i.getContainer())!==null&&a!==void 0?a:null}}}else return this._chartContainer;return null},r.prototype.getSize=function(t,e){var i,a;if(k(t)){var n=this.getDrawPaneById(t);if(n!==null){var o=e!=null?e:At.Root;switch(o){case At.Root:return n.getBounding();case At.Main:return n.getMainWidget().getBounding();case At.YAxis:return(a=(i=n.getYAxisWidget())===null||i===void 0?void 0:i.getBounding())!==null&&a!==void 0?a:null}}}else return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};return null},r.prototype.setStyles=function(t){var e,i;this._chartStore.setOptions({styles:t});var a;j(t)?a=Fr(t):a=t,k((e=a==null?void 0:a.yAxis)===null||e===void 0?void 0:e.type)&&((i=this._candlePane)===null||i===void 0||i.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},r.prototype.getStyles=function(){return this._chartStore.getStyles()},r.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},r.prototype.getLocale=function(){return this._chartStore.getLocale()},r.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},r.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},r.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},r.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},r.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},r.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},r.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},r.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetLeftDistance(t)},r.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetRightDistance(t)},r.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},r.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},r.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},r.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},r.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},r.prototype.clearData=function(){this._chartStore.clear()},r.prototype.getDataList=function(){return this._chartStore.getDataList()},r.prototype.applyNewData=function(t,e,i){this._chartStore.clear(),t.length===0?this.adjustPaneViewport(!1,!0,!0,!0):this.applyMoreData(t,e,i)},r.prototype.applyMoreData=function(t,e,i){var a=this;this._chartStore.addData(t,0,e),t.length>0&&this._chartStore.getIndicatorStore().calcInstance().then(function(n){a.adjustPaneViewport(!1,!0,!0,!0),i==null||i()}).catch(function(n){})},r.prototype.updateData=function(t,e){var i=this,a=this._chartStore.getDataList(),n=a.length,o=t.timestamp,s=rt(a[n-1],"timestamp",0);if(o>=s){var l=n;o===s&&(l=n-1),this._chartStore.addData(t,l),this._chartStore.getIndicatorStore().calcInstance().then(function(u){i.adjustPaneViewport(!1,!0,!0,!0),e==null||e()}).catch(function(u){})}},r.prototype.loadMore=function(t){this._chartStore.getTimeScaleStore().setLoadMoreCallback(t)},r.prototype.createIndicator=function(t,e,i,a){var n=this,o,s=j(t)?{name:t}:t;if(Tr(s.name)===null)return null;var l=i==null?void 0:i.id,u=this.getDrawPaneById(l!=null?l:"");if(u!==null)this._chartStore.getIndicatorStore().addInstance(s,l!=null?l:"",e!=null?e:!1).then(function(f){var v;n._setPaneOptions(i!=null?i:{},(v=u.getAxisComponent().buildTicks(!0))!==null&&v!==void 0?v:!1)}).catch(function(f){});else{l!=null||(l=Er(Q.INDICATOR));var c=this._createPane(Kr,l,i!=null?i:{}),h=(o=i==null?void 0:i.height)!==null&&o!==void 0?o:$a;c.setBounding({height:h}),this._chartStore.getIndicatorStore().addInstance(s,l,e!=null?e:!1).finally(function(){n.adjustPaneViewport(!0,!0,!0,!0,!0),a==null||a()})}return l!=null?l:null},r.prototype.overrideIndicator=function(t,e,i){var a=this;this._chartStore.getIndicatorStore().override(t,e!=null?e:null).then(function(n){var o=dt(n,2),s=o[0],l=o[1];(s||l)&&(a.adjustPaneViewport(!1,l,!0,l),i==null||i())}).catch(function(){})},r.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},r.prototype.removeIndicator=function(t,e){var i,a,n,o=this._chartStore.getIndicatorStore(),s=o.removeInstance(t,e);if(s){var l=!1;if(t!==Q.CANDLE&&!o.hasInstances(t)){var u=this.getDrawPaneById(t),c=this._drawPanes.findIndex(function(m){return m.getId()===t});if(u!==null){l=!0;var h=this._separatorPanes.get(u);if(k(h)){var f=h==null?void 0:h.getTopPane();try{for(var v=$t(this._separatorPanes),d=v.next();!d.done;d=v.next()){var g=d.value;if(g[1].getTopPane().getId()===u.getId()){g[1].setTopPane(f);break}}}catch(m){i={error:m}}finally{try{d&&!d.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}h.destroy(),this._separatorPanes.delete(u)}this._drawPanes.splice(c,1),u.destroy();var p=this._drawPanes[0];k(p)&&p.getId()===Q.X_AXIS&&(p=this._drawPanes[1]),(n=this._separatorPanes.get(p))===null||n===void 0||n.destroy(),this._separatorPanes.delete(p)}}this.adjustPaneViewport(l,!0,!0,!0,!0)}},r.prototype.createOverlay=function(t,e){var i=[];if(j(t))i=[{name:t}];else if(Lt(t))i=t.map(function(s){return j(s)?{name:s}:s});else{var a=t;i=[a]}var n=!0;(!k(e)||this.getDrawPaneById(e)===null)&&(e=Q.CANDLE,n=!1);var o=this._chartStore.getOverlayStore().addInstances(i,e,n);return Lt(t)?o:o[0]},r.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},r.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},r.prototype.removeOverlay=function(t){var e;k(t)&&(j(t)?e={id:t}:e=t),this._chartStore.getOverlayStore().removeInstance(e)},r.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},r.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},r.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},r.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},r.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},r.prototype.scrollByDistance=function(t,e){var i=X(e)&&e>0?e:0,a=this._chartStore.getTimeScaleStore();if(i>0){a.startScroll();var n=new Date().getTime(),o=function(){var s=(new Date().getTime()-n)/i,l=s>=1,u=l?t:t*s;a.scroll(u),l||requestAnimationFrame(o)};o()}else a.startScroll(),a.scroll(t)},r.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),i=e.getBarSpace().bar,a=e.getLastBarRightSideDiffBarCount()-e.getInitialOffsetRightDistance()/i,n=a*i;this.scrollByDistance(n,t)},r.prototype.scrollToDataIndex=function(t,e){var i=this._chartStore.getTimeScaleStore(),a=(i.getLastBarRightSideDiffBarCount()+(this.getDataList().length-1-t))*i.getBarSpace().bar;this.scrollByDistance(a,e)},r.prototype.scrollToTimestamp=function(t,e){var i=je(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},r.prototype.zoomAtCoordinate=function(t,e,i){var a=X(i)&&i>0?i:0,n=this._chartStore.getTimeScaleStore();if(a>0){var o=n.getBarSpace().bar,s=o*t,l=s-o,u=new Date().getTime(),c=function(){var h=(new Date().getTime()-u)/a,f=h>=1,v=f?l:l*h;n.zoom(v/o,e),f||requestAnimationFrame(c)};c()}else n.zoom(t,e)},r.prototype.zoomAtDataIndex=function(t,e,i){var a=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:a,y:0},i)},r.prototype.zoomAtTimestamp=function(t,e,i){var a=je(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,a,i)},r.prototype.convertToPixel=function(t,e){var i,a=e.paneId,n=a===void 0?Q.CANDLE:a,o=e.absolute,s=o===void 0?!1:o,l=[];if(n!==Q.X_AXIS){var u=this.getDrawPaneById(n);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),f=new Array().concat(t),v=this._xAxisPane.getAxisComponent(),d=u.getAxisComponent();l=f.map(function(g){var p={},m=g.dataIndex;if(X(g.timestamp)&&(m=c.timestampToDataIndex(g.timestamp)),X(m)&&(p.x=v==null?void 0:v.convertToPixel(m)),X(g.value)){var _=d==null?void 0:d.convertToPixel(g.value);p.y=s?h.top+_:_}return p})}}return Lt(t)?l:(i=l[0])!==null&&i!==void 0?i:{}},r.prototype.convertFromPixel=function(t,e){var i,a=e.paneId,n=a===void 0?Q.CANDLE:a,o=e.absolute,s=o===void 0?!1:o,l=[];if(n!==Q.X_AXIS){var u=this.getDrawPaneById(n);if(u!==null){var c=this._chartStore.getTimeScaleStore(),h=u.getBounding(),f=new Array().concat(t),v=this._xAxisPane.getAxisComponent(),d=u.getAxisComponent();l=f.map(function(g){var p,m,_={};if(X(g.x)){var y=(p=v==null?void 0:v.convertFromPixel(g.x))!==null&&p!==void 0?p:-1;_.dataIndex=y,_.timestamp=(m=c.dataIndexToTimestamp(y))!==null&&m!==void 0?m:void 0}if(X(g.y)){var x=s?g.y-h.top:g.y;_.value=d.convertFromPixel(x)}return _})}}return Lt(t)?l:(i=l[0])!==null&&i!==void 0?i:{}},r.prototype.executeAction=function(t,e){var i;switch(t){case Tt.OnCrosshairChange:{var a=V({},e);a.paneId=(i=a.paneId)!==null&&i!==void 0?i:Q.CANDLE,this._chartStore.getTooltipStore().setCrosshair(a);break}}},r.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},r.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},r.prototype.getConvertPictureUrl=function(t,e,i){var a=this,n=this._chartContainer.offsetWidth,o=this._chartContainer.offsetHeight,s=Vt("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),l=s.getContext("2d"),u=ne(s);s.width=n*u,s.height=o*u,l.scale(u,u),l.fillStyle=i!=null?i:"#FFFFFF",l.fillRect(0,0,n,o);var c=t!=null?t:!1;return this._drawPanes.forEach(function(h){var f=a._separatorPanes.get(h);if(k(f)){var v=f.getBounding();l.drawImage(f.getImage(c),v.left,v.top,v.width,v.height)}var d=h.getBounding();l.drawImage(h.getImage(c),0,d.top,n,d.height)}),s.toDataURL("image/".concat(e!=null?e:"jpeg"))},r.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},r.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach(function(t){t.destroy()}),this._drawPanes=[],this._container.removeChild(this._chartContainer)},r}(),mr=new Map,ro=1;function io(r,t){var e;if(j(r)?e=document.getElementById(r):e=r,e===null)return null;var i=mr.get(e.id);if(k(i))return i;var a="k_line_chart_".concat(ro++);return i=new eo(e,t),i.id=a,e.setAttribute("k-line-chart-id",a),mr.set(a,i),i}const ao=ii({__name:"index",props:{symbol:{type:String,default:"BTC-USD"}},setup(r){var x;const t=r,e=ct(),i=ct(t.symbol),a=(x=Sr())==null?void 0:x.appContext.config.globalProperties.$wsUrl;let n=Xe({url:a,success:()=>{console.log("连接成功")}});const o=ct("1M"),s=ct(),l=ct(!1),u=ct(!1);ai(()=>{n.close()});function c(b){if(!u.value){const I=JSON.parse(b),C={timestamp:I.id*1e3,open:I.open,close:I.close,high:I.high,low:I.low,volume:I.vol};s.value.updateData(C)}}function h(b){return{type:"kline",symbol:i.value,time:b,language:"en_US"}}function f(){n.send({data:JSON.stringify(h(o.value))})}n.onOpen(()=>{f(),_()}),n.onMessage(b=>{l.value=!1,c(b.data)});function v(){Yt.get("/market/kline",{symbol:i.value,time:o.value,num:300}).then(b=>{const I=b.data.map(C=>({timestamp:C.id*1e3,open:C.open,close:C.close,high:C.high,low:C.low,volume:C.volume}));console.log("添加到图表的数据",I),console.log(s.value),s.value.applyNewData(I)})}function d(){l.value=!0,s.value=io("chartContainer",{styles:{candle:{tooltip:{showRule:"none"}},grid:{horizontal:{show:!1},vertical:{show:!1}}}}),s.value.setPriceVolumePrecision(6,6)}ni(async()=>{await d(),v()});const g=ct(0),p=oi([{name:"1M",value:"1M"},{name:"5M",value:"5M"},{name:"15M",value:"15M"},{name:"30M",value:"30M"},{name:"1H",value:"1H"},{name:"1D",value:"D"}]);function m(){n.send({data:JSON.stringify({type:"heartbeat",msg:"ping"})})}function _(){n!=null&&(m(),setTimeout(()=>{_()},3e3))}function y(b){n.close(),l.value=!0;const{name:I}=b;p.forEach((C,E)=>{C.name===I&&(g.value=E,o.value=C.value)}),n=Xe({url:a,success:()=>{console.log("连接成功")}}),n.onOpen(()=>{f(),_()}),n.onMessage(C=>{l.value=!1,c(C.data)}),v(),n.send({data:JSON.stringify(h(o.value))}),console.log(o.value)}return(b,I)=>{const C=br,E=Te;return ot(),gt(E,{class:"bg-white my-[40px]"},{default:w(()=>[S(E,{class:"flex items-center justify-between"},{default:w(()=>[(ot(!0),Se(be,null,xr(p,(A,F)=>(ot(),gt(C,{key:F,class:pt([F===g.value?"text-white bg-black":"","flex items-center justify-center w-[80px] h-[42px] text-[24px] bg-[#f5f7f9] rounded-[20px] transition-all"]),onClick:P=>y(A)},{default:w(()=>[W(O(A.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),Pt('        <view v-show="loading"> '),Pt('            <view class="market-skeleton relative h-[500px] mt-[20px]"> '),Pt('                <FuiSkeleton :preload-list="charts.market3" outer-class="market-skeleton"></FuiSkeleton> '),Pt("            </view> "),Pt("        </view> "),S(E,{class:"w-full h-[500px] relative"},{default:w(()=>[S(E,{id:"chartContainer",ref_key:"chartContainer",ref:e,class:"w-full h-full mt-[20px]"},null,512)]),_:1})]),_:1})}}});const no={name:"fui-input-number",emits:["change","update:modelValue","input","blur"],props:{modelValue:{type:[Number,String],default:1},type:{type:String,default:"number"},min:{type:Number,default:1},max:{type:Number,default:99},step:{type:Number,default:1},disabled:{type:Boolean,default:!1},signWidth:{type:[Number,String],default:24},signColor:{type:String,default:"#181818"},height:{type:[Number,String],default:40},width:{type:[Number,String],default:80},radius:{type:[Number,String],default:8},size:{type:Number,default:26},backgroundColor:{type:String,default:"#EEEEEE"},color:{type:String,default:"#181818"},margin:{type:[Number,String],default:16},custom:{type:Boolean,default:!1},index:{type:[Number,String],default:0},params:{type:[Number,String],default:0}},created(){this.inputValue=this.getValue(this.modelValue)},computed:{getMinHeight(){return Number(this.height)-8+"rpx"}},data(){return{inputValue:0,oldValue:0,isNvue:!1}},watch:{modelValue(r){this.inputValue=this.getValue(r)},inputValue(r,t){if(!isNaN(Number(r))&&Number(r)!==Number(t)){const e=this.getValue(+r);this.oldValue=e,this.$emit("change",{value:e,index:this.index,params:this.params}),this.$emit("input",e),this.$emit("update:modelValue",+e)}}},methods:{getScale(r,t){let e=1,i=1;return Number.isInteger(t)||(e=Math.pow(10,(t+"").split(".")[1].length)),Number.isInteger(r)||(i=Math.pow(10,(r+"").split(".")[1].length)),Math.max(e,i)},getValue(r){return r=Number(r),r<this.min?r=this.min:r>this.max&&(r=this.max),r},calcNum:function(r){if(this.disabled||this.inputValue==this.min&&r==="reduce"||this.inputValue==this.max&&r==="plus")return;const t=this.getScale(Number(this.inputValue),Number(this.step));let e=Number(this.inputValue)*t,i=this.step*t;r==="reduce"?e-=i:r==="plus"&&(e+=i);let a=Number((e/t).toFixed(String(t).length-1));a<this.min?a=this.min:a>this.max&&(a=this.max),this.inputValue=String(a)},plus:function(){this.calcNum("plus")},minus:function(){this.calcNum("reduce")},blur:function(r){let t=r.detail.value;t&&!isNaN(Number(t))?(~t.indexOf(".")&&Number.isInteger(this.step)&&Number.isInteger(Number(t))&&(t=t.split(".")[0]),t=this.getValue(t)):t=this.oldValue,setTimeout(()=>{r.detail.value=t,this.$emit("blur",r),this.inputValue=t},this.type==="text"?100:0)}}};function oo(r,t,e,i,a,n){const o=Te,s=Cr;return ot(),gt(o,{class:"fui-input__number"},{default:w(()=>[S(o,{class:pt([[e.disabled||e.min>=a.inputValue?"fui-number__disabled":""],"fui-number__minus"]),style:kt({minHeight:n.getMinHeight}),onClick:n.minus},{default:w(()=>[e.custom?Pt("v-if",!0):(ot(),gt(o,{key:0,style:kt({backgroundColor:e.signColor,width:e.signWidth+"rpx"}),class:"fui-minus__sign"},null,8,["style"])),or(r.$slots,"default",{},void 0,!0)]),_:3},8,["class","style","onClick"]),S(s,{modelValue:a.inputValue,"onUpdate:modelValue":t[0]||(t[0]=l=>a.inputValue=l),disabled:e.disabled,style:kt({color:e.color,fontSize:e.size+"rpx",backgroundColor:e.backgroundColor,height:e.height+"rpx",minHeight:e.height+"rpx",width:e.width+"rpx",borderRadius:e.radius+"rpx",marginLeft:e.margin+"rpx",marginRight:e.margin+"rpx"}),type:e.type,class:"fui-number__input",onBlur:n.blur},null,8,["modelValue","disabled","style","type","onBlur"]),S(o,{class:pt([[e.disabled||a.inputValue>=e.max?"fui-number__disabled":""],"fui-number__plus"]),style:kt({minWidth:e.signWidth+"rpx",minHeight:e.signWidth+"rpx"}),onClick:n.plus},{default:w(()=>[e.custom?Pt("v-if",!0):(ot(),gt(o,{key:0,style:kt({height:e.signWidth+"rpx",backgroundColor:e.signColor,left:a.isNvue?e.signWidth/2+"rpx":"50%"}),class:"fui-plus__sign-col"},null,8,["style"])),e.custom?Pt("v-if",!0):(ot(),gt(o,{key:1,style:kt({width:e.signWidth+"rpx",backgroundColor:e.signColor}),class:"fui-plus__sign-row"},null,8,["style"])),or(r.$slots,"plus",{},void 0,!0)]),_:3},8,["class","style","onClick"])]),_:3})}const xe=Ue(no,[["render",oo],["__scopeId","data-v-847473a0"]]);const so={name:"fui-switch",emits:["change"],behaviors:["uni://form-field"],props:{name:{type:String,default:""},checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},type:{type:String,default:"switch"},color:{type:String,default:""},borderColor:{type:String,default:"#ccc"},checkMarkColor:{type:String,default:"#fff"},scaleRatio:{type:[Number,String],default:1}},computed:{getColor(){return this.color}},data(){return{val:!1,isNvue:!1,isLabel:!1}},watch:{checked(r){this.val=r}},created(){this.val=this.checked,this.label=this.getParent(),this.label&&(this.isLabel=!0,this.label.childrens.push(this))},methods:{change(r,t){this.label&&!t||(this.val=r.detail.value,this.$emit("change",r))},labelClick(){if(this.disabled)return;let r={detail:{value:!this.val}};this.change(r,!0)},getParent(r="fui-label"){let t=this.$parent,e=t.$options.name;for(;e!==r;){if(t=t.$parent,!t)return!1;e=t.$options.name}return t}}};function lo(r,t,e,i,a,n){const o=si,s=Te;return ot(),gt(s,{style:kt({zoom:a.isNvue?1:e.scaleRatio,transform:`scale(${a.isNvue?e.scaleRatio:1})`}),class:"fui-switch__input"},{default:w(()=>[e.type==="switch"?(ot(),gt(s,{key:0,class:pt([{"fui-switch__input--checked":a.val,"fui-checkbox__disabled":e.disabled,"fui-switch__color":a.val&&!e.color},"fui-switch__input-def"]),style:kt({background:a.val?e.color:"#dfdfdf",borderColor:a.val?e.color:e.borderColor})},{default:w(()=>[S(o,{checked:a.val,class:pt([{"fui-pointer__events":a.isLabel},"fui-switch__hidden"]),color:e.color,disabled:e.disabled,name:e.name,onChange:n.change},null,8,["checked","class","color","disabled","name","onChange"])]),_:1},8,["class","style"])):(ot(),gt(s,{key:1,class:pt([{"fui-checkbox__disabled":e.disabled,"fui-switch__color":!n.getColor&&a.val},"fui-checkbox__self"]),style:kt({background:a.val?n.getColor:"#fff",border:a.val?`1px solid ${n.getColor}`:`1px solid ${e.borderColor}`})},{default:w(()=>[a.val?(ot(),gt(s,{key:0,style:kt({borderBottomColor:e.checkMarkColor,borderRightColor:e.checkMarkColor}),class:"fui-check__mark"},null,8,["style"])):Pt("v-if",!0),S(o,{checked:a.val,class:pt([{"fui-pointer__events":a.isLabel},"fui-switch__hidden"]),disabled:e.disabled,name:e.name,style:{opacity:"0",position:"absolute"},type:"checkbox",onChange:n.change},null,8,["checked","class","disabled","name","onChange"])]),_:1},8,["class","style"]))]),_:1},8,["style"])}const _r=Ue(so,[["render",lo],["__scopeId","data-v-8f1f62b3"]]),yr={market:Ve([{left:10,top:15,bottom:220,width:45,height:45,type:"round"},{left:60,right:365,top:12,bottom:220,width:90,height:19,type:"rect"},{left:60,right:365,top:40,bottom:220,width:55,height:19,type:"rect"},{left:300,right:365,top:15,bottom:220,width:80,height:40,type:"rect"}]),market2:Ve([{left:18,top:15,bottom:220,width:36,height:20,type:"rect"},{left:18,top:40,bottom:220,width:70,height:16,type:"rect"},{left:176,top:15,bottom:220,width:36,height:20,type:"rect"},{left:176,top:40,bottom:220,width:70,height:16,type:"rect"},{left:18,top:75,bottom:220,width:36,height:20,type:"rect"},{left:18,top:100,bottom:220,width:70,height:16,type:"rect"},{left:176,top:75,bottom:220,width:46,height:20,type:"rect"},{left:176,top:100,bottom:220,width:70,height:16,type:"rect"}]),market3:Ve([{left:0,right:0,top:0,bottom:0,width:390,height:287,type:"rect"}])};const uo={__name:"chart",setup(r){var tt;const{t}=li(),e=ui(),i=ct(!1),a=(tt=Sr())==null?void 0:tt.appContext.config.globalProperties.$wsUrl,n=ct(""),o=ct(0);function s(){return[{name:t("position.chart.Contract")},{name:t("position.chart.Option")}]}function l(){Yt.back()}const u=ct({}),c=Xe({url:a,complete:()=>{console.log("connect success")}}),h=ct(!1),f=ct(!1),v=ct({type:0,order_price:0,stop_surplus:0,disabled_stop_surplus:!0,stop_loss:0,disabled_stop_loss:!0,quantity:.01,lever:100,order_type:0}),d=ct({buy:44161.7,close:44161.7,high:44729.58,increase:3.362,low:42591.09,sell:44161.71,symbol:"BTC",vol:47721.01,logo:"/storage/products/YmyrGa7VLHM7JRNGge9txSjzYfrAxMBcddquuqu0.png",name:"BTCUSD",open_status:!0,t:1704408551});function g(R){console.log(R),v.value.order_price=R.value}function p(R){console.log(R),v.value.stop_surplus=R.value}function m(R){console.log(R),v.value.stop_surplus=d.value.close,v.value.disabled_stop_surplus=!R.detail.value}function _(R){console.log(R),v.value.stop_loss=R.value}function y(R){v.value.stop_loss=d.value.close,v.value.disabled_stop_loss=!R.detail.value}function x(R){console.log(R),v.value.quantity=R.value}function b(){console.log(v.value),Yt.post("/market/contract_order",{symbol:n.value,order_type:v.value.order_type,order_price:v.value.order_price,stop_surplus:v.value.stop_surplus,stop_loss:v.value.stop_loss,quantity:v.value.quantity,lever:v.value.lever}).then(R=>{Be({title:R.message,icon:"none"}),R.code===1&&setTimeout(()=>{sr({url:"/pages/tabbar/position"})},1e3)})}function I(R){return{symbol:R,type:"price",language:"en_US"}}function C(R){const z=JSON.parse(R);z.ping?c.send({data:JSON.stringify({pong:z.ping})}):d.value=z[0]}function E(){c.send({data:JSON.stringify({type:"heartbeat",msg:"ping"})})}function A(){c!=null&&(E(),setTimeout(()=>{A()},3e3))}function F(){c.send({data:JSON.stringify(I(n.value))})}c.onMessage(function(R){i.value=!1,C(R.data)}),c.onOpen(function(){F(),A()});function P(){Yt.post("/market/like",{id:u.value.id}).then(R=>{R.data.logo=Yt.staticUrl(R.data.logo),u.value=R.data,Be({title:R.message,icon:"none"})})}const L=ct([]),T=ct({symbol:"",type:0,time_id:0,time:{},quantity:0});function N(R){o.value===0?(v.value.order_type=R,h.value=!0):(T.value.type=R,f.value=!0)}function U(R){T.value.time_id=R.id,T.value.time=R,T.value.quantity=R.min_amount}function Y(){Yt.post("/market/option_order",{symbol:n.value,type:T.value.type,time_id:T.value.time_id,quantity:T.value.quantity}).then(R=>{Be({title:R.message,icon:"none"}),R.code===1&&setTimeout(()=>{sr({url:"/pages/tabbar/position"})},1e3)})}function ft(){Yt.get(`/market/info?symbol=${n.value}`).then(R=>{R.data.logo=Yt.staticUrl(R.data.logo),u.value=R.data}),Yt.get("/market/option/setting").then(R=>{console.log(R),L.value=R.data,T.value.time_id=R.data[0].id,T.value.time=R.data[0],T.value.quantity=R.data[0].min_amount})}return ci(async R=>{console.log(R);const{pair:z}=R;n.value=z,await ft()}),(R,z)=>{const G=vi(fi("page-meta"),yi),M=Te,K=pi,B=br,et=Cr,it=gi;return ot(),Se(be,null,[S(G),hi("div",{class:"init-top"}),S(it,{"class-name":"IndexRouter"},{default:w(()=>[S(mi,{custom:""},{default:w(()=>[S(M,{class:"flex justify-center relative items-center flex-1"},{default:w(()=>[S(M,{class:"absolute left-0"},{default:w(()=>[S(_i,{name:"arrowleft",onClick:l})]),_:1}),S(M,{class:"absolute right-[16px]",onClick:P},{default:w(()=>[S(K,{src:D(u).is_like?"/static/images/icon-star.png":"/static/images/icon-un-star.png",class:"w-[40px] h-[40px]"},null,8,["src"])]),_:1}),S(Si,{modelValue:D(o),"onUpdate:modelValue":z[0]||(z[0]=H=>di(o)?o.value=H:null),list:s(),"active-color":"white","button-color":"#3640f0",class:"w-[350px]",rounded:""},null,8,["modelValue","list"])]),_:1})]),_:1}),S(M,{class:"px-[34px] mt-[20px]"},{default:w(()=>[D(u).full_name?(ot(),gt(M,{key:0,class:"flex items-center justify-between py-[25px] px-[20px] rounded-[30px] bg-[#f5f7f9]"},{default:w(()=>[S(M,{class:"flex items-center"},{default:w(()=>[S(K,{src:D(u).logo,class:"w-[72px] h-[72px] rounded-full"},null,8,["src"]),S(M,{class:"flex flex-col ml-[15px] text-[30px]"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(u).full_name),1)]),_:1}),S(B,null,{default:w(()=>[W(O(D(d).close),1)]),_:1})]),_:1})]),_:1}),S(B,{class:pt([D(d).increase>0?"green-block":"red-block","rate-wrap py-[14px] text-[26px] text-center text-white rounded-[28px] px-[28px] green-block"])},{default:w(()=>[W(O(D(d).increase),1)]),_:1},8,["class"])]),_:1})):(ot(),gt(M,{key:1},{default:w(()=>[S(M,{class:"market-skeleton relative h-[124px]"},{default:w(()=>[S(lr,{preloadList:D(yr).market,outerClass:"market-skeleton"},null,8,["preloadList"])]),_:1})]),_:1})),Pt(" TODO APP中使用webview实现 "),S(ao,{symbol:D(n)},null,8,["symbol"]),S(M,{class:"statistics mt-[29px] mx-[34px]"},{default:w(()=>[S(B,{class:"text-[30px]"},{default:w(()=>[W(O(D(t)("position.chart.Statistics")),1)]),_:1}),D(u).full_name?(ot(),gt(M,{key:0,class:"flex items-center justify-between mt-[29px] px-[34px] py-[38px] bg-[#f5f7f9] rounded-[30px]"},{default:w(()=>[S(M,{class:"flex-1"},{default:w(()=>[S(M,null,{default:w(()=>[S(M,{class:"flex items-center"},{default:w(()=>[S(K,{class:"w-[20px] h-[20px] mr-[10px]",src:bi}),S(B,{class:"text-[26px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.Open")),1)]),_:1})]),_:1}),S(B,{class:"text-[30px] leading-[52px]"},{default:w(()=>[W(O(D(d).buy),1)]),_:1})]),_:1}),S(M,{class:"mt-[20px]"},{default:w(()=>[S(M,{class:"flex items-center"},{default:w(()=>[S(K,{class:"w-[20px] h-[20px] mr-[10px]",src:Ci}),S(B,{class:"text-[26px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.Low")),1)]),_:1})]),_:1}),S(B,{class:"text-[30px] leading-[52px]"},{default:w(()=>[W(O(D(d).low),1)]),_:1})]),_:1})]),_:1}),S(M,{class:"flex-1"},{default:w(()=>[S(M,null,{default:w(()=>[S(M,{class:"flex items-center"},{default:w(()=>[S(K,{class:"w-[20px] h-[20px] mr-[10px]",src:wi}),S(B,{class:"text-[26px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.High")),1)]),_:1})]),_:1}),S(B,{class:"text-[30px] leading-[52px]"},{default:w(()=>[W(O(D(d).high),1)]),_:1})]),_:1}),S(M,{class:"mt-[20px]"},{default:w(()=>[S(M,{class:"flex items-center"},{default:w(()=>[S(K,{class:"w-[20px] h-[20px] mr-[10px]",src:Ii}),S(B,{class:"text-[26px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.volume")),1)]),_:1})]),_:1}),S(B,{class:"text-[30px] leading-[52px]"},{default:w(()=>[W(O(D(d).vol),1)]),_:1})]),_:1})]),_:1})]),_:1})):(ot(),Se(be,{key:1},[Pt(" 统计 "),S(M,null,{default:w(()=>[S(M,{class:"market-skeleton relative h-[240px]"},{default:w(()=>[S(lr,{preloadList:D(yr).market2,outerClass:"market-skeleton"},null,8,["preloadList"])]),_:1})]),_:1})],2112))]),_:1})]),_:1}),S(M,{class:"btn-wrap flex items-center justify-around font-bold py-[20px] bg-white"},{default:w(()=>[S(M,{class:"btn font-bold btn-0",onClick:z[1]||(z[1]=H=>N(0))},{default:w(()=>[W(O(D(t)("position.chart.Sell")),1)]),_:1}),S(M,{class:"btn font-bold btn-1",onClick:z[2]||(z[2]=H=>N(1))},{default:w(()=>[W(O(D(t)("position.chart.Buy")),1)]),_:1})]),_:1}),Re(S(M,{class:"order-wrap"},{default:w(()=>[S(M,{class:"place"},{default:w(()=>[S(M,{class:"order-type flex justify-between font-bold"},{default:w(()=>[S(M,{class:"flex items-center justify-between"},{default:w(()=>[S(M,{class:pt([D(v).type===0?"active":"","item grid place-items-center transition-all"]),onClick:z[3]||(z[3]=H=>D(v).type=0)},{default:w(()=>[W(O(D(t)("position.chart.MarketPrice")),1)]),_:1},8,["class"]),S(M,{class:pt([D(v).type===1?"active":"","item grid place-items-center transition-all"]),onClick:z[4]||(z[4]=H=>D(v).type=1)},{default:w(()=>[W(O(D(t)("position.chart.Order")),1)]),_:1},8,["class"])]),_:1}),S(K,{class:"w-[48px] h-[48px]",src:Ei,onClick:z[5]||(z[5]=H=>h.value=!1)})]),_:1}),S(M,{class:"now-price grid place-items-center bg-[#f5f7f9]"},{default:w(()=>[S(B,{class:pt([D(d).increase>0?"green-text":"red-text","text-[76px] font-bold"])},{default:w(()=>[W(O(D(d).close),1)]),_:1},8,["class"])]),_:1}),S(M,{class:"mx-[24px] px-[24px] bg-[#f5f7f9] rounded-[20px]"},{default:w(()=>[Re(S(M,{class:"row py-[20px]"},{default:w(()=>[S(M,{class:"col"},{default:w(()=>[S(B,{class:"text-[28px]"},{default:w(()=>[W(O(D(t)("position.chart.OrderPrice")),1)]),_:1}),S(M,null,{default:w(()=>[S(xe,{modelValue:D(v).order_price,"onUpdate:modelValue":z[6]||(z[6]=H=>D(v).order_price=H),max:999999999,min:0,width:"160",onChange:g},null,8,["modelValue"])]),_:1})]),_:1}),S(B,{class:"text-[24px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.PriceLimit"))+" => "+O(D(d).close),1)]),_:1})]),_:1},512),[[Le,D(v).type===1]]),S(M,{class:"row py-[20px]"},{default:w(()=>[S(M,{class:"col"},{default:w(()=>[S(B,{class:"text-[28px]"},{default:w(()=>[W(O(D(t)("position.chart.StopSurplus")),1)]),_:1}),S(M,null,{default:w(()=>[S(xe,{modelValue:D(v).stop_surplus,"onUpdate:modelValue":z[7]||(z[7]=H=>D(v).stop_surplus=H),disabled:D(v).disabled_stop_surplus,max:999999999,min:0,width:"160",onChange:p},null,8,["modelValue","disabled"])]),_:1}),S(M,{class:"mr-[34px] flex items-center justify-end"},{default:w(()=>[S(_r,{onChange:m})]),_:1})]),_:1}),S(B,{class:"text-[24px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.PriceLimit"))+" => "+O(D(d).close),1)]),_:1})]),_:1}),S(M,{class:"row py-[20px]"},{default:w(()=>[S(M,{class:"col"},{default:w(()=>[S(B,{class:"text-[28px]"},{default:w(()=>[W(O(D(t)("position.chart.StopLoss")),1)]),_:1}),S(M,null,{default:w(()=>[S(xe,{modelValue:D(v).stop_loss,"onUpdate:modelValue":z[8]||(z[8]=H=>D(v).stop_loss=H),disabled:D(v).disabled_stop_loss,max:999999999,min:0,width:"160",onChange:_},null,8,["modelValue","disabled"])]),_:1}),S(M,{class:"mr-[34px] flex items-center justify-end"},{default:w(()=>[S(_r,{onChange:y})]),_:1})]),_:1}),S(B,{class:"text-[24px] sub-title"},{default:w(()=>[W(O(D(t)("position.chart.PriceLimit"))+" => "+O(D(d).close),1)]),_:1})]),_:1}),S(M,{class:"row py-[20px]"},{default:w(()=>[S(M,{class:"col"},{default:w(()=>[S(M,{class:"flex items-center"},{default:w(()=>[S(B,{class:"text-[28px]"},{default:w(()=>[W(O(D(t)("position.chart.Quantity")),1)]),_:1}),S(M,{class:"hands text-[22px] sub-title"},{default:w(()=>[W(" (0.01~10000) ")]),_:1})]),_:1}),S(M,null,{default:w(()=>[S(xe,{value:D(v).quantity,"onUpdate:value":z[9]||(z[9]=H=>D(v).quantity=H),max:999999999,min:.01,width:"160",onChange:x},null,8,["value","min"])]),_:1})]),_:1})]),_:1}),S(M,{class:"py-[20px]"},{default:w(()=>[S(B,{class:"text-[28px]"},{default:w(()=>[W(O(D(t)("position.chart.Lever")),1)]),_:1}),S(M,{class:"flex flex-wrap text-[22px]"},{default:w(()=>[S(B,{class:"flex items-center justify-center w-[80px] h-[43px] mt-[15px] mx-[24px] bg-[#f5f7f9] rounded-[20px] text-white bg-black"},{default:w(()=>[W(O(D(v).lever),1)]),_:1})]),_:1})]),_:1})]),_:1}),S(M,{class:"flex flex-col mx-[34px] mt-[10px] text-[24px] sub-title"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.HandlingFee"))+": 0.1",1)]),_:1}),S(B,{class:"mt-[10px]"},{default:w(()=>[W(O(D(t)("position.chart.CashDeposit"))+": 10.00000",1)]),_:1})]),_:1}),S(M,{class:"submit text-center"},{default:w(()=>[S(M,{class:"py-[22px] text-center bg-black rounded-[40px]",onClick:b},{default:w(()=>[S(B,{class:"text-[28px] font-bold text-white"},{default:w(()=>[W(O(D(t)("position.chart.PlaceAnOrder")),1)]),_:1})]),_:1}),S(M,{class:"mt-[20px] text-[26px]"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.AvailableBalance"))+"：",1)]),_:1}),S(B,null,{default:w(()=>[W(O(D(e).userInfo.balance),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[Le,D(h)]]),Re(S(M,{class:"order-wrap"},{default:w(()=>[S(M,{class:"second-contract"},{default:w(()=>[S(M,null,{default:w(()=>[S(M,{class:"now-price grid place-items-center bg-[#f5f7f9]"},{default:w(()=>[S(B,{class:pt([D(d).increase>0?"green-text":"red-text","text-[76px] font-bold"])},{default:w(()=>[W(O(D(d).close),1)]),_:1},8,["class"])]),_:1}),S(M,{class:"time-wrap mx-[24px] rounded-[20px]"},{default:w(()=>[S(M,{class:"p-[24px] bg-[#f5f7f9] rounded-[20px]"},{default:w(()=>[S(M,{class:"trade-symbol flex items-center justify-between py-[15px]"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.TransactionPairs")),1)]),_:1}),S(B,null,{default:w(()=>[W(O(D(n)),1)]),_:1})]),_:1}),S(M,{class:"flex items-center justify-between py-[15px]"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.direction")),1)]),_:1}),S(B,{class:pt(D(T).type===0?"red-text":"green-text")},{default:w(()=>[W(O(D(T).type===0?D(t)("position.chart.BuyLess"):D(t)("position.chart.BuyMore")),1)]),_:1},8,["class"])]),_:1})]),_:1}),S(M,{class:"py-[15px]"},{default:w(()=>[S(B,{class:"mx-[24px]"},{default:w(()=>[W(O(D(t)("position.chart.SelectExpirationDate")),1)]),_:1}),S(M,{class:"grid grid-cols-5 text-[22px]"},{default:w(()=>[(ot(!0),Se(be,null,xr(D(L),H=>(ot(),gt(B,{key:H.id,class:pt([D(T).time_id===H.id?"bg-black text-white":"","flex items-center justify-center w-[80px] h-[43px] mt-[15px] mx-[24px] bg-[#f5f7f9] rounded-[20px] transition-all"]),onClick:lt=>U(H)},{default:w(()=>[W(O(H.time)+"s ",1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),S(M,{class:"flex items-center justify-between mt-[20px] mx-[48px] text-[22px] sub-title"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.RateOfReturn")),1)]),_:1}),S(B,null,{default:w(()=>[W(O(D(T).time.rate*100)+"%",1)]),_:1})]),_:1}),S(M,{class:"buy-amount mt-[20px] mx-[24px] px-[24px] py-[10px] rounded-[20px]"},{default:w(()=>[S(B,{class:"text-[26px]"},{default:w(()=>[W(O(D(t)("position.chart.TransactionQuantity"))+"(>="+O(D(T).time.min_amount)+") ",1)]),_:1}),S(et,{modelValue:D(T).quantity,"onUpdate:modelValue":z[10]||(z[10]=H=>D(T).quantity=H),class:"text-[50px] font-bold my-[20px]",type:"number"},null,8,["modelValue"]),S(M,{class:"flex items-center justify-between text-[22px] sub-title"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.ExpectedReturns")),1)]),_:1}),S(B,null,{default:w(()=>[W(O(D(T).quantity*D(T).time.rate),1)]),_:1})]),_:1})]),_:1}),S(M,{class:"flex justify-between items-center mt-[20px] mx-[48px] text-[22px] sub-title"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.HandlingFees")),1)]),_:1}),S(B,null,{default:w(()=>[W("0")]),_:1})]),_:1}),S(M,{class:"submit text-center"},{default:w(()=>[S(M,{class:"py-[22px] text-center bg-black rounded-[40px]"},{default:w(()=>[S(B,{class:"text-[28px] font-bold text-white",onClick:Y},{default:w(()=>[W(O(D(t)("position.chart.PlaceAnOrder")),1)]),_:1})]),_:1}),S(M,{class:"mt-[20px] text-[26px]"},{default:w(()=>[S(B,null,{default:w(()=>[W(O(D(t)("position.chart.AvailableBalance"))+"：",1)]),_:1}),S(B,null,{default:w(()=>[W(O(D(e).userInfo.balance),1)]),_:1})]),_:1})]),_:1})]),_:1}),S(K,{class:"w-[88px] h-[88px] second-close",src:xi,onClick:z[11]||(z[11]=H=>f.value=!1)})]),_:1})]),_:1},512),[[Le,D(f)]])]),_:1})],64)}}},_o=Ue(uo,[["__scopeId","data-v-e2791c13"]]);export{_o as default};
